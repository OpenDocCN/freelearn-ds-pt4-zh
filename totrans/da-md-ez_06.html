<html><head></head><body>
		<div id="_idContainer314">
			<h1 class="chapterNumber">6</h1>
			<h1 id="_idParaDest-112" class="chapterTitle" lang="en-GB" xml:lang="en-GB"><a id="_idTextAnchor114"/>Getting Started with Power BI</h1>
			<p class="normal">Visualizing data to understand "what is going on" in the business: this is the first and ever-present need that organizations have when leveraging data. Unsurprisingly, business intelligence applications are the earliest to be adopted in a company and precede by months (or even years) the arrival of their "sexier" advanced analytics counterparts. However excited and impatient we can—understandably—be about the wonders of predictive and prescriptive capabilities powered by machine learning algorithms, a simple online dashboard showing the evolution of key business metrics can easily dominate in short-term potential. Making data accessible to a broad community of employees will multiply the probability of identifying business opportunities and promoting more conscious and effective data-based decisions by business managers. This scenario is too appealing to be left by the wayside, and the time has come to equip our data analytics toolbox with a tool that can unleash the power of descriptive analytics at scale: Power BI.</p>
			<p class="normal">This chapter will provide answers to the following questions:</p>
			<ul>
				<li class="bullet">What is Power BI, and how do I get started?</li>
				<li class="bullet">How do I load, transform, and organize data?</li>
				<li class="bullet">How do I create data visualizations that can interact with each other?</li>
				<li class="bullet">What does a Power BI dashboard look like, and how can I create one?</li>
			</ul>
			<p class="normal">After getting acquainted with the Power BI Desktop user interface, we will build a complete dashboard step by step. The ultimate objective is to equip you with all you need to create your own dashboards as soon as you finish reading the last page. The focus of this chapter is on Power BI and on what you strictly need to start benefitting from it. We will then use the following two chapters to sharpen your data visualization and storytelling skills to make you great at building data charts that can effectively persuade others. One thing at a time: let's now meet our new hero in the quest for data analytics.</p>
			<h1 id="_idParaDest-113" class="title"><a id="_idTextAnchor115"/>Power BI in a nutshell</h1>
			<p class="normal"><strong class="keyword">Power BI</strong> is a<a id="_idIndexMarker619"/> business intelligence service offered by Microsoft that enables the creation of online data dashboards. Let's go through its most essential features:</p>
			<ul>
				<li class="bullet">Power BI<a id="_idIndexMarker620"/> comes with a traditional application software called <strong class="keyword">Power BI Desktop</strong>, which you can download and install, for free, on your computer. Power BI <a id="_idIndexMarker621"/>Desktop offers the full design functionalities of Power BI: you can use this software to create your dashboards, save them in local files (with the <code class="Code-In-Text--PACKT-">.pbix</code> extension), and then share them with other users, who can, in turn, view and edit your dashboards. To complete this chapter, you will only need to use the Power BI Desktop application.</li>
				<li class="bullet">It's important to know that <a id="_idIndexMarker622"/>Power BI is primarily offered as a cloud-based service. If you decide you want to use Power BI at scale in your company to leverage corporate data sources and make dashboards available online via browsers or mobile apps (without the need for all users to install Power BI Desktop and open files shared via email), then you can do so by acquiring Pro or Premium <a id="_idIndexMarker623"/>licenses. In this way, your dashboards will rely on the Microsoft cloud platform, called <strong class="keyword">Azure</strong>, for hosting, processing, and making data available to end users.<div id="_idContainer269" class="note"><p class="Information-Box--PACKT-">If your company uses Microsoft 365 cloud services, you might already have a Power BI Pro license: it's worth checking this out.</p></div></li>
			</ul>
			<ul>
				<li class="bullet">Power BI leverages a user-friendly <strong class="keyword">visual interface</strong> that lets you design dashboards without the need to write any code. Still, if you want to specify advanced queries, you can use the programming language called <strong class="keyword">DAX</strong>, which is short for <strong class="keyword">Data Analysis eXpressions</strong>. We will not cover DAX in this book, but it's good to know that you can<a id="_idIndexMarker624"/> extend Power BI functionalities by leveraging it if you need it.</li>
				<li class="bullet">Power BI offers <strong class="keyword">more than plain data visualizations</strong>. It lets you pull data from different sources, transform and harmonize tables, apply some logic and algorithms, and make data accessible through interactive charts or other non-traditional ways. For example, a remarkable functionality of Power BI is to give users the possibility to obtain data by typing questions in plain English like <em class="italic">what is the evolution of profit for brand X over the last two years?</em> In this case, your role as a designer will be to "teach" Power BI how to interpret your colleagues' questions by deciding, for instance, what words are used as synonyms to describe the same entities (for example, <em class="italic">articles</em>, <em class="italic">SKUs</em>, and <em class="italic">products</em>).</li>
				<li class="bullet">Power BI can be <strong class="keyword">extended</strong> with additional features and visuals. You can check the Microsoft App store<a id="_idIndexMarker625"/> called <strong class="keyword">AppSource</strong> (<a href="http://appsource.microsoft.com"><span class="url">appsource.microsoft.com</span></a>), from where you can download additional custom visualizations for free. Another way to extend Power BI functionalities is to add Python or R code snippets as a way to implement specialized charts or add machine learning functionalities.</li>
			</ul>
			<p class="normal">All in all, Power BI promises to be a powerful and well-rounded tool for democratizing data in a company through accessible dashboards: this is exactly what we need to complete our data analytics toolbox and unlock substantial value for our <a id="_idIndexMarker626"/>business. Before exploring its user interface and getting acquainted with its naming conventions, let's get Power BI Desktop up and running on your computer. You can either retrieve it from its download page (<a href="http://powerbi.microsoft.com/en-us/downloads"><span class="url">powerbi.microsoft.com/en-us/downloads</span></a>) and then install it or look it up on the Microsoft Store app in Windows. Although it is not required for the sake of the chapter, you can also register for a free Power BI license. This would let you access the cloud-based services and save your reports, for your own use, on the cloud (sharing them with others would require buying a paid license).</p>
			<h1 id="_idParaDest-114" class="title"><a id="_idTextAnchor116"/>Walking through Power BI</h1>
			<p class="normal">Building a working dashboard<a id="_idIndexMarker627"/> in Power BI requires a series of four essential steps, namely, loading your data, transforming it, defining a data model, and creating data visuals leveraging the data model. As you can see in <em class="italic">Figure 6.1</em>, the four steps alternate as a cycle—your dashboard might require a few iterations before being ready for prime time:</p>
			<figure class="mediaobject"><img src="image/B17125_06_01.png" alt="Diagram&#10;&#10;Description automatically generated"/></figure>
			<p class="packt_figref">Figure 6.1: Typical Power BI design process: load the data and transform data, define a model, build visuals, and iterate</p>
			<p class="normal">Every step of the <a id="_idIndexMarker628"/>process relies on some specific views or dialogs in the application. By using only a handful of views, you will be able to access all the functionalities you need to build a dashboard from scratch. <em class="italic">Figure 6.2</em><strong class="keyword"> </strong>shows a simple "map" of where to find the most helpful Power BI views and windows so that you don't get lost along the way:</p>
			<figure class="mediaobject"><img src="image/B17125_06_02.png" alt=""/></figure>
			<p class="packt_figref">Figure 6.2: Feeling lost? This is where you find the most valuable views you will ever need in Power BI</p>
			<p class="normal">In the following few pages, we will walk through the complete process of creating a dashboard and discover the critical Power BI functionalities that will help us along the way.</p>
			<h2 id="_idParaDest-115" class="title" lang="en-GB" xml:lang="en-GB"><a id="_idTextAnchor117"/>Loading data</h2>
			<p class="normal">Unsurprisingly, the very <a id="_idIndexMarker629"/>first thing you need to do in Power BI is load some data into it. If you click on <strong class="screenText">Get Data</strong> right from the welcome screen you see as soon as you open Power BI or from the icon in the <strong class="screenText">Home</strong> ribbon on top, you will get to the <strong class="keyword">Get Data</strong> window, shown in <em class="italic">Figure 6.3</em>. This window boasts a wide range of possible data <a id="_idIndexMarker630"/>connectors, organized by the categories you see on the left (<strong class="screenText">File</strong>, <strong class="screenText">Database</strong>, <strong class="screenText">Online services</strong>, and so on). The first and most used category is <strong class="screenText">File</strong>: from here, you can import not only Excel or CSV single files but also entire folders, and you can extract the data stored in PDF reports. From the <strong class="screenText">Database</strong> category, you can connect to many types of databases and specify SQL queries to retrieve the data you need. From here, you can also connect to cloud-based platforms such as Amazon Web Services (Redshift), Google Cloud Platform (BigQuery), and, of course, Microsoft Azure. The <strong class="screenText">Online Services</strong> category lets you connect to other external services like Google Analytics, Salesforce reports, and Sharepoint lists. Have a look at the <strong class="screenText">Other</strong> category as well: the source called <strong class="screenText">Web</strong> will let you scrape data from web pages and download tables or other web elements of interest:</p>
			<figure class="mediaobject"><img src="image/B17125_06_03.png" alt=""/></figure>
			<p class="packt_figref">Figure 6.3: The Get Data window in Power BI: define how to retrieve the data you need</p>
			<p class="normal">By setting up a<a id="_idIndexMarker631"/> data connector, you define the first step of a repeatable routine for retrieving and transforming your data of interest: such a routine in Power BI is called<a id="_idIndexMarker632"/> a <strong class="keyword">query</strong>. Defining queries is a powerful way to ensure that your dashboards can be sustainably updated over time. Every time you refresh your reports, the queries will connect to the various sources and pull the most up-to-date version of the available data.</p>
			<h2 id="_idParaDest-116" class="title" lang="en-GB" xml:lang="en-GB"><a id="_idTextAnchor118"/>Transforming data</h2>
			<p class="normal">For every query, you can <a id="_idIndexMarker633"/>then associate a series of data transformation steps that are applied every time new data comes in. In Power BI, you can do so visually, without writing any code, by using a tool called <strong class="keyword">Power Query Editor</strong>, which you can <a id="_idIndexMarker634"/>see in <em class="italic">Figure 6.4</em>. On the left of the query editor, you find a panel called <strong class="screenText">Queries</strong> from which you can select the query you are setting transformation steps for: just click on the name of the query you wish to work on.</p>
			<p class="normal">You will see an Excel-like spreadsheet view in the middle of the window, which displays a <em class="italic">preview</em> of your transformed query. The values of the cells are read-only: you cannot change them one by one, and indeed your purpose here is to define repeatable transformation steps for the whole table more than applying cell-level changes. You can use the header of the spreadsheet to apply some transformations, like filters and sorting, similar to what you would do in Excel. On the right, you find a panel called <strong class="screenText">Applied steps</strong>, where you can find an ordered list of the transformation steps applied so far. The very first step is likely to be <strong class="screenText">Source</strong>, as it indicates the original definition of the source of data you loaded. Some of the transformation steps will have a cog icon on the right: by clicking on it, you can edit the parameters of the transformation steps. For instance, if the query pulls data from an Excel file, you can edit the file's path to open by clicking on the cog icon beside the <strong class="screenText">Source</strong> step. </p>
			<p class="normal">When you select a specific step, the spreadsheet view will update accordingly, showing you a preview of the query after executing that specific step you selected: this is handy when you want to check <em class="italic">what is going on</em> in your transformation routine at every step:</p>
			<figure class="mediaobject"><img src="image/B17125_06_04.png" alt=""/></figure>
			<p class="packt_figref">Figure 6.4: The Power Query Editor window in Power BI: design the transformation steps applied to each query</p>
			<p class="normal">By going <a id="_idIndexMarker635"/>through the first three ribbon tabs on top of the <strong class="keyword">Power Query Editor</strong> window, namely <strong class="screenText">Home</strong>, <strong class="screenText">Transform</strong>, and <strong class="screenText">Add Column</strong>, you can find a <em class="italic">menu</em> of the many transformation steps available to you. Many of these transformation steps are the same as the ones we learned how to apply with KNIME using the nodes introduced in <em class="chapterRef">chapters 2</em> and <em class="chapterRef">3</em>. Let's have a look at the most popular ones in there.</p>
			<figure class="mediaobject"><img src="image/B17125_06_05.png" alt=""/></figure>
			<p class="packt_figref">Figure 6.5: The Home ribbon tab in the Power Query Editor window</p>
			<ul>
				<li class="bullet">Starting from the <strong class="screenText">Home</strong> tab (<em class="italic">Figure 6.5</em>), you can find the <strong class="screenText">Choose Columns</strong> and <strong class="screenText">Remove Columns</strong> icons, which let you filter columns and keep only the ones you really need.</li>
				<li class="bullet">Similarly, <strong class="screenText">Keep Rows</strong> and <strong class="screenText">Remove Rows</strong> enable you to reduce the number of rows: for instance, you can keep only the top 10 rows or remove the duplicate ones.</li>
			
			</ul>
				<div id="_idContainer275" class="packt_tip">
					<p class="Tip--PACKT-">Instead, if you want to filter rows depending on their values, you need to click on the arrow that appears on the right of the header of each column within the preview spreadsheet. From there, you can also sort rows using your preferred order.</p>
				</div>
			<ul>
			
				<li class="bullet">The <strong class="screenText">Split Column</strong> icon will let you divide strings into multiple columns by either using delimiters (you can split <code class="Code-In-Text--PACKT-">JUN-22</code> into <code class="Code-In-Text--PACKT-">JUN</code> and <code class="Code-In-Text--PACKT-">22</code> by setting <code class="Code-In-Text--PACKT-">-</code> as a delimiter) or counting a given number of characters.</li>
				<li class="bullet"><strong class="screenText">Group By</strong> will aggregate all rows according to a given group definition and a summarization logic (like sum, average, or count). If you use this transformation step, you will not be able to use the disaggregated version of the table anywhere in your dashboard, so use this function sparingly. You can always aggregate tables <em class="italic">on the fly</em> by defining the aggregation directly as you build the visuals, which we do most of the time.</li>
				<li class="bullet"><strong class="screenText">Merge Queries</strong> lets you combine queries by applying a one-off join operation. We will find here the same join types that we have met in <em class="chapterRef">Chapter 3</em>, <em class="chapterRef">Transforming Data</em>, such as <em class="italic">inner</em>, <em class="italic">left outer</em>, <em class="italic">right outer</em>, and <em class="italic">full outer</em>, plus some more like <em class="italic">left anti</em> (which means keeping only the rows from the left table that are not matched on the right). You can either create a new query containing the result of the join or substitute the current query with it.<p class="bullet-para">It's important to notice that the <strong class="screenText">Merge Queries function</strong> is not the only way to <em class="italic">connect</em> two tables with matching keys in Power BI. As we will learn in the next few pages, when we build data models, we can specify relationships across tables without <a id="_idIndexMarker636"/>statically joining them once and for all. This means that you should use <strong class="screenText">Merge Queries</strong> only if you want to run a definitive merge of two tables and accept the need to utilize some extra space required to keep the static, joined version of the table.</p></li>
				<li class="bullet">With the <strong class="screenText">Append Queries</strong> icon, you can concatenate two tables with the same columns by adding the rows of one table at the bottom of the rows of the other table.<figure class="mediaobject"><img src="image/B17125_06_06.png" alt=""/></figure></li>
			</ul>
			<p class="packt_figref">Figure 6.6: The Transform tab in the Power Query Editor window</p>
			<ul>
				<li class="bullet">Moving to the <strong class="screenText">Transform</strong> tab (<em class="italic">Figure 6.6</em>), we find the <strong class="screenText">Data Type</strong> drop-down menu, which lets us select the type associated with a column and attempt a conversion. We can use this one, for instance, to convert a string containing a date into a Date &amp; Time field.</li>
				<li class="bullet">With <strong class="screenText">Replace Values</strong>, you can substitute all cells having a certain value with a specified new value. You can use it also for applying a fixed value to all empty cells in a column. To do so, just use the <code class="Code-In-Text--PACKT-">null</code> string to specify you want to target empty cells.</li>
				<li class="bullet">The <strong class="screenText">Fill</strong> icon lets you replace all empty cells with the values found above or below within the table. This is handy when you have some values sorted by time and you want to <em class="italic">fill the gaps</em> with the most recent available values.</li>
				<li class="bullet">As the name suggests, by using <strong class="screenText">Pivot Column</strong>, you can create pivot tables where values within a column are aggregated across as separate columns. You might also find useful its reverse functionality, <strong class="screenText">Unpivot</strong> <strong class="screenText">Columns</strong>, which makes columns of the table appear as multiple rows.</li>
				<li class="bullet">The <strong class="screenText">Format</strong> icon lets you manipulate the strings: you can, for instance, capitalize strings (making <code class="Code-In-Text--PACKT-">tessa</code> become <code class="Code-In-Text--PACKT-">Tessa</code>) or move them to an all-uppercase format (<code class="Code-In-Text--PACKT-">TESSA</code>).</li>
				<li class="bullet">With the <strong class="screenText">Rounding</strong> functionality, you can specify the rounding logic for decimal numbers, fixing the decimal digits to your liking.</li>
				<li class="bullet">Within the <strong class="screenText">Data &amp; Time Column</strong> section, you can extract specific Date &amp; Time fields, such as years, months, hours, and seconds. If you want to extract more than one field, you <a id="_idIndexMarker637"/>can first duplicate the column (right-click on the column header and then <strong class="screenText">Duplicate Column</strong>) and create as many copies as you need before replacing them with the field you need.<figure class="mediaobject"><img src="image/B17125_06_07.png" alt=""/></figure></li>
			</ul>
			<p class="packt_figref">Figure 6.7: The Add Column tab in the Power Query Editor window</p>
			<ul>
				<li class="bullet">Within the <strong class="screenText">Add Column</strong> tab (<em class="italic">Figure 6.7</em>), you can create calculated columns by applying some logic. For instance, using the <strong class="screenText">Custom Column</strong> icon, you can apply math formulas, such as <code class="Code-In-Text--PACKT-">[Price]*[Discount_rate]</code>, leveraging as variables the values found in other columns.</li>
				<li class="bullet"><strong class="screenText">Conditional Column</strong> lets you generate a new column based on evaluating some logical conditions on other columns, similar to what we did in KNIME using the <strong class="keyword">Rule Engine </strong>node. For <a id="_idIndexMarker638"/>example, you can create a new column with the value <code class="Code-In-Text--PACKT-">Expensive</code> for all rows where the <em class="italic">Price </em>column is higher than 2.5 and <code class="Code-In-Text--PACKT-">Cheap</code> for all others.</li>
			</ul>
			<p class="normal">As you finish applying all the required transformation steps, your queries will produce tables having precisely the shape and format you need. Once you have done so, you can save the queries (the <strong class="screenText">Close &amp; Apply</strong> icon in the <strong class="screenText">Home</strong> tab) and move on to the next step of our process: the definition of the data model.</p>
			<h2 id="_idParaDest-117" class="title" lang="en-GB" xml:lang="en-GB"><a id="_idTextAnchor119"/>Defining the data model</h2>
			<p class="normal">At this point of the<a id="_idIndexMarker639"/> process, you need to define how the tables resulting from your queries are logically interrelated. To do so, it will be enough to declare the relationship between the <strong class="keyword">matching columns</strong> across tables, meaning the ones that can be used for combining tables when needed. By completing this simple exercise, you will have defined a single data model that you will then be able to leverage freely in your dashboard visualizations. We do this for a straightforward and important reason: by connecting the matching keys, you can use data stored in different tables within the same visual: it's like having all tables joined and continuously available to you, which is pretty handy. A consequence of having a clear data model defined is that you can enable interactions across charts through filtering or selections. For example, let's imagine that a visual shows the total amount of sales generated by category: by clicking on a category name, you can get another visual to show the names of the most active customers within that category, an information that is stored in a different table. By knowing the matching columns between categories, sales, and customers, Power BI will be able to show the data the user is after and enable drill-downs and other forms of interaction.</p>
			<p class="normal">It is effortless to build a data model in Power BI. Do you remember the <strong class="keyword">Entity-Relationship (ER) diagram</strong> we introduced in <em class="chapterRef">Chapter 3</em>, <em class="italic">Transforming Data</em> (see<em class="italic"> Figure 3.10 </em>to get a refresher)? Power BI lets you build a model visually by drawing ER diagrams using the available tables.</p>
			<p class="normal">As you can see in <em class="italic">Figure 6.8</em>, the <strong class="keyword">Model </strong>view<a id="_idIndexMarker640"/> shows tables (each resulting from the full transformation steps declared in a query) as boxes: the table name appears in bold at the top of the box while columns are listed within the box. The tables are connected through lines, which represent their relationships:</p>
			<figure class="mediaobject"><img src="image/B17125_06_08.png" alt=""/></figure>
			<p class="packt_figref">Figure 6.8: The Model view in Power BI: connect the tables and build your ER diagram</p>
			<p class="normal">By using<a id="_idIndexMarker641"/> the <strong class="keyword">Model</strong> view, you <a id="_idIndexMarker642"/>can easily declare relationships across matching columns. For example, to draw a relationship across matching columns in two different tables, it will be enough to <em class="italic">drag and drop</em> one column on top of its match. For instance, in <em class="italic">Figure 6.8</em>, you can see how the highlighted relationship (between the ProductMD and Transactions tables) is made using the common column, <em class="italic">StockCode</em>. The arrows appearing on the connections indicate the <strong class="keyword">cross-filter directions</strong>: in this case, a<a id="_idIndexMarker643"/> filter applied on a ProductMD item will also filter rows in Transactions, while the opposite will not happen. The <strong class="screenText">1</strong> and <strong class="screenText">*</strong> symbols appearing at the ends of the connectors clarify the <a id="_idIndexMarker644"/>expected <strong class="keyword">cardinality </strong>of the relationship: the ones displayed in the picture are both <strong class="keyword">one-to-many </strong>(<strong class="keyword">1-to-*</strong>) relationships, meaning <a id="_idIndexMarker645"/>that we expect one single row in ProductMD to refer to many rows in Transactions. The<a id="_idIndexMarker646"/> other possible types <a id="_idIndexMarker647"/>of relationship cardinality are <strong class="keyword">one-to-one </strong>(<strong class="keyword">1-to-1</strong>) and <strong class="keyword">many-to-many </strong>(<strong class="keyword">*-to-*</strong>).</p>
			<p class="normal">The role of the data model will become even more apparent when we go through the full tutorial. For now, the takeaway is that by defining relationships together with their cardinality and cross-filter directions (all visually displayed in the <strong class="keyword">Model</strong> view), we can be sure that the behavior of Power BI is not ambiguous, even when we use multiple tables at the same time within our dashboard.</p>
			<p class="normal">Having built the data model, we can now move to the last and most exciting part of dashboard creation: designing data visualizations.</p>
			<h2 id="_idParaDest-118" class="title" lang="en-GB" xml:lang="en-GB"><a id="_idTextAnchor120"/>Building visuals</h2>
			<p class="normal">Dashboards in Power BI are <a id="_idIndexMarker648"/>organized as a set of pages, each containing many interconnected visual elements such as tables, line charts, scatter plots, text labels, and buttons. As you perform this step, you will have to think like a designer by enforcing structure and visual appeal while mixing together business understanding and creativity. This activity can be as enjoyable as it is time-consuming: for sure, it can pay its dividends as you end up with a functional and valuable dashboard that people can leverage to unveil business opportunities and make superior decisions. When you open <a id="_idIndexMarker649"/>the <strong class="keyword">Report view</strong><strong class="keyword"> </strong>(shown in <em class="italic">Figure 6.9</em>), you will have at your fingertips all you need to compose the visual elements together and link them with the tables sitting in the underlying data model:</p>
			<figure class="mediaobject"><img src="image/B17125_06_09.png" alt=""/></figure>
			<p class="packt_figref">Figure 6.9: The Report view in Power BI: connect the tables and build your ER diagram</p>
			<p class="normal">Let's go through each component of the <strong class="keyword">Report</strong> view and learn what they are there for:</p>
			<ol>
				<li class="numbered"><strong class="keyword">Report page</strong>: This will <a id="_idIndexMarker650"/>look at first like a blank piece of paper upon which you can draw your beautiful dashboard. By using your mouse, you can place, resize, and reposition visuals as needed. Underneath the report page, you will find a set of tabs, each referring to a separate page of your dashboard.<div id="_idContainer280" class="note"><p class="Information-Box--PACKT-">According to the official naming convention of Power BI, what we are building in this chapter is a report, not a dashboard: the latter is, instead, a one-page summary aggregation of selected visuals, a feature available in the Power BI service only. For simplicity, I will keep using the words dashboard and report to refer to our end result here: a set of connected visuals for end users to interact with.</p></div></li>
				<li class="numbered"><strong class="keyword">Filters</strong>: In this section, you decide the scope of the data to be shown in each visual element by setting filters. For example, you can set up a filter on the column <em class="italic">Category</em> by dragging and <a id="_idIndexMarker651"/>dropping it from the Fields panel onto one of the boxes lying on the <strong class="keyword">Filters</strong> panel. You can use filters to show only the portion of data you select or implement some logic, like <em class="italic">show only the five most selling products of the list</em>. The <strong class="keyword">Filters</strong> section has three different panels, corresponding to the levels at which you want your filters to operate: some filters will limit what is shown in a specific visual only, while others will apply instead to all the visuals in a page or, even, on every visual appearing anywhere in all dashboards.</li>
				<li class="numbered"><strong class="keyword">Visuals</strong>: This <a id="_idIndexMarker652"/>section is the most interesting one as it features a <a id="_idIndexMarker653"/>complete list of visualization types you can add to your dashboard. As you can see from <em class="italic">Figure 6.10</em>, more than 30 different visualization types are available for you to use as soon as you install Power BI:<figure class="mediaobject"><img src="image/B17125_06_10.png" alt="Graphical user interface, diagram&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.10: Available visualization types in Power BI: which chart makes your data speak best?</p><p class="bullet-para">You can also add <a id="_idIndexMarker654"/>supplementary visualization types by either enabling the preview of some beta-version features (go to <strong class="screenText">File </strong>| <strong class="screenText">Options and settings</strong> | <strong class="screenText">Options</strong> | <strong class="screenText">Preview features </strong>to activate) or downloading them from AppSource by clicking on the last visualization <strong class="screenText">...</strong> icon (you need to sign in to Power BI, even with a free account, to access AppSource). You can see in <em class="italic">Figure 6.11</em> a preview of the extra available<a id="_idIndexMarker655"/> visuals you can grab from there:</p><figure class="mediaobject"><img src="image/B17125_06_11.png" alt="Graphical user interface, application&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.11: Run out of creative ideas? You can check AppSource for additional visual types and add them to your Power BI</p></li>
				<li class="numbered"><strong class="keyword">Properties</strong>: From this<a id="_idIndexMarker656"/> section, you can configure how your visual should behave and look. As you can see in <em class="italic">Figure 6.12</em>, you have three available tabs within this section, namely <strong class="keyword">Fields</strong>, <strong class="keyword">Format,</strong> and <strong class="keyword">Analytics</strong>. The <strong class="keyword">Fields</strong> tab is the first to be looked after: by dragging and dropping the columns available in the data model into the various elements in this tab, you decide what data should be visualized. Depending on the type of visualization you are using, you will have different elements to configure. For instance, the example in <em class="italic">Figure 6.12</em> refers to a line chart where the column <em class="italic">Invoice_time</em> controls what should be in the horizontal axis, while the values visualized by the line are controlled by the column <em class="italic">Quantity</em>. In the Format tab, you have multiple selectors that let you control the "look and feel" of the visual. You can tune several visual properties, from the title to be displayed on top to the color and thickness of the line in the chart. Lastly, in the <strong class="keyword">Analytics</strong> tab, you can<a id="_idIndexMarker657"/> activate some basic modeling features, such as trend lines (basically, the result of a simple linear regression model or a time series forecast):<figure class="mediaobject"><img src="image/B17125_06_12.png" alt=""/></figure><p class="packt_figref">Figure 6.12: Visual properties section: connect data columns to your chart and decide how it should look</p></li>
				<li class="numbered"><strong class="keyword">Fields</strong>: This <a id="_idIndexMarker658"/>section, which you can find on the right side of the <strong class="keyword">Report</strong> view, does a simple but fundamental job. It carries a list of all the columns available in the different tables of the data model so that you can easily drag and drop the columns onto the filters or the properties section. When you click on any column, the <strong class="screenText">Column tools</strong> ribbon will appear at the top of the window. You can use it to change the data type of a column or set its default aggregation method (like <em class="italic">Sum</em>, <em class="italic">Count</em>, or <em class="italic">Average</em>): this is helpful when you want to fine-tune the behavior of some columns before using them in your visuals.</li>
			</ol>
			<p class="normal">We made it! We have gone through the four fundamental steps required to build a dashboard in Power BI and used this as an opportunity to have a short tour of the main functionalities of the software.</p>
			<p class="normal">Let's summarize what we <a id="_idIndexMarker659"/>have just seen: everything started with loading some raw data into Power BI, by selecting and configuring the right connectors available in the <strong class="keyword">Get Data</strong> window. Leveraging the rich set of functionalities of <strong class="keyword">Power Query Editor</strong>, we took our raw data to the next level and applied an ordered series of transformation steps, which brought us to a number of tables with the right shape and format (which can be previewed at any point using the spreadsheet-like <strong class="keyword">Data</strong> <strong class="keyword">view</strong>). At this point, we used the <strong class="keyword">Model view</strong> to connect all these tables together, defining the relationships across matching columns and building a single data model. Finally, we opened the <strong class="keyword">Report view</strong>, where we found all the ingredients (tables and visuals) to build our dashboard. It's time to see this process in action as we build a full Power BI dashboard from scratch in the following tutorial.</p>
			<h1 id="_idParaDest-119" class="title"><a id="_idTextAnchor121"/>Tutorial: Sales Dashboard</h1>
			<p class="normal">This tutorial will <a id="_idIndexMarker660"/>take us back to a familiar business, which we have by now grown fond of: the UK-based online retailer selling all-occasions gifts. Automating the weekly Excel reports using KNIME (something we did back in <em class="chapterRef">Chapter 3</em>, <em class="italic">Transforming Data</em>) has granted us quite a reputation that is now pulling us back into the spotlight. As the business keeps growing, the hunger to make descriptive analytics available to a greater number of employees expands. Updating some Excel reports that answer a static list of given questions is not sufficient anymore. We would like to offer the opportunity to deep-dive into quarter-by-quarter and country- and product-level details so that our colleagues can "explore" data by themselves and find interesting insights.</p>
			<p class="normal">With the help of the financial analyst (who is still full of gratitude for us) and after interviewing a few managers about their most recurrent needs, we are ready to synthesize the requirements expected by each group of users as follows:</p>
			<ul>
				<li class="bullet-l2">All managers should be able to see at a glance the relative weight of categories and subcategories out of total revenues and see the evolution of sales over time within each product group</li>
				<li class="bullet-l2">Marketing managers should be able to look at domestic (generated in UK) and international sales separately, having the opportunity to deep-dive by country and category and plan for country-specific digital marketing campaigns accordingly</li>
				<li class="bullet-l2">Category managers should be given the opportunity to deep-dive by category and spot the articles generating the most sales for each quarter and country</li>
			</ul>
			<p class="normal">The data<a id="_idIndexMarker661"/> follows the same model we encountered in <em class="italic">Figure 3.10</em> and is made available to us in three separate files: <code class="Code-In-Text--PACKT-">SalesDashboard-CustomerMD.csv</code> and <code class="Code-In-Text--PACKT-">SalesDashboard-ProductMD.csv</code> include, respectively, the customer and the product master data tables, while <code class="Code-In-Text--PACKT-">SalesDashboard-Transactions.xlsx</code> contains the latest transactions (this time, all included in one single file).</p>
			<p class="normal">It's time to get Power BI Desktop up and running on our computer and start with the first phase of any dashboard creation: loading the required data:</p>
			<ol>
				<li class="numbered" value="1">As a first step, we load the Customer Master Data stored in a text, comma-separated value file. To do so, click on the <strong class="screenText">Get Data</strong> icon, available on the <strong class="screenText">Home</strong> ribbon tab, then select <strong class="screenText">Text/CSV</strong> as a source type, and click on <strong class="screenText">Connect</strong>. You will be prompted with a dialog from which you can choose the file to use as a source, in our case, <code class="Code-In-Text--PACKT-">SalesDashboard-CustomerMD.csv</code>. At this point, you will see a preview of the table recorded in the file (<em class="italic">Figure 6.13</em>). Power BI has correctly recognized its format: there are two columns, with the header shown on top in bold. This is looking good, and there is no need to change any setting (you can see, for example, that the comma is rightly used as a column delimiter), so we can click on <strong class="screenText">Load</strong> to complete the step:<figure class="mediaobject"><img src="image/B17125_06_13.png" alt=""/></figure><p class="packt_figref">Figure 6.13: Preview of the Customer Master Data source. You can revise the import settings from the menus in the window</p></li>
				<li class="numbered">We can repeat the same<a id="_idIndexMarker662"/> procedure (<strong class="screenText">Get Data</strong> and then <strong class="screenText">Text/CSV</strong>) to load the Product Master Data table. This time, the preview window (<em class="italic">Figure 6.14</em>) shows that the column names have not been recognized correctly and have been assigned instead with some default identifiers (<em class="italic">Column1</em>, <em class="italic">Column2</em>, and so on). This triggers the need for some minor transformation before using this table in our data model. Hence, this time we click on the second button at the bottom, <strong class="screenText">Transform Data</strong>:<figure class="mediaobject"><img src="image/B17125_06_14.png" alt="Graphical user interface, text&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.14: Preview of the Product Master Data table: column headers were not recognized</p></li>
				<li class="numbered">By clicking on <strong class="screenText">Transform Data</strong>, we ask Power BI to add some transformation steps to the query that injects the Product Master Data table: this is a job for <strong class="keyword">Power Query Editor</strong>, whose <a id="_idIndexMarker663"/>window will now appear. In this specific case, the<a id="_idIndexMarker664"/> only necessary change is to promote the first row read in the CSV file to be used as headers of the table. To do so, click on the <strong class="screenText">Use First Row as Headers</strong> button, which you can find on the <strong class="screenText">Home</strong> ribbon menu (see the arrow in <em class="italic">Figure 6.15</em> as a guide). Once done, the list of the <strong class="screenText">Applied Steps</strong> on the right is enriched with a <strong class="screenText">Promoted Headers</strong> step: this means that every time new data gets loaded, Power BI will execute this step as part of the query. We can click on the <strong class="screenText">Close &amp; Apply</strong> icon on the top left and move on:<figure class="mediaobject"><img src="image/B17125_06_15.png" alt=""/></figure><p class="packt_figref">Figure 6.15: Power Query Editor for the Product Master Data table. We need to use the first row as headers</p></li>
				<li class="numbered">The table containing the transactions is stored in an Excel file. To load it, you can either click on the usual <strong class="screenText">Get Data</strong> and then select <strong class="screenText">Excel</strong> or click straight away on the<strong class="screenText"> Excel</strong> icon appearing in the <strong class="screenText">Home</strong> ribbon menu. You will be presented with a dialog that lets you<a id="_idIndexMarker665"/> preview the tables contained in the various worksheets of the Excel file (<em class="italic">Figure 6.16</em>):<figure class="mediaobject"><img src="image/B17125_06_16.png" alt=""/></figure><p class="packt_figref">Figure 6.16: Excel preview dialog: select the tables you want to import from the Excel file</p><p class="bullet-para">Also, in this case, we need to add some transformations to the query, so tick the <code class="Code-In-Text--PACKT-">Transactions</code> box on the left and then click on <strong class="screenText">Transform Data</strong>, which will open <strong class="keyword">Power Query Editor</strong>.</p><p class="normal">As we look at the preview of the Transactions table, we notice that at least two transformations are required to make it usable. Firstly, the <em class="italic">Invoice_time</em> column does not look right, as it has not been recognized as a Date &amp; Time field. Secondly, since most of our business needs require the analysis of revenues and we only have unit <em class="italic">Price</em> and <em class="italic">Quantity</em> for each transaction, we need to implement a simple mathematical formula to obtain the revenues by multiplying the two <a id="_idIndexMarker666"/>columns. Let's see how <strong class="keyword">Power Query Editor</strong> can help us with both.</p></li>
				<li class="numbered">If you look at the headers of<a id="_idIndexMarker667"/> the spreadsheet view, you will notice that beside every column title, on the left, you can find an icon representing its data type. For example, the <strong class="screenText">ABC</strong> icon near<em class="italic"> StockCode</em> tells us that it is a text string, while the <strong class="screenText">1.2</strong> near <em class="italic">Price </em>indicates it is a decimal number. If you click on any of these icons, you will see a pop-up menu (<em class="italic">Figure 6.17</em>) from where you can force a different data type. Power BI will attempt the conversion to the type you wish. Let's do this with the <em class="italic">Invoice_time</em> column: click on its type icon on the left and select <strong class="screenText">Date/Time</strong> (if prompted with a window asking whether to replace the current query step or add a new one, select the first option). You will notice that the spreadsheet view now shows dates and times, which is exactly what we wanted:<figure class="mediaobject"><img src="image/B17125_06_17.png" alt="Graphical user interface, application, table&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.17: Column type selection from Power Query Editor: convert columns by making the right selection</p></li>
				<li class="numbered">The next step is to add a new column that hosts the revenues generated by each transaction. To do so, go to the <strong class="screenText">Add Column</strong> ribbon menu and then click on the <strong class="screenText">Custom Column</strong> icon. You will obtain the window shown in <em class="italic">Figure 6.18</em> from where you can define your<a id="_idIndexMarker668"/> expression, similar to what we did using <a id="_idIndexMarker669"/>the <strong class="keyword">Math Formula </strong>node in KNIME. The available columns are displayed on the right: double-click on <em class="italic">Quantity</em> to make it appear in the <strong class="screenText">Custom column formula</strong> box, then just type <code class="Code-In-Text--PACKT-">*</code> with your keyboard, and—finally—double-click on the <em class="italic">Price </em>column on the right. By doing so, you will obtain the expression <code class="Code-In-Text--PACKT-">[Quantity]*[Price]</code>, which is what we needed to calculate value sales. You can now specify its header by typing <code class="Code-In-Text--PACKT-">Sales</code> in the <strong class="screenText">New column name</strong> box on the top, then click on the<strong class="screenText"> OK</strong> button:<figure class="mediaobject"><img src="image/B17125_06_18.png" alt=""/></figure><p class="packt_figref">Figure 6.18: Add a custom column in Power BI: define your math formula using columns as variables</p><p class="normal">You will notice with<a id="_idIndexMarker670"/> pride that the newly calculated column <em class="italic">Sales </em>appears on the right of the spreadsheet view. However, its data type is still undefined, as you will find displayed on the left of the title an ambiguous <strong class="screenText">ABC123</strong> icon. You can quickly fix this by clicking on the icon and selecting <strong class="screenText">Decimal Number</strong>.</p><div id="_idContainer290" class="packt_tip"><p class="Tip--PACKT-">Always declare the data types of your columns. By doing so, columns can be used as optimally as possible in your dashboard visualizations, and, also, they will get appropriately aggregated. Numeric columns are, by default, aggregated in Power BI by summing values across, but you can change the aggregation function for each column at any time. To do so, go to the <strong class="keyword">Data</strong><strong class="screenText"> </strong>view (see <em class="italic">Figure 6.2</em> to find it), select a column, and <a id="_idIndexMarker671"/>use the <strong class="screenText">Summarization</strong> drop-down menu you find in the <strong class="screenText">Column tools</strong> ribbon menu (for numeric columns, you can go for <strong class="screenText">Sum</strong>, <strong class="screenText">Average</strong>, <strong class="screenText">Minimum</strong>, <strong class="screenText">Maximum</strong>, <strong class="screenText">Count</strong>, and <strong class="screenText">Distinct Count</strong>).</p></div><p class="normal">Once you have completed this step, you will see that with the help of Power Query Editor, you created a table with seven<a id="_idIndexMarker672"/> columns, as displayed in <em class="italic">Figure 6.19</em>. In the <strong class="screenText">Applied Steps </strong>panel on the right, you find a sorted list of all the transformations that need to happen (like sourcing the data stored in Excel, adding columns, changing their types, and so on) to produce the table you want to use within your dashboard. You can click on each step to "<em class="italic">go back</em>" to that phase of your transformation routine. You can also remove any step (click on the <strong class="screenText">X</strong> icon on the left that appears when you select the specific step) or edit it: for instance, you can change the definition of the custom formula we added by clicking on the cog icon on <a id="_idIndexMarker673"/>the right of the step called <strong class="screenText">Added Custom</strong>:</p><figure class="mediaobject"><img src="image/B17125_06_19.png" alt="Table&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.19: The full query definition for your Transactions table: Power Query Editor is your ally for repeatable data transformations in Power BI</p><div id="_idContainer292" class="note"><p class="Information-Box--PACKT-">Although most of the transformations are typically defined when adding new data sources, you can edit your queries later by reopening the Power Query Editor view (click on the <strong class="screenText">Transform Data</strong> icon from the <strong class="screenText">Home</strong> ribbon menu).</p></div><p class="bullet-para">To proceed further, click on the <strong class="screenText">Close &amp; Apply</strong> icon in the top left, and we are ready to go to the next phase of our dashboard creation process: the definition of the data model.</p></li>
				<li class="numbered">If you go to the <strong class="keyword">Model</strong> view (click on the third icon in the bar to the left of your Power BI main window), you will find a familiar picture: the ER model of the database made of our three tables (go back a few pages and check <em class="italic">Figure 6.8</em> to see a screenshot of the <a id="_idIndexMarker674"/>data <strong class="keyword">Model</strong> view). Power BI has automatically recognized the relationships across the tables and built the connections without our intervention. Of course, in this case, it was rather simple since the matching columns had precisely the<a id="_idIndexMarker675"/> same name and type. In any case, we can manually declare or edit any relationship across tables by using the <strong class="keyword">Model</strong> view. We can "drag and drop" one column in a table to another column on a different table to create a new relationship. To edit an existing connection, you can double-click on the line linking two tables. Click on the relationship between ProductMD and Transactions: you will obtain the <strong class="screenText">Edit relationship</strong> view displayed in <em class="italic">Figure 6.20</em>. The drop-down menus let you select the two tables to be connected, while you can specify the matching columns by clicking on the preview tables displayed in the middle. In our case, we notice that the <em class="italic">StockCode</em> column is highlighted in both tables, which is what we wanted. The <strong class="screenText">Cardinality</strong> drop-down menus at the bottom left let you select the type of relationship (<strong class="screenText">Many to one</strong>, <strong class="screenText">One to one</strong>, <strong class="screenText">One to many</strong>, or <strong class="screenText">Many to many</strong>): by doing so, you are telling Power BI how many rows in the first table should match with how many rows in the second table. In this case, we go for <strong class="screenText">Many to one</strong> since multiple transactions (first table) can correspond to the same product, and so to one single row in the Product Master Data table (the second table). You can keep the <strong class="screenText">Cross filter direction</strong> drop-down menu to its default value (<strong class="screenText">Single</strong>, which is recommended, for performance reasons, in the large majority of cases). We did not have to make any changes as all the default options worked well in this case: click on <strong class="screenText">OK</strong> and move on:<figure class="mediaobject"><img src="image/B17125_06_20.png" alt=""/></figure><p class="packt_figref">Figure 6.20: Manage a relationship across tables in a data model: which columns should be matching?</p><div id="_idContainer294" class="packt_tip"><p class="Tip--PACKT-">In Power BI, the active relationship between two tables can only be defined through one pair of matching columns. If you want to match multiple columns across two tables, you need to go through this simple workaround: go to <strong class="keyword">Power Query Editor</strong> (click on the usual <strong class="screenText">Transform Data</strong> icon), select the two or multiple columns you want to use collectively as a single key, and click on <strong class="screenText">Merge Columns</strong> from the <strong class="screenText">Transform</strong> menu. Do this on the other table as well, and you will then be able to create a relationship across the merged columns.</p></div></li>
				<li class="numbered">Check the other relationship between Transactions and the Customer Master Data table by double-clicking on the line linking the two tables. Make sure that the matching columns are <em class="italic">Customer_ID</em>, that <strong class="screenText">Cardinality</strong> is <strong class="screenText">Many to one</strong>, and that <strong class="screenText">Cross filter direction</strong> is <strong class="screenText">Single</strong>. Then click on <strong class="screenText">OK,</strong> and your data model is ready to go!<p class="normal">At this point, we are ready to move to the last and, for some, most exciting part: designing your dashboard by building its visuals one by one. One mistake many people tend to make the first time <a id="_idIndexMarker676"/>they create any data dashboard is to jump into crafting colorful charts without having a reasonably clear idea of what they are after. My advice is to always take some time to take a step back, think about the specific business needs you have, and put together a simple <em class="italic">sketch </em>of what the dashboard should look like. Think about your end users' questions and how to effectively guide them through the answers they are looking for. If you have the opportunity, show your sketch (or a digital <em class="italic">mock-up</em> built with any software you feel comfortable with) to some of the end users to get their first reaction. You will find that the time you invest early on in planning for your dashboard (no need for details at this stage, just a high-level view of its content will suffice) always pays its dividends as you avoid some expensive (and frustrating) rework later.</p><div id="_idContainer295" class="note"><p class="Information-Box--PACKT-">When you work on large descriptive analytics initiatives (like building from scratch the business intelligence application layer of a company), the planning phase becomes even more crucial. The advice, in this case, is to keep an <em class="italic">agile</em> mindset and work in small (but always well-planned) iterations where you add functionalities progressively at every step. In this case, the other advice is to make sure you engage your business partners (representing the end users of the dashboard) early on and <em class="italic">co-design</em> the capability together with them instead of presenting the end product when it is done.</p></div><p class="normal">In the case of our sales dashboard, we will need to pull together an overview page that will have to contain sales split by category and subcategory. A bar chart and a treemap can give a good indication of the relative size of each product element (don't worry about the visualization types at this point; we will learn how to pick the best ones in the next chapter). A line chart will be useful to show evolution over time, and it will be nice to visualize the distribution of sales on the world map to hint at any regional patterns. Lastly, our users will need to be able to select specific year ranges and whether to see the domestic sales only (generated in the UK), or the international ones, or both: some slicers will have to be added to give a simple way to filter the data of interest. By keeping the end users' needs in mind, we put together the sketch design that you see in <em class="italic">Figure 6.21</em>: we are, by choice, far from perfection at this stage, but at least we can confidently move on to build visuals knowing what we are aiming for:</p><figure class="mediaobject"><img src="image/B17125_06_21.png" alt=""/></figure><p class="packt_figref">Figure 6.21: A rough sketch of the Sales Overview dashboard page: it's better to decide what data you need to visualize to meet your business needs before creating any chart</p></li>
				<li class="numbered">Go to the <strong class="keyword">Report</strong><strong class="screenText"> </strong>view (first icon on the vertical bar at the left of the main window). In the <strong class="screenText">Visualization</strong> panel on the right (the ones with all the icons showing the different <a id="_idIndexMarker677"/>chart types), click on the icon with the horizontal bar chart (its tooltip label, obtained <a id="_idIndexMarker678"/>when you leave the mouse for a second, reads <strong class="screenText">Stacked Bar Chart</strong>). An empty box pops us on the report page: this is a placeholder for our bar chart. We now need to tell Power BI what data we want this bar chart to show. As shown by the arrows in <em class="italic">Figure 6.22</em>, we need to drag the columns available in the data model (listed in the <strong class="screenText">Fields </strong>panel on the right) and drop them to the properties panel of the visualization. More specifically, the column <em class="italic">Category</em> (open the Product Master Data group to find it) should end up in the <strong class="screenText">Axis </strong>box on the properties panel, while <em class="italic">Sales</em> (in the Transactions table) should be dropped to the <strong class="screenText">Values </strong>box. As soon as you do that, the bar will magically appear on the left, and your first Power BI visual is alive! We could change the <em class="italic">look and feel</em> of the newly created visual (changing colors, titles, fonts, labels, and so on) by using the <strong class="screenText">Format </strong>panel (with the paint roller icon), but, for now, we focus on building the rest of the dashboard, and we move on to the following chart:<figure class="mediaobject"><img src="image/B17125_06_22.png" alt=""/></figure><p class="packt_figref">Figure 6.22: Building a bar chart in Power BI: pick the columns to be used for the axis categories and the height of the bars</p></li>
				<li class="numbered">As we follow through with our sketch, we add now a treemap: this will show the relative size of each <a id="_idIndexMarker679"/>category/subcategory combination in terms of sales. Click on an empty space in the report page and then on the <strong class="screenText">Treemap</strong> visualization icon. To build the visual, drag and drop the fields of interest to the right property boxes (<em class="italic">Figure 6.23</em>): <em class="italic">Category</em> should go to <strong class="screenText">Group</strong>, <em class="italic">Subcategory</em> to <strong class="screenText">Details</strong>, and <em class="italic">Sales</em> to <strong class="screenText">Values</strong>. By now, you should have the essence of building charts in Power BI: we decide what type of visual we need, and then we connect the data columns with the different property fields available for that type of chart:<figure class="mediaobject"><img src="image/B17125_06_23.png" alt="Chart, treemap chart&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.23: Treemap visualization: show the relative size of each group and subgroup</p><div id="_idContainer299" class="note"><p class="Information-Box--PACKT-">You will notice that every chart has got some gray handles at its edges and corners. Use them to resize it and move the chart as needed to fit it to the position you like. Considering the sketch in mind, start putting the visuals in the place where they belong.</p></div></li>
				<li class="numbered">The next visual to <a id="_idIndexMarker680"/>add is a line chart that shows the sales evolution over time. Click on an empty space in the report space and then on the <strong class="screenText">Line chart</strong> icon. You can use <em class="italic">Invoice_time</em> as the column to control the chart <strong class="screenText">Axis</strong> while <em class="italic">Sales</em> will determine the <strong class="screenText">Values</strong> to be visualized. Power BI uses by default only the top level of the time hierarchy: this means that, at first, the visual will show the aggregate sales by year, displaying only three values, one for each year in the 2017-2019 range. Since we would like to show the evolution by month, we need to expand to the levels below in the hierarchy by clicking on the bifurcation arrow on the top right of the visual (follow <em class="italic">Figure 6.24</em> as a guide). The next level shows the split by year/quarters, but this is not enough as we want to move to years/months, so you will need to click on the icon once again: at this point, the title of the chart will become <strong class="screenText">Sales by Year, Quarter and Month</strong>, indicating that we obtained what we were after:<figure class="mediaobject"><img src="image/B17125_06_24.png" alt=""/></figure><p class="packt_figref">Figure 6.24: Building a line chart to show the evolution over time: you can click on the arrow icons at the top right of the chart to navigate through your year/quarter/month/day hierarchy as needed</p></li>
				<li class="numbered">The next chart in our Sales Overview page is the world map, showing sales by country. The good news is that Power BI automatically recognizes geographical names in tables, making it very simple to create map charts. Click on an empty space in the report and then on the <strong class="screenText">Map</strong> visualization (the icon looks like a globe; don't get confused with <strong class="screenText">Filled map,</strong> which shows a sketched map of the United States instead). As <a id="_idIndexMarker681"/>done in <em class="italic">Figure 6.25</em>, drag the column <em class="italic">Country </em>(in the Customer Master Data table) to the <strong class="screenText">Location </strong>box and then use <em class="italic">Sales </em>to control the <strong class="screenText">Size</strong> of the bubbles. You now have a world map showing where revenues originate from: not surprisingly, the biggest bubble is in the United Kingdom, given the prevalence of domestic customers:<figure class="mediaobject"><img src="image/B17125_06_25.png" alt="Chart, treemap chart&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.25: A map chart in its full glory: Power BI recognizes locations like countries, states, and city names, making it simple to build maps enriched with data</p><div id="_idContainer302" class="packt_tip"><p class="Tip--PACKT-">In the map visualization (as in any other chart in Power BI), when you keep the mouse on a visual element (in this case, a bubble on the map), you get a tooltip label that gives you, by default, the precise value referring to that specific element (like the total sales originated in a particular country). Many chart types allow you to control what to show in a tooltip by adding fields to the <strong class="screenText">Tooltips </strong>box.</p></div></li>
				<li class="numbered">It is time to add a couple of<a id="_idIndexMarker682"/> slicers to let the user select what to visualize on the page. The first one will control the time dimension: we want to let the users limit all the visuals on our Sales Overview page to a specific time frame so that they can assess sales by category, subcategory, or country in a given time period. To do so, it will be enough to add a <strong class="screenText">Slicer</strong> visualization and drag the <em class="italic">Invoice_time</em> column to the <strong class="screenText">Field</strong> box, as shown in <em class="italic">Figure 6.26</em>. Slicers are very popular in Power BI: you can add as many as you need and mix multiple fields into one single slicer to allow multi-level selection. For instance, we could combine <em class="italic">Category</em> and <em class="italic">Subcategory</em> together so that users could navigate the entire product hierarchy as they decide what to focus on:<figure class="mediaobject"><img src="image/B17125_06_26.png" alt="Graphical user interface, chart, line chart&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.26: Slicers in Power BI: visually filter your data so you can focus on what matters most.</p></li>
				<li class="numbered">According to our<a id="_idIndexMarker683"/> sketch, our second slicer should discriminate between domestic and international sales. Since we do not have a column that specifies which group a customer belongs to, we need to add a new column that fulfills the need. Power BI provides for <strong class="keyword">Conditional Columns</strong>: these are<a id="_idIndexMarker684"/> calculated columns that apply a given list of logical rules (like a set of <em class="italic">if-then </em>clauses) to determine the value for each row. You will notice that this is similar to what we used to do with the <strong class="keyword">Rule Engine </strong>node in KNIME. To add conditional columns in Power BI, we need to go back to the Power Query Editor window by clicking on the <strong class="screenText">Transform Data</strong> icon on the <strong class="screenText">Home </strong>ribbon menu. After selecting the Customer Master Data query from the list on the left, we can add our column by going to the <strong class="screenText">Add Column</strong> ribbon and clicking on <strong class="screenText">Conditional Column</strong>. You will be prompted with a window like the one shown in <em class="italic">Figure 6.27</em>: after choosing the name of the new column using the textbox on top, you can define one or more <em class="italic">if-then</em> clauses, leveraging operators such as <em class="italic">equals</em>, <em class="italic">is greater than</em>, <em class="italic">includes</em>, and so on. You can append alternative conditions by clicking on the <strong class="screenText">Add Clause </strong>button and also specify the default value to use if none of the conditions is met (the <strong class="screenText">Else</strong> box, at the bottom). In our case, we just want the new column (which we can call <em class="italic">Type</em>) to show <code class="Code-In-Text--PACKT-">Domestic</code> if <em class="italic">Country</em> is <code class="Code-In-Text--PACKT-">United Kingdom</code> and <code class="Code-In-Text--PACKT-">International</code> in any other case:<figure class="mediaobject"><img src="image/B17125_06_27.png" alt="Graphical user interface, text&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.27: Adding a conditional column: define a set of logic clauses to control the column's values</p></li>
				<li class="numbered">Now that we <a id="_idIndexMarker685"/>have the new column <em class="italic">Type</em> available, we can add a new slicer following precisely the same procedure we saw for the time slicer and dropping the new conditional column in the <strong class="screenText">Field </strong>box.</li>
				<li class="numbered">Let's equip our page with a title by going to the <strong class="screenText">Insert</strong> ribbon menu and clicking on the <strong class="screenText">Text box</strong> icon. We can write any text we like (in this case, we enter the page title, which is <code class="Code-In-Text--PACKT-">Sales Overview</code>) and play with the font size and type to make it look good. By dragging all visuals around and rearranging them according to our original sketch, we obtain the page shown in <em class="italic">Figure 6.28</em>:<figure class="mediaobject"><img src="image/B17125_06_28.png" alt=""/></figure><p class="packt_figref">Figure 6.28: Sales Overview page: not bad at all for being our first Power BI creation!</p><p class="normal">This page is already<a id="_idIndexMarker686"/> compelling in its simplicity: it includes several visuals showing the key dimensions of interest within our online retail business. The slicers enable the users to filter their analysis within a specific time frame or country scope. Very importantly, these visuals are all connected with each other: the users can interact with a visual element, causing the other visuals to rearrange their scope. For example, try to click on any bar in the first category bar chart: the line chart will show the sales evolution for that specific category, and the world map will rearrange the size of the bubbles considering only the revenues generated within that particular country. If we select a subcategory from the treemap on the top right, the same will happen, and all other visuals will show the details for that subcategory. This is pretty powerful as we are letting the users discover the data autonomously, customize the views as they like, and, in a way, cook their own data exploration experience versus feeding them with a ready-made meal.</p><div id="_idContainer306" class="packt_tip"><p class="Tip--PACKT-">In Power BI, you can select multiple elements at once by keeping the <em class="italic">CTRL</em> key pressed. Try keeping the <em class="italic">CTRL</em> key pressed and click on two different categories in the bar chart: the sales of those two categories will be aggregated together in the line chart. You can also use this feature to slice the data across visuals. For example, click on a bubble in the map chart and, while keeping the <em class="italic">CTRL</em> key pressed, click on a subcategory from the treemap: the line chart will now show the time evolution of sales for that subcategory in the specific country you selected from the world map.</p></div><p class="normal">Since the charts interact with each other, we might need to fine-tune and modify their dynamic behavior. For instance, if you click on any category on the bar chart, the treemap will <em class="italic">highlight</em> your selection, meaning that all other categories will have their color faded. What if, instead, we want the treemap to react differently and, instead of highlighting the category selected in the bar chart, we want it to show only that category and filter out all others? Let's take this challenge as an opportunity to see how to change the interactions behaviors across visuals in Power BI.</p></li>
				<li class="numbered">Go to the <strong class="screenText">Format </strong>ribbon menu (it appears when you select any chart) and click on the <strong class="screenText">Edit interactions</strong> icon on the left. Select the visual that <em class="italic">controls</em> others (we can call it <strong class="keyword">antecedent</strong>) by clicking on it. In our case, let's click on the bar chart showing sales by <a id="_idIndexMarker687"/>category. As we do so, three icons will appear in the top right of the treemap icon (make sure you resize it accordingly to be able to see the three icons popping up). By clicking on these icons (see <em class="italic">Figure 6.29</em>), you will decide how you want the treemap to respond when a selection on its antecedent occurs: the <strong class="screenText">Filter</strong> icon will make that visual filter out any other data and "focus" on the selection; the <strong class="screenText">Highlight </strong>icon (which is the default behavior) will cause the visual to emphasize the selection applied on the antecedent by coloring it differently; the <strong class="screenText">None </strong>icon will break the connection and make the treemap completely "independent" from any selection on the bar chart. In our case, we click on the <strong class="screenText">Filter</strong> icon (this is the behavior we are after) and then click again on the <strong class="screenText">Edit interactions</strong> icon to get back to the normal editing mode:<figure class="mediaobject"><img src="image/B17125_06_29.png" alt=""/></figure><p class="packt_figref">Figure 6.29: Three steps for changing the interaction behaviors across visuals: click on Edit interactions, select the antecedent visual, and then click on the resulting behavior icon (filter, highlight, or do nothing) on all subsequent visuals</p><div id="_idContainer308" class="note"><p class="Information-Box--PACKT-">Not all visual types allow the three types of interactions we have seen in this example. For instance, line charts only allow for <strong class="screenText">Filter</strong> and <strong class="screenText">None</strong> interactions.</p></div><p class="normal">By looking at the original set of requirements, we realize that we would need a few more visuals to complete our endeavor. Both marketing and category managers need to go beyond the existing visual overview and access some more detailed tabular exhibits. We decide to complete our dashboard by adding a page, called Sales Details, equipped with a handful of tables that match our remaining needs.</p></li>
				<li class="numbered">Click on the <strong class="screenText">+</strong> sign at the<a id="_idIndexMarker688"/> bottom of the <strong class="keyword">Report</strong> view: this will add a blank new page to your dashboard. You can rename every page by right-clicking on its tab and selecting <strong class="screenText">Rename Page</strong>.</li>
				<li class="numbered">Let's add a <strong class="screenText">Matrix</strong> visualization to the new page (don't get confused with the <strong class="screenText">Table</strong> visualization, which we will use later). Now, add the following fields to the various boxes: put <em class="italic">Category</em> first and then, underneath, <em class="italic">Subcategory</em> in the <strong class="screenText">Rows </strong>box. After that, drag <em class="italic">Invoice_time</em> to the <strong class="screenText">Columns</strong> box, and, finally, put <em class="italic">Sales</em> as <strong class="screenText">Values</strong>.</li>
				<li class="numbered">At this point, the table shows only the top level of the product and the time hierarchy (like in <em class="italic">Figure 6.30</em>), as this is its default behavior. To make it useful for our business users, we need to expand those hierarchies by clicking on the bifurcation arrow at the top right of the visual (see step 2 in <em class="italic">Figure 6.30</em>). Once you have done it for rows, use the <strong class="screenText">Drill on</strong> drop-down menus to select columns (step 3 in <em class="italic">Figure 6.30</em>) and click again on the bifurcation arrow (like we did earlier for rows). You have <a id="_idIndexMarker689"/>now obtained quite a rich table, showing quarterly sales by category and subcategory:<figure class="mediaobject"><img src="image/B17125_06_30.png" alt=""/></figure><p class="packt_figref">Figure 6.30: Building a matrix visualization: select the fields to use and decide the aggregation levels for both rows and columns</p></li>
				<li class="numbered">To make the matrix chart more accessible, we can fine-tune a couple of settings to remove some unneeded numbers. Go to the <strong class="screenText">Format</strong> panel (the one having a paint roller icon), scroll down in the list of options, open the <strong class="screenText">Subtotals</strong> view, and switch off <strong class="screenText">Column subtotals</strong> as we don't need the yearly sums (see step 1 in <em class="italic">Figure </em><em class="italic">6.31</em>). Then scroll down and open the <strong class="screenText">Field formatting</strong> view: from here, set <strong class="screenText">Value decimal places</strong> to <code class="Code-In-Text--PACKT-">0</code>, so we remove all those unneeded decimal values, which only create clutter (step 2 in <em class="italic">Figure 6.31</em>):<figure class="mediaobject"><img src="image/B17125_06_31.png" alt="Graphical user interface, application&#10;&#10;Description automatically generated"/></figure><p class="packt_figref">Figure 6.31: Removing the clutter from the matrix visual: deactivate columns subtotals and remove decimal digits</p></li>
				<li class="numbered">Let's add a new visual to give users the ability to focus on domestic or international sales if needs be. This time, add a <strong class="screenText">Donut chart</strong> and set its fields as follows (we don't need to look at any screenshots as this procedure has hopefully become pretty familiar by now): let's use the column <em class="italic">Type</em> as <strong class="screenText">Legend</strong> and <em class="italic">Sales</em> as <strong class="screenText">Values</strong>.</li>
				<li class="numbered">To complete our detailed <a id="_idIndexMarker690"/>view, we shall show aggregated sales by country and by article. Let's start with the country: add a <strong class="screenText">Table</strong> visual and drag and drop the columns <strong class="screenText">Country</strong> and <strong class="screenText">Sales</strong> directly into it (just make sure you follow the specified order, first <strong class="screenText">Country</strong> and then <strong class="screenText">Sales</strong>). By clicking on the header of <em class="italic">Sales </em>in the new table visual, the sales by country are sorted by decreasing revenues, which is what we were looking for.</li>
				<li class="numbered">To add the article details, let's implement another <strong class="screenText">Table</strong> visual and then drag and drop the following columns into it, following this order: <em class="italic">Description</em>, <em class="italic">Quantity</em>, and <em class="italic">Sales</em>. Similarly, as done before, click on the <em class="italic">Sales</em> header in the table visual to put the best-selling articles at the top of the list. To avoid clutter, remove the decimal digits both here and in the previous table, using the <strong class="screenText">Field formatting</strong> | <strong class="screenText">Value decimal places</strong> selectors, as we did for the matrix view.</li>
				<li class="numbered">We should add a title to this page as well. Go to the <strong class="screenText">Insert</strong> ribbon menu, click on the <strong class="screenText">Text box </strong>icon and write <code class="Code-In-Text--PACKT-">Sales Details</code> into it. For coherence, try to put the same font size and type you used for the first page:<figure class="mediaobject"><img src="image/B17125_06_32.png" alt=""/></figure></li>
			</ol>
			<p class="packt_figref">Figure 6.32: Sales Details page: our Power BI dashboard is now complete with the possibility to get to the granular country and product details</p>
			<p class="normal">We are finally done: the second<a id="_idIndexMarker691"/> page you've just pulled together (see <em class="italic">Figure 6.32</em>) has nicely provided what we were missing. Users can now dive into subcategory/quarterly/country combinations (it will be enough to click on the headers of the tables to filter down to the combination they need, keeping <em class="italic">CTRL</em> pressed) and retrieve the top-selling articles within every segmentation of the business.</p>
			<p class="normal">When you publish your new, shiny, two-page dashboard on the Power BI service (if you have an account, even a free one, go to the <strong class="screenText">Home</strong> ribbon menu and click on the <strong class="screenText">Publish </strong>icon to give it a try) and share its URL with your colleagues, you will suddenly become their hero! They can now access the data they need from any browser (see <em class="italic">Figure 6.33</em>) and autonomously deep-dive to the parts of the business they are most interested in:</p>
			<figure class="mediaobject"><img src="image/B17125_06_33.png" alt="Graphical user interface, application&#10;&#10;Description automatically generated"/></figure>
			<p class="packt_figref">Figure 6.33: Browser view of the Sales Overview page once published on the Power BI service: our dashboard looks great from the cloud</p>
			<p class="normal">When traveling, our colleagues<a id="_idIndexMarker692"/> can even check sales results while <em class="italic">on the go</em>: you can see in <em class="italic">Figure 6.34</em> how our dashboard looks in the Power BI app on a smartphone:</p>
			<figure class="mediaobject"><img src="image/B17125_06_34.png" alt="A picture containing text, electronics, screenshot&#10;&#10;Description automatically generated"/></figure>
			<p class="packt_figref">Figure 6.34: The Sales Details page accessed through the Power BI app for iPhone: you can access your data from virtually anywhere</p>
			<p class="normal">The maintenance of the dashboard is relatively lightweight as the updating of all visuals can now happen even daily without much effort. The various queries we have defined know where to pull the data from and what transformation steps are required. When new data pops up, it will be enough to refresh the dashboard by just clicking on the <strong class="screenText">Refresh </strong>icon on the <strong class="screenText">Home</strong> ribbon menu, and the whole dashboard will be nicely up to date.</p>
			<p class="normal">Not only have you finally <a id="_idIndexMarker693"/>democratized access to sales data in the company through a sustainable process that can now be repeated effortlessly, but you have also saved the financial analyst a lot of her precious time. She will not need to answer all the many "ad hoc" questions that she frequently used to receive and that forced her to set up painful manual extractions every time. As the data is now readily available, it is faster and more convenient for people to go and get what they need by themselves, giving back to our financial analyst the precious time she can use for more advanced analytics. It's a real <em class="italic">win-win</em>, and you should feel very proud of having enabled all this.</p>
			<h1 id="_idParaDest-120" class="title"><a id="_idTextAnchor122"/>Summary</h1>
			<p class="normal">By completing this chapter, you have added another precious instrument to your data analytics practitioners' backpack: Power BI. You have learned how to load data and set up a routine of transformation steps required for cleaning that data and making it useful. You have seen how to define the relationships that connect all tables into a single and coherent data model. You have also seen what it means to build interconnected visuals that allow for human interaction. You have created a dashboard that will enable business users to explore the data they need when they need it, <em class="italic">fishing</em> for insights and unveiling business opportunities in complete autonomy.</p>
			<p class="normal">Now, think about the amount of data that lies largely unutilized and inaccessible in company databases (or even in Excel files stored on individuals' laptops). The business opportunities that wait to be unlocked by making this data visually accessible through a simple dashboard are vast and, in many cases, reasonably at hand with tools like Power BI: what you have learned in this chapter can make you a hero to many.</p>
			<p class="normal">In the next chapter, we will learn about some practical guidelines to sharpen our data visualization skills: the objective is to make the best out of every single chart we produce from now on.</p>
		</div>
	</body></html>