<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer082">
<h1 class="chapter-num er" id="_idParaDest-103"><a id="_idTextAnchor168"/>5</h1>
<h1 id="_idParaDest-104"><a id="_idTextAnchor169"/>Exploring Analytics on DeFi</h1>
<p>There are two groups of products that drive the most transactions in the current state of Web3: NFTs, as we discussed in <a href="B19446_04.xhtml#_idTextAnchor145"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, and <strong class="old">decentralized finance</strong> (<strong class="old">DeFi</strong>), which we will explore in <span class="No-Break">this chapter.</span></p>
<p>DeFi takes its name in opposition to the centralized characteristic of the current financial system. According to the book <em class="italic">How to DeFi: Beginner</em>, by CoinGecko, “<em class="italic">Decentralized Finance or DeFi is a movement that allows users to utilize financial services such as borrowing, lending, and trading without the need to rely on centralized entities.</em>” DeFi is not a single product but a series of projects trying to address financial demand in the <span class="No-Break">Web3 space.</span></p>
<p>These projects make use of the concept of <strong class="old">composability</strong>, which involves building upon parts created by other parties. It is often illustrated as building with Lego blocks, where developers combine various components to construct <span class="No-Break">new infrastructures.</span></p>
<p>DeFi has introduced products that were once exclusive to central banks, such as the minting of new coins. Currently, some protocols enable the lending and borrowing of funds for a fee purely dependent on the liquidity of the pool and not external factors. These projects offer varying degrees of decentralization. For example, in the minting offer explained previously, we can encounter a stablecoin issued by a centralized entity named Tether or a decentralized option such as DAI, a protocol composed of a set of smart contracts with no <span class="No-Break">central authority.</span></p>
<p>DeFi has also expanded its offerings to other native Web3 businesses, such as bridges between chains and flash loans. We will explain these in more detail in the <span class="No-Break">subsequent sections:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer071">
<img alt="Figure 5.1 – Bank services and blockchain services" height="897" src="image/B19446_05_01.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – Bank services and blockchain services</p>
<p>The disparities in financial services across the population are nothing new, and many of these DeFi projects aim to expand the reach of financial services wherever there is internet access. As Web3 analysts, we can leverage one of the main characteristics of Web3 – <strong class="old">transparency</strong> – to unlock more value and help make these projects sustainable. Financial data that was traditionally limited to VIP analysts or released to the market at different times is now open for us to read, combine, and extract valuable insights to work on. Blockchain has democratized access; it is on us to learn how to read it and extract <span class="No-Break">actionable insights.</span></p>
<p>To generate value with our work, it is essential to understand not only the data generated but also the DeFi business flow. As we did in <a href="B19446_04.xhtml#_idTextAnchor145"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, we will delve into fundamental protocol metrics, offering quick insights into each protocol’s structure and user composition, but also those metrics that explain how a project generates revenue, reaches customers, deals with potential threats, and other <span class="No-Break">relevant aspects.</span></p>
<p>In this chapter, we will explore the data structure and the business rationale of <span class="No-Break">the following:</span></p>
<ul>
<li>ERC-20 tokens <span class="No-Break">and stablecoins</span></li>
<li>DEXs <span class="No-Break">and aggregators</span></li>
<li>Lending and borrowing (with a comment on <span class="No-Break">flash loans)</span></li>
<li><span class="No-Break">Bridges</span></li>
</ul>
<p>This list of products is not exhaustive of the DeFi space. There are many other offers, such as decentralized derivatives, insurance, governance, lotteries, <span class="No-Break">and more.</span></p>
<h1 id="_idParaDest-105"><a id="_idTextAnchor170"/>Technical requirements</h1>
<p>The technical requirements listed in <a href="B19446_04.xhtml#_idTextAnchor145"><span class="No-Break"><em class="italic">Chapter 4</em></span></a> also apply to this chapter. We will be using indexed data available in SQL table services like <strong class="old">Dune Analytics</strong>, <strong class="old">Increment</strong>, and <strong class="old">Flipside</strong>. To follow along, please open an account on any of these platforms by following the links provided in <a href="B19446_02.xhtml#_idTextAnchor073"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>. Transactional data is queried with SQL services, and the syntax varies, depending on the <span class="No-Break">query engines.</span></p>
<p>You can find Jupyter notebooks containing the examples discussed in this chapter in this book’s GitHub repository at <a href="https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter05">https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter05</a>. We recommend reading through the code files in the <strong class="source-inline">Chapter05</strong> folder to <span class="No-Break">follow along.</span></p>
<h1 id="_idParaDest-106"><a id="_idTextAnchor171"/>Stablecoins and other tokens</h1>
<p>According to Coinbase, “<em class="italic">A stablecoin is a digital currency that is pegged to a “stable” reserve asset such as the US dollar or gold.</em>” Given that unpegged cryptocurrencies <a id="_idIndexMarker276"/>such as Bitcoin or Ethereum are so volatile, stablecoins have become a reliable medium of exchange. The main stablecoins, according to their market cap at the time of writing, are listed in <span class="No-Break"><em class="italic">Figure 5</em></span><span class="No-Break"><em class="italic">.2</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer072">
<img alt="Figure 5.2 – Crypto panic stablecoins ranking" height="341" src="image/B19446_05_02.jpg" width="952"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 – Crypto panic stablecoins ranking</p>
<p>Stablecoins are a <a id="_idIndexMarker277"/>specific category of tokens that are linked to the value of external assets, providing price stability. There are various types of stablecoins, including those whose value follows the value of a government-issued currency such as the US dollar (named fiat currencies), cryptocurrencies, and commodities such as gold. To maintain the “peg,” stablecoin teams have explored many paths. This can be seen in the “Mechanism” column in <span class="No-Break"><em class="italic">Figure 5</em></span><span class="No-Break"><em class="italic">.2</em></span><span class="No-Break">.</span></p>
<p>The main stablecoins are pegged to fiat (“fiat-backed”), meaning that the companies issuing such tokens only do so if they have the backup money deposited in financial institutions. Examples of such stablecoins are USDT <span class="No-Break">and USDC.</span></p>
<p>Crypto-backed stablecoins rely<a id="_idIndexMarker278"/> on smart contract protocols that issue stablecoins backed by a basket of other cryptocurrencies. These protocols balance offer and demand to ensure price stability by controlling interest loan rates to influence buyers’ and borrowers’ behavior. The system is overcollateralized to ensure price stability when there is high volatility and mainly works as a lender system. The main example of this mechanism is the token named DAI. It is issued by MakerDAO and is currently backed by a mixture of centralized and decentralized assets, such as USDC, Ethereum, Wrapped Bitcoin, <span class="No-Break">and others.</span></p>
<p>Stablecoins can be created to mirror the value of the cryptocurrencies supporting them or to mimic the value of a fiat currency. An example of the former is the <strong class="old">wrapped</strong> version of an asset, often referred to as a “wrapped token,” which is a representation of an underlying asset, typically a cryptocurrency or digital asset, that has been tokenized and made compatible with a specific blockchain or network. The process of “wrapping” involves locking the original asset (for example, Bitcoin) on its native blockchain and then issuing the corresponding equivalent token on another blockchain, such as Ethereum. This is what happens <a id="_idIndexMarker279"/>with <strong class="old">Wrapped Bitcoin</strong> (<strong class="old">WBTC</strong>), which represents Bitcoin on the Ethereum blockchain, allowing Bitcoin to be used within the Ethereum ecosystem for decentralized applications, DeFi platforms, and <span class="No-Break">other purposes.</span></p>
<p>Even though non-stable tokens emerged historically before stablecoins, it is easier to understand the concept of a token by learning about stablecoins. A <strong class="old">token</strong> is simply a representation of value on the <a id="_idIndexMarker280"/>blockchain and such value can be derived from any rationale. For instance, some tokens represent ownership in a particular project, access to services, or even serve as part of a meme or cultural movement. Notably, some tokens, such as Dogecoin, which started as a meme, have achieved significant market capitalization, demonstrating the diversity of tokens in the cryptocurrency space. Today, such a meme coin is the eighth cryptocurrency in the <span class="No-Break">market cap.</span></p>
<p>Now that we know the business case, let's delve into the <span class="No-Break">data structure.</span></p>
<h2 id="_idParaDest-107"><a id="_idTextAnchor172"/>Understanding tokens, native assets, and the ERC-20 data structure</h2>
<p>Cryptocurrency serves <a id="_idIndexMarker281"/>as the native asset of a blockchain, such as BTC in the Bitcoin chain, ETH in the Ethereum chain, and RBTC on the Rootstock chain. Its primary function is often to pay transaction fees on the network (gas fees) and incentivize validators/nodes to maintain the security of the <span class="No-Break">cryptocurrency’s network.</span></p>
<p>In contrast, tokens are created over an existing blockchain and are not native to the blockchain itself. Stablecoins, pool tokens, and all ERC-20 tokens in the Ethereum ecosystem are examples <span class="No-Break">of tokens.</span></p>
<p>To build <a id="_idIndexMarker282"/>tokens, developers utilize the ERC-20 standard and its subsequent evolutions, which introduces a standard for functional tokens and ensures their fungibility. Recall that fungible refers to assets or tokens that are identical in value and can be exchanged on a one-to-one basis, with no distinction between individual units of the same type. The ERC-20 standard was initially introduced in 2015 and gained official recognition through <a id="_idIndexMarker283"/>an <strong class="old">Ethereum Improvement Proposal</strong> (<strong class="old">EIP</strong>) authored by Ethereum founder Vitalik Buterin and Ethereum developer Fabian Vogelsteller <span class="No-Break">in 2017.</span></p>
<p>The smart contract that follows those methods and events is called ERC-20-compliant and is the contract that <a id="_idIndexMarker284"/>will maintain the registry of the tokens emitted, which is why it is very relevant for the analyst to learn about its <span class="No-Break">basic characteristics.</span></p>
<p>The function <a id="_idIndexMarker285"/>methods we will encounter are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="source-inline">totalSupply()</strong>: To return the total supply of tokens in <span class="No-Break">the contract.</span></li>
<li><strong class="source-inline">balanceOf()</strong>: To read the <span class="No-Break">address balance.</span></li>
<li><strong class="source-inline">transfer()</strong>: To transfer tokens from the sender’s account <span class="No-Break">to another.</span></li>
<li><strong class="source-inline">transferFrom()</strong>: To spend an allowance. This is a function that’s called by the spender that implies two operations – that is, transferring the amount being spent and reducing the allowance by such <span class="No-Break">an amount.</span></li>
<li><strong class="source-inline">approve()</strong>: To allow the spender to withdraw from the token owner's account multiple times, up to the approved <span class="No-Break">value amount.</span></li>
<li><strong class="source-inline">allowance()</strong>: To return the amount allowed for withdrawal from the token <span class="No-Break">owner’s account.</span></li>
</ul>
<p>It is possible to find the <strong class="source-inline">mint</strong> and <strong class="source-inline">burn</strong> functions, which modify the total supply of tokens according to a specific business logic. Here are some <span class="No-Break">optional functions:</span></p>
<ul>
<li><strong class="source-inline">name()</strong>: Returns the name of <span class="No-Break">the token</span></li>
<li><strong class="source-inline">symbol()</strong>: Returns the symbol of <span class="No-Break">the token</span></li>
<li><strong class="source-inline">decimals()</strong>: Returns the number of decimals the <span class="No-Break">token uses</span></li>
</ul>
<p>Here are some <span class="No-Break">important events:</span></p>
<ul>
<li><strong class="source-inline">transfer</strong>: This event is triggered by the <strong class="source-inline">transfer()</strong>function. The same considerations explained in <a href="B19446_04.xhtml#_idTextAnchor145"><span class="No-Break"><em class="italic">Chapter 4</em></span></a> regarding minting and burning apply, if a transfer originates “from” an address such as <strong class="source-inline">0x0000,</strong> we can interpret this as a minting event. If this address or <strong class="source-inline">0x000dEad</strong> is found in the <strong class="source-inline">to</strong> part of the transaction, it can be considered a burning transfer. Minting signifies their creation while burning means they are sent to an unrecoverable address, removing them from circulation. The function’s hash <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df5</strong></span><strong class="source-inline">
</strong><span class="No-Break"><strong class="source-inline">23b3ef</strong></span><span class="No-Break">.</span></li>
<li><strong class="source-inline">approval</strong>: This event is triggered by the <strong class="source-inline">approve()</strong> function with the allowance value and the <span class="No-Break">spender address.</span></li>
</ul>
<h2 id="_idParaDest-108"><a id="_idTextAnchor173"/>Hands-on example</h2>
<p>Now that we know the basics, let’s go to the Jupyter notebook (<strong class="source-inline">Chapter05/Stablecoins.ipynb</strong>) where we will connect to the DAI contract (<strong class="source-inline">0x6B175474E89094C44Da98b954EedeAC495271d0F</strong>) and extract the public <span class="No-Break">view information.</span></p>
<p>A <strong class="old">view</strong> function<a id="_idIndexMarker286"/> means that it does not change the state data, so it can be executed on a single node instead of having every node in the blockchain run it. This kind of<a id="_idIndexMarker287"/> function does not generate a transaction and does not <span class="No-Break">cost gas.</span></p>
<p>To inspect the DAI contract, we will use DAI’s ABI, which can be found in this book’s repository. Let’s start by extracting the balance of a certain address with the following <span class="No-Break">code snippet:</span></p>
<pre class="console">
daiContract.functions.balanceOf('0x60FaAe176336dAb62e284Fe19B885B095d29fB7F').call()*10**-18</pre> <p>The relevant ERC-20 events are stored in the transaction logs. Let’s analyze the <strong class="source-inline">0x2a9317882853dc5e0193a76dab76b29e4dc8045718af7925d8d166cdb0eec637</strong> transaction, which involves a transfer of 120 DAIs between <span class="No-Break">two addresses:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer073">
<img alt="Figure 5.3 – DAI transfer transaction (source: https://etherscan.io/tx/0x2a9317882853dc5e0193a76dab76b29e4dc8045718af7925d8d166cdb0eec637)" height="861" src="image/B19446_05_03.jpg" width="1452"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – DAI transfer transaction (source: https://etherscan.io/tx/0x2a9317882853dc5e0193a76dab76b29e4dc8045718af7925d8d166cdb0eec637)</p>
<p>If we search<a id="_idIndexMarker288"/> for the transaction logs, we’ll receive the <span class="No-Break">following informa<a id="_idTextAnchor174"/>tion:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer074">
<img alt="Figure 5.4 – DAI transfer transaction logs (source: https://etherscan.io/tx/0x2a9317882853dc5e0193a76dab76b29e4dc8045718af7925d8d166cdb0eec637)" height="528" src="image/B19446_05_04.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – DAI transfer transaction logs (source: https://etherscan.io/tx/0x2a9317882853dc5e0193a76dab76b29e4dc8045718af7925d8d166cdb0eec637)</p>
<p>The data we can see here is within the Ethereum <strong class="old">logs</strong> associated with the smart contract address of <span class="No-Break">DAI: </span><span class="No-Break"><strong class="source-inline">0x6b175474e89094c44da98b954eedeac495271d0f</strong></span><span class="No-Break">.</span></p>
<p>The raw log structure looks <span class="No-Break">like this:</span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-5">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Event name or <span class="No-Break">Topic [0]</span></p>
</td>
<td class="No-Table-Style">
<p>Transfer (or <span class="No-Break"><strong class="source-inline">0xddf252ad1be2c89b69c2b068fc 378daa952ba7f163c4a11628f55a</strong></span><strong class="source-inline">
</strong><span class="No-Break"><strong class="source-inline">4df523b3ef</strong></span><span class="No-Break" lang="en-US" xml:lang="en-US">)</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>From - <span class="No-Break">Topic [1]</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline">0xc6DA6f76a389Df871fffad8bb5049cbcF6b7015F</strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>To - <span class="No-Break">Topic [2]</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline">0x762EcaaF67097b3eb66a9a6904f42b835b52DC15</strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>wad - <span class="No-Break">Topic [3]</span></p>
</td>
<td class="No-Table-Style">
<p><strong class="source-inline">0x0000000000000000000000000000000000000000000000068155a43676e00000</strong> (<span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">120000000000000000000</strong></span><span class="No-Break">)</span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.1 – The raw log structure</p>
<p>A <strong class="old">wad</strong> is a <a id="_idIndexMarker289"/>decimal number with 18 digits of precision that is represented as an integer. In this transaction, it represents the number of tokens transacted, which is 120. If we paste the wad value in a hexadecimal-to-decimal converter such as the one at <a href="https://www.rapidtables.com/convert/number/hex-to-decimal.xhtml">https://www.rapidtables.com/convert/number/hex-to-decimal.xhtml</a>, it will show the decimal representation with <span class="No-Break">18 digits.</span></p>
<p>All the<a id="_idIndexMarker290"/> data suppliers we studied in <a href="B19446_02.xhtml#_idTextAnchor073"><span class="No-Break"><em class="italic">Chapter 2</em></span></a> have special tables that store transaction logs with varying levels of preprocessing. The most basic versions are the raw logs to more filtered versions, which display only ERC 20 token transfers and the prices of the tokens at the time of the transfer. One example is Flipside, which has a specific table named <strong class="source-inline">core__fact_token_transfers</strong> that contains all the events on the Ethereum blockchain with the name <strong class="source-inline">'Transfer'</strong>; that refers to a token address. Similarly, Dune Analytics spells enable a similar table named<strong class="source-inline"> erc20_ethereum.evt_Transfer</strong>, and Increment has a model named <span class="No-Break"><strong class="source-inline">token balance</strong></span><span class="No-Break">.</span></p>
<p>By aggregating this data, we can derive a wide variety of metrics. Let’s see the calculation of the DAI current supply by leveraging the <span class="No-Break"><strong class="source-inline">erc20_ethereum.evt_Transfer</strong></span><span class="No-Break"> table:</span></p>
<pre class="console">
WITH current_supply AS
(
    SELECT
   cast (tr.value as double)/ 1e18 AS supply
   FROM erc20_ethereum.evt_Transfer tr
    WHERE "contract_address" = 0x6b175474e89094c44da98b954eedeac495271d0f -- DAI
    and tr."from" = 0x0000000000000000000000000000000000000000
UNION ALL
    SELECT
 - cast (tr.value as double)/ 1e18 AS supply
   FROM erc20_ethereum.evt_Transfer tr
    WHERE "contract_address" = 0x6b175474e89094c44da98b954eedeac495271d0f -- DAI
    and tr."to" = 0x0000000000000000000000000000000000000000
)
select sum (supply)/1000000000 as supply
from current_supply</pre> <p>In this query, we <a id="_idIndexMarker291"/>calculate the DAI current supply by aggregating the transfers within the DAI contract address. Here, we do <span class="No-Break">the following:</span></p>
<ul>
<li>The query <a id="_idIndexMarker292"/>uses a <strong class="old">Common Table Expression</strong> (<strong class="old">CTE</strong>) named <strong class="source-inline">current_supply</strong> to structure <span class="No-Break">the data.</span></li>
<li>The first part of the CTE calculates the total supply increase by summing the transferred amounts (converted from wei to DAI), where DAI is transferred <em class="italic">from</em> the zero address (<strong class="source-inline">0x0000000000000000000000000000000000000000</strong>). This represents the creation of new <span class="No-Break">DAI tokens.</span></li>
<li>The second part of the CTE calculates the total supply decrease by summing the transferred amounts (also converted from wei to DAI), where DAI is transferred <em class="italic">to</em> the zero address. This represents the burning or removal of DAI tokens <span class="No-Break">from circulation.</span></li>
<li>The main query then calculates the final total supply by subtracting the total supply decrease from the total supply increase (that is, supply increase – <span class="No-Break">supply decrease).</span></li>
<li>The result is divided by 1,000,000,000 to convert it into a <span class="No-Break">billion DAI.</span></li>
</ul>
<p>In summary, this<a id="_idIndexMarker293"/> query finds the net change in the total supply of DAI tokens by taking into account both minting and burning transactions and then converting the result to a <span class="No-Break">billion DAI.</span></p>
<p>We propose an additional metrics logic in the following dashboard: <a href="https://dune.com/gabriela/dai-cockpit">https://dune.com/gabriela/dai-cockpit</a>. Additionally, there is a great open source stablecoin dashboard available <span class="No-Break">at </span><span class="No-Break">https://dune.com/hagaetc/stablecoins</span><span class="No-Break">.</span></p>
<p>This same analysis can be applied to any ERC-20 token; it’s not necessarily limited to stablecoins. For instance, if we take the MKR token as an example, an excellent open source dashboard can be found <span class="No-Break">at </span><a href="https://dune.com/livethelife/mkr"><span class="No-Break">https://dune.com/livethelife/mkr</span></a><span class="No-Break">.</span></p>
<p>A pivotal aspect of ERC-20 tokens is their seamless interchangeability within the Ethereum network. This characteristic of ERC-20 tokens plays a crucial role in the operation <a id="_idIndexMarker294"/>of <strong class="old">decentralized exchanges</strong> (<strong class="old">DEXs</strong>). DEXs leverage the ERC-20 standard to provide users with the ability to trade a myriad of tokens directly from their wallets, without the need for intermediaries. This connection between ERC-20 tokens and DEXs forms the cornerstone of the DeFi space, empowering users to trade, invest, and participate in <span class="No-Break">financial activities.</span></p>
<h1 id="_idParaDest-109"><a id="_idTextAnchor175"/>Understanding DEX</h1>
<p>Cryptocurrencies can <a id="_idIndexMarker295"/>be exchanged through various methods, including <strong class="old">peer-to-peer</strong> (<strong class="old">P2P</strong>) trading, <strong class="old">centralized exchanges</strong> (<strong class="old">CEXs</strong>), and <a id="_idIndexMarker296"/>DEXs. Each <a id="_idIndexMarker297"/>method has its <a id="_idIndexMarker298"/>advantages <span class="No-Break">and characteristics:</span></p>
<ul>
<li><strong class="old">P2P</strong>: In this method, two parties directly buy and sell cryptocurrencies among themselves without intermediaries. It prioritizes privacy and enables a wide range of payment options, making it accessible to users worldwide. However, to ensure the completion of the transfer, certain players have appeared that may act as intermediaries for a small fee, such as escrow services, rating platforms, or dispute <span class="No-Break">resolution services.</span></li>
<li><strong class="old">CEX</strong>: This<a id="_idIndexMarker299"/> method offers cryptocurrency exchange services to users who have an account on their platform. It primarily matches buyers with sellers using an order book, where market makers and takers place their orders. The CEX’s revenue is generated through transaction fees on each facilitated trade. Major CEXs include Binance, OKX, Coinbase, and Crypto.com. The CEX also verifies the identity of each person opening an account, following the regulations of the relevant country. These exchanges are user-friendly and offer liquidity and a wide range of trading pairs. They generally act as the entry point for many users starting in crypto. The term “centralized” refers to the exchange’s control over the funds exchanged within it. This has several implications: as users are not in custody of their assets, if the CEX is attacked or becomes insolvent for any reason (such as a bank run), there is a risk of <span class="No-Break">losing funds.</span></li>
<li><strong class="old">DEX</strong>: A DEX <a id="_idIndexMarker300"/>operates through smart contracts without the involvement of third-party entities and prioritizes user control, privacy, and security. It allows users to exchange assets while keeping control of their funds in their wallets until the trade is completed. DEXs have gained popularity and, during the 2021 bull run, surpassed the amount of money traded in CEXs. However, liquidity on DEXs is often lower compared <span class="No-Break">to CEXs.</span></li>
</ul>
<p>Now, let’s analyze some characteristics of <span class="No-Break">DEXs further:</span></p>
<ul>
<li><strong class="old">Custody of funds</strong>: Users do not delegate the custody of their funds to a <span class="No-Break">third party.</span></li>
<li><strong class="old">No identification required</strong>: Users can freely interact with a DEX without the need for any form of identification. All that is required is an address to connect to <span class="No-Break">the DEX.</span></li>
<li><strong class="old">High gas fees</strong>: DEX transactions often incur higher gas fees on the blockchain compared to <span class="No-Break">CEX trades.</span></li>
<li><strong class="old">Liquidity problems and slippage</strong>: Slippage refers to the difference between the expected price of an asset and the actual price at which the trade is executed. As<a id="_idIndexMarker301"/> liquidity is provided by users rather than a centralized entity, the size of a trade can impact the asset’s price. When a large trade is executed, it may cause the price to move unfavorably, resulting in slippage. This means the trader ends up paying a slightly higher price when buying or receiving a slightly lower price when selling than what they anticipated. Slippage is a reality in DeFi trading, especially in less <span class="No-Break">liquid markets.</span></li>
<li><strong class="old">Impermanent loss</strong>: This is a potential risk that’s <a id="_idIndexMarker302"/>faced by liquidity providers in <strong class="old">automated market maker</strong> (<strong class="old">AMM</strong>) platforms. When a liquidity provider adds funds to a liquidity pool, they contribute assets to be traded on the platform. As trades occur, the relative value of the assets in the pool can change due to market fluctuations. If the price of one asset in the pool moves significantly compared to the other asset, the liquidity provider may experience an impermanent loss. This loss is “impermanent” because it only materializes if the liquidity provider decides to withdraw their funds from <span class="No-Break">the pool.</span></li>
<li><strong class="old">Complex user experience and learning curve</strong>: Interacting with DEX protocols can still be challenging for DeFi users, and the overall user experience may require improvement. Concepts such as slippage or impermanent loss still affect the <span class="No-Break">trading experience.</span></li>
<li><strong class="old">Bugs and exploits</strong>: Like any smart contract-based system, DEXs may be susceptible to bugs and <span class="No-Break">security exploits.</span></li>
</ul>
<p>To analyze the analytics of a DEX, we need to understand where the liquidity is locked, how trading pairs are organized, and how the smart contract generates revenue. This way, we will be able to approach the relevant smart <span class="No-Break">contract swiftly.</span></p>
<h2 id="_idParaDest-110"><a id="_idTextAnchor176"/>Hands-on example – pools and AMM</h2>
<p>To <a id="_idIndexMarker303"/>understand DEXs, two important concepts need to be introduced: liquidity pools and AMM. DEXs use liquidity pools and AMM to facilitate trading activity, also <a id="_idIndexMarker304"/>known <span class="No-Break">as </span><span class="No-Break"><strong class="old">swaps</strong></span><span class="No-Break">.</span></p>
<p><strong class="old">Liquidity pools</strong> are<a id="_idIndexMarker305"/> token reserves that enable the user to exchange tokens with it. Anyone can open a pool by providing the necessary funds and without the need to seek permission from any central authority. The liquidity is allocated within a curve price and an algorithm places the bids and asks to execute the swaps. Chainlink defines <strong class="old">AMMs</strong> as “<em class="italic">algorithmic “money robots” to make it easy for individual traders to buy and sell crypto assets. Instead of trading directly with other people as with a traditional order book, users trade directly through </em><span class="No-Break"><em class="italic">the AMM.</em></span><span class="No-Break">”</span></p>
<p>One prominent<a id="_idIndexMarker306"/> DEX is <strong class="old">Uniswap</strong>, which uses liquidity pools and AMM. The landing page looks <span class="No-Break">as follows:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer075">
<img alt="Figure 5.5 – The home page of Uniswap (source: https://app.uniswap.org/#/swap)" height="624" src="image/B19446_05_05.jpg" width="793"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – The home page of Uniswap (source: https://app.uniswap.org/#/swap)</p>
<p>Uniswap has a pool dashboard at <a href="https://info.uniswap.org/#/pools">https://info.uniswap.org/#/pools</a> that contains some basic analytics of the active liquidity pools. At the time of writing, the first pool in <strong class="old">TVL</strong> and <strong class="old">Volume</strong> is the USDC/ETH <span class="No-Break">pair (</span><span class="No-Break">https://info.uniswap.org/#/pools/0x88e6a0c2ddd26feeb64f039a2c41296fcb3f5640</span><span class="No-Break">):</span></p>
<div>
<div class="IMG---Figure" id="_idContainer076">
<img alt="Figure 5.6 – The All Pools dashboard" height="481" src="image/B19446_05_06.jpg" width="1488"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 – The All Pools dashboard</p>
<p>The<a id="_idIndexMarker307"/> smart contract address of the pool <span class="No-Break">is </span><a href="https://etherscan.io/address/0x88e6a0c2ddd26feeb64f039a2c41296fcb3f5640"><span class="No-Break">https://etherscan.io/address/0x88e6a0c2ddd26feeb64f039a2c41296fcb3f5640</span></a><span class="No-Break">.</span></p>
<p>By programmatically exploring the pool’s state data on <strong class="source-inline">Chapter05/Liquidity_pool.ipynb</strong>, we can identify the tokens that compose the pool by using the Pool ABI and reading the smart contract data with the following <span class="No-Break">code snippet:</span></p>
<pre class="console">
poolContract.functions.token0().call()
poolContract.functions.token1().call()</pre> <p>The result is <span class="No-Break">as follows:</span></p>
<ul>
<li>Token 0: <strong class="source-inline">0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48</strong> <span class="No-Break">or USDC</span></li>
<li>Token 1: <strong class="source-inline">0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2</strong> <span class="No-Break">or wETH</span></li>
</ul>
<p>Both are stablecoins, with one following the US dollar and the other representing the native Ethereum asset in <span class="No-Break">wrapped form.</span></p>
<p>To obtain the balance locked of each token, we can use <strong class="source-inline">erc_20.abi</strong>, which is available in this book’s GitHub repository, and query the pool with the following <span class="No-Break">code snippet:</span></p>
<pre class="console">
web3.eth.contract(address=token0, abi=erc_abi)</pre> <p>More on the available view functions can be found in the <span class="No-Break">documentation: </span><a href="https://docs.uniswap.org/contracts/v3/reference/core/interfaces/pool/IUniswapV3PoolState"><span class="No-Break">https://docs.uniswap.org/contracts/v3/reference/core/interfaces/pool/IUniswapV3PoolState</span></a><span class="No-Break">.</span></p>
<p>To <a id="_idIndexMarker308"/>extract information from transactional data, we need to dig deeper into logs. Let’s review a swap transaction and try to understand how the information we need is logged. The swap transaction to analyze is <strong class="source-inline">0x78490143b8a80b23752bd305b51c7796add5373af089059beb3920c8e431ae78</strong> and is executed in the <strong class="source-inline">0x3041cbd36888becc7bbcbc0045e3b1f144466f5f</strong> pool, which swaps between USDC <span class="No-Break">and USDT.</span></p>
<p>On Etherscan (https://etherscan.io/tx/0x78490143b8a80b23752bd305b51c7796add5373af089059beb3920c8e431ae78/), we can see <span class="No-Break">the following:</span></p>
<ul>
<li>From or <span class="No-Break">sender: </span><span class="No-Break"><strong class="source-inline">0xaDAf0dA2F42bf54E2Ccf455F795A04ECD744138B</strong></span></li>
<li>To: <strong class="source-inline">0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD</strong> (Uniswap: <span class="No-Break">Universal Router)</span></li>
</ul>
<p>Nowadays, most swaps do not directly impact the pool smart contract. Instead, they interact with a Router smart contract, such as a Uniswap Universal smart contract. The router’s mission is to take user-defined parameters (such as maximum slippage or swap recipient) and execute the necessary swaps to reach the trader’s goal. The router can combine multiple pools and even NFT marketplaces and is optimized to find the lowest prices and lowest <span class="No-Break">gas cost.</span></p>
<p>The transaction summary is <span class="No-Break">as follows:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer077">
<img alt="Figure 5.7 – Transaction swaps" height="96" src="image/B19446_05_07.jpg" width="976"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – Transaction swaps</p>
<p>From <span class="No-Break"><em class="italic">Figure 5</em></span><em class="italic">.7</em>, we can interpret that the user, in one transaction, carried out a swap of XPR for USDT and later interacted with the pool under analysis to swap USDT <span class="No-Break">for USDC.</span></p>
<p><span class="No-Break"><em class="italic">Figure 5</em></span><em class="italic">.8</em> shows a partial snapshot of the transaction logs page. The last log in particular contains <span class="No-Break">valuable information:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer078">
<img alt="Figure 5.8 – Swap log" height="511" src="image/B19446_05_08.jpg" width="1638"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – Swap log</p>
<p><span class="No-Break"><em class="italic">Figure 5</em></span><em class="italic">.8</em> shows <a id="_idIndexMarker309"/>that the relevant information for the swap is located in the logs of the pool address. As you may recall from <a href="B19446_02.xhtml#_idTextAnchor073"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <strong class="source-inline">topic_0</strong> is the function signature. In this case, <strong class="source-inline">0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822</strong> is the <span class="No-Break"><strong class="old">swap</strong></span><span class="No-Break"> function.</span></p>
<p>Additional relevant functions are the mint or add liquidity function, which has a signature of <strong class="source-inline">0x4c209b5fc8ad50758f13e2e1088ba56a560dff690a1c6fef26394f4c03821c4f</strong>, and the burn or remove liquidity function, which has a signature <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">0xdccd412f0b1252819cb1fd330b93224ca42612892bb3f4f789976e6d81936496</strong></span><span class="No-Break">.</span></p>
<p>When liquidity is added or<a id="_idIndexMarker310"/> removed, the <strong class="old">liquidity providers</strong> (<strong class="old">LPs</strong>) receive LP tokens that represent their stake in the pool. These LP tokens can be traded in a secondary market, accrue interest, and sent to the pool when you’re looking to extract the liquidity back to <span class="No-Break">the LP.</span></p>
<p>If we interact with the <strong class="source-inline">ethereum.logs</strong> table in Dune, we can extract the number of swaps carried out by the pool, <span class="No-Break">as follows:</span></p>
<pre class="console">
select count (*) as n_trades
from ethereum.logs
where contract_address= 0x3041cbd36888becc7bbcbc0045e3b1f144466f5f
and topic0=0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d13 0840159d822</pre> <p>Another<a id="_idIndexMarker311"/> important piece of information to compare a pool with another that may offer the same token exchange is the strength of the pool for high liquidity trades. When large trades impact the reserves of the pool, there is a problem of slippage that, as we saw, can impact the final paid price. Here, it is important to study metrics related to the TVL, the liquidity of the pool, and so on. These metrics are typically calculated from aggregated transaction data. We propose some metrics logic in the following <span class="No-Break">dashboard: </span><a href="https://dune.com/gabriela/pool-basic-metrics"><span class="No-Break">https://dune.com/gabriela/po<span id="_idTextAnchor177"/>ol-basic-metrics</span></a><span class="No-Break">.</span></p>
<p>As we have been mentioning, in <a href="B19446_02.xhtml#_idTextAnchor073"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, we studied special tables that store transaction logs, with varying levels of preprocessing that adapt to the needs of the analyst. Some on-chain data providers even offer models that allow us to query the blockchain without writing code. Examples of such decoding services include the <strong class="source-inline">dex.trades</strong> tables on Dune or the Increment platform on Covalent, which has a drag-and-drop analytics service. Both Dune and Footprint are developing natural language queries to simplify the basic analysis of <span class="No-Break">transaction data.</span></p>
<p>These tables and decoded data can vary between providers but what matters most is understanding the logic behind each query and familiarizing ourselves with the structure of log data. This will allow us to extract information or adapt queries to different table formats if needed, even controlling that the results returned by an NLP model are correct no matter the platform with which we are working. If we know the logic of the business and how the data is logged on the blockchain, we can solve the data questions using <span class="No-Break">every platform.</span></p>
<p>Leveraging what we’ve already learned and the Dune Analytics tables listed here, we can create metrics that track the activity and revenue of the USDC/USDT pool under analysis. The tables are <span class="No-Break">as follows:</span></p>
<ul>
<li>A raw data table <span class="No-Break">named </span><span class="No-Break"><strong class="source-inline">ethereum.logs</strong></span></li>
<li>An intermediate processed table named <strong class="source-inline">erc20_ethereum.evt_Transfer</strong> that includes logs signed <span class="No-Break">as transfers</span></li>
<li>An advanced decoded table <span class="No-Break">named </span><span class="No-Break"><strong class="source-inline">dex.trades</strong></span></li>
</ul>
<p>Here is a brief explanation of the logic behind the metrics displayed in the dashboard <span class="No-Break">at </span><span class="No-Break">https://dune.com/gabriela/pool-basic-metrics</span><span class="No-Break">:</span></p>
<table class="T---Table _idGenTablePara-1" id="table002-3">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><strong class="old"><a id="_idTextAnchor178"/>Name in </strong><span class="No-Break"><strong class="old">the Dashboard</strong></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><strong class="old"><a id="_idTextAnchor179"/></strong><span class="No-Break"><strong class="old">Logic</strong></span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor180"/>Number <span class="No-Break">of trades</span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor181"/>Count the number of swaps with the specified signature within the pool smart <span class="No-Break">contract logs.</span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><span lang="en-US" xml:lang="en-US"><a id="_idTextAnchor182"/></span>Traders logs <span class="No-Break">24 hs</span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor183"/>Count the distinct addresses that appear in topic 2 of the Pool smart contract log with a “swap” as <span class="No-Break">topic 0.</span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor184"/>Average swap volume <span class="No-Break">24 hs</span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor185"/>Using the <strong class="source-inline">dex.trades</strong> table, sum the amount in USD within the Pool smart contract and divide it by the number of transactions executed within <span class="No-Break">24 hours.</span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor186"/><span class="No-Break">Pool TVL</span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor187"/>Sum all the transfers where the pool was the recipient of the deposit and subtract all the transfers where funds left <span class="No-Break">the pool.</span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor188"/><span class="No-Break">Pool revenue</span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><a id="_idTextAnchor189"/>The revenue of a pool is generated by fees. The fee is deducted from the volume of the <span class="No-Break">pair swap.</span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.2 – Dune dashboard query logic</p>
<p><a id="_idTextAnchor190"/>Historically, DEXs<a id="_idIndexMarker312"/> incentivized the inflow of funds with higher yields, which led to the creation of professional funds that look for those advantages. Additionally, to avoid high slippage, big trades may need to be routed through different pools to be more cost-efficient. Routing multiple liquidity pools in a single transaction enables gas savings and minimizes slippage. In conclusion, aggregators were built as routers for liquidity <span class="No-Break">and swappers.</span></p>
<h2 id="_idParaDest-111"><a id="_idTextAnchor191"/>DEX aggregators</h2>
<p>DEX aggregators source<a id="_idIndexMarker313"/> liquidity from different DEXs, providing users with better token swap rates compared to any single DEX. These aggregators can optimize costs derived from slippage, swap fees, and token prices, resulting in more favorable rates for users when executed effectively. DEXs are generally interested in integrating with DEX aggregators as it helps attract more users and volume. One prominent example of a DEX aggregator <span class="No-Break">is </span><span class="No-Break"><strong class="old">1Inch</strong></span><span class="No-Break">.</span></p>
<p>A map of the smart contracts that constitute the protocol and are maintained by the 1Inch team<a id="_idIndexMarker314"/> is available at <a href="https://dune.com/queries/2238512">https://dune.com/queries/2238512</a>. There is a great dashboard that contains aggregated metrics <span class="No-Break">at </span><a href="https://dune.com/1inch/token"><span class="No-Break">https://dune.com/1inch/token</span></a><span class="No-Break">.</span></p>
<p>Additionally, <strong class="old">Increment</strong>, a <a id="_idIndexMarker315"/>no-code product built by Covalent, has a model named Dex, which includes all 1Inch smart contracts across different chains, making the analysis easier. One valuable feature of this product is the “normalization” event, which consists of translating event signatures into human-readable words and their standardization. Each smart contract may have different names for similar events, and knowing the exact name is necessary for querying them. However, Increment standardizes the names, making querying more straightforward and cross-platform. Another noteworthy feature is that it opens up the query generated by the models, allowing customization and easier explanation to third parties of the logic taking place in <span class="No-Break">the model.</span></p>
<p>In traditional finance, access to credit, loans, and collateral-based financial services has long been a cornerstone of the industry. DeFi also has a chapter on credit and collateralization that now offers users the ability to access credit without the need for intermediaries such as banks. We will analyze this in the <span class="No-Break">next sectio<a id="_idTextAnchor192"/>n.</span></p>
<h1 id="_idParaDest-112"><a id="_idTextAnchor193"/>Lending and borrowing services on Web3</h1>
<p>The bank receives deposits, saves <a id="_idIndexMarker316"/>part of them to be able to repay in case the owner wants the cash back, and offers the other part as a loan in the market at a certain interest rate. The loan can be collateralized or non-collateralized, depending on the risk of the<a id="_idIndexMarker317"/> loan taker. The interest rate is set high enough to generate revenue for the bank and the depositor. Certain protocols on-chain reproduce a similar mechanism, as we will describe in <span class="No-Break">this section.</span></p>
<p>At the time of writing, the main lending and borrowing protocols only work with collateralized loans. The process resembles a mortgage where the user provides the house as collateral as insurance for the loan payment. If the loan is not repaid in full, the bank keeps the house. In this case, if the collateral ratio of the loan is not maintained, the protocol liquidates <span class="No-Break">the collateral.</span></p>
<p>Let’s imagine <a id="_idIndexMarker318"/>that Alice wants to invest in a project in USD stablecoin but<a id="_idIndexMarker319"/> her collateral is in ETH. She is confident that ETH will increase in price, so she would rather not sell it for stablecoin. The solution is a protocol that takes Alice’s ETH and lends her a USD-pegged stablecoin such as DAI. A protocol that does exactly that is Maker, which we have already mentioned previously. For the protocol to issue DAI, it requires 1.5 times the value of the issued DAI in collateral (ETH); this is called over-collateralization. The ratio between the collateral and the loaned asset is the collateral ratio. Usually, these protocols have a liquidation fee to disincentivize <span class="No-Break">getting liquidated.</span></p>
<p>Another <a id="_idIndexMarker320"/>well-established protocol is <strong class="old">Compound</strong>, which<a id="_idIndexMarker321"/> operates like a liquidity pool where liquidity providers supply funds to the pool in exchange for interest and borrowers take a loan against interest on the debt. The interest rate is known as <strong class="old">Annual Percentage Yield</strong> (<strong class="old">APY</strong>) and <a id="_idIndexMarker322"/>varies from pool to pool, depending on the liquidity and demand within <span class="No-Break">the pool.</span></p>
<p>When funds are deposited in Compound, the market maker receives cTokens, which represent the percentage of the funds in the pool and accrue interest. A cToken is a type of cryptocurrency token that’s used within the ecosystem. They are interest-bearing tokens that represent the amount of cryptocurrency a user has deposited into the Compound platform. The list of cTokens contracts can be found <span class="No-Break">at </span><a href="https://docs.compound.finance/#developer-resources"><span class="No-Break">https://docs.compound.finance/#developer-resources</span></a><span class="No-Break">.</span></p>
<p>Let’s explore the protocol <a id="_idIndexMarker323"/>in <strong class="old">Polygon</strong>. The user page is at <a href="https://app.compound.finance/markets?market=usdc-polygon">https://app.compound.finance/markets?market=usdc-polygon</a>. The cToken contract is <strong class="source-inline">0xF25212E676D1F7F89Cd72fFEe66158f541246445</strong> and is <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">cUSDCv3</strong></span><span class="No-Break">.</span></p>
<p>The contract has many view functions, all of which are explored in the <span class="No-Break"><strong class="source-inline">Lending_borrowing.ipynb</strong></span><span class="No-Break"> notebook.</span></p>
<p>Some of the main functions are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="source-inline">numAssets()</strong>: The number of assets that can be used as collateral. In the case under analysis, there are three assets, namely, ETH, wBTC, <span class="No-Break">and Matic.</span></li>
<li><strong class="source-inline">baseToken()</strong>: The token that can be borrowed against the collateral – in our <span class="No-Break">case, USDC.</span></li>
<li><strong class="source-inline">getAssetInfo()</strong>: This returns the collateral asset information, such as the collateral address or the price feed address <span class="No-Break">on Chainlink.</span></li>
<li><strong class="source-inline">Totalsupply()</strong>: The total supply of base tokens plus interest accrued <span class="No-Break">to suppliers.</span></li>
<li><strong class="source-inline">getReserves()</strong>: The balance of the base or collateral asset, which protects users from bad debt. We will analyze bad <span class="No-Break">debt shortly.</span></li>
<li><strong class="source-inline">getUtilization()</strong>: Protocol utilization of the base asset – that is, USDC. The function for such a calculation is <strong class="source-inline">TotalBorrows</strong> / <span class="No-Break"><strong class="source-inline">TotalSupply.</strong></span></li>
</ul>
<p>More functions to query state data are available; please refer to the documentation for <span class="No-Break">more details.</span></p>
<p>Transaction data<a id="_idIndexMarker324"/> is also very useful for extracting insights. For example, it is <a id="_idIndexMarker325"/>possible to calculate the TVL and further <a id="_idIndexMarker326"/>collateral information by querying the logs of the collateral assets. The syntax follows the one we reviewed in the <em class="italic">Understanding DEX</em> section. A dashboard example can be found <span class="No-Break">at </span><a href="https://dune.com/datanut/Compound-Finance-Deposits-and-Loans"><span class="No-Break">https://dune.com/datanut/Compound-Finance-Deposits-and-Loans</span></a><span class="No-Break">.</span></p>
<p>Lending and borrowing protocols make revenue out of the interest rate paid by the borrower. An important metric to measure revenue generated is the utilization ratio of a protocol, which is the result of the Borrowing Volume / TVL. This ratio tells us how efficient a protocol is to put the value that’s been locked to work. The higher the utilization ratio, <span class="No-Break">the better.</span></p>
<p>Specifically, in Compound, part of said interest goes to its reserves, which act as insurance, but such revenue distribution can be modified by the governance of the protocol, who are the COMP holders. COMP is an ERC-20 token that enables the community governance of the Compound protocol. A COMP token holder may participate and debate, propose, and vote on the changes to <span class="No-Break">the protocol.</span></p>
<p>Within this industry, there is a crypto-native product that came to life to enable fast loans with zero collateralization: <a id="_idTextAnchor194"/>the <span class="No-Break">flash loan.</span></p>
<h2 id="_idParaDest-113"><a id="_idTextAnchor195"/>Flash loans</h2>
<p><strong class="old">Flash loans</strong> are <a id="_idIndexMarker327"/>crypto-native products, with <strong class="old">AAVE</strong> being <a id="_idIndexMarker328"/>one of the most famous protocols in this category. A flash loan allows the borrower to take a loan with zero collateral, on the condition that the loan and any additional interest are repaid within the same transaction. If the borrower fails to repay the loan within the transaction, the entire transaction is reverted. Flash loans serve two main use cases: arbitrage <span class="No-Break">and liquidations.</span></p>
<p><strong class="old">Arbitrage</strong> involves<a id="_idIndexMarker329"/> the simultaneous purchase and sale of the same or different assets in different markets, where the prices vary. The arbitrageur profits from the small price differences, but it usually requires a substantial amount to make a noticeable difference. This practice helps bring the market back to equilibrium, ensuring that the prices of the same asset remain stable across <span class="No-Break">multiple markets.</span></p>
<p>In situations where a collateralization ratio is lost and the loan defaults, a third-party liquidator gains access to the collateral for liquidation purposes. The liquidator sells the collateral in the market on behalf of the borrower, pays back the debt, and receives a liquidation bonus for the job. All these steps can be executed in one transaction with flash loans and without requiring any collateral. These complex transactions are typically carried out by bots, which contribute to maintaining liquidity in the DeFi ecosystem and keeping prices stable <span class="No-Break">across markets.</span></p>
<p>For further insights on flash loan transaction data, open the queries in the following <span class="No-Break">dashboard: </span><span class="No-Break">https://dune.com/hildobby/flashloans</span><span class="No-Break">.</span></p>
<h2 id="_idParaDest-114"><a id="_idTextAnchor196"/>A note on protocol bad debt</h2>
<p>Flash loans <a id="_idIndexMarker330"/>have been used to carry out attacks on DeFi protocols that resulted in these protocols having bad debt. Bad debt arises <a id="_idIndexMarker331"/>when users who provide liquidity to a pair are unable to withdraw their funds upon deciding to leave the pool. Let’s consider <span class="No-Break">an example:</span></p>
<ol>
<li>The attacker obtains a flash loan for <span class="No-Break">token A.</span></li>
<li>The attacker deposits token A into a DEX or CEX and swaps it for token B, leading to an increased supply of token A and decreased liquidity of token B, causing token B’s price <span class="No-Break">to rise.</span></li>
<li>The revalued token B is later used as collateral in a lending protocol to borrow token A. Due to the inflated collateral B price, the protocol lends more of token A than it would if the collateral were at its <span class="No-Break">equilibrium price.</span></li>
<li>The attacker repays the loan in the form of A tokens, keeping the surplus of token A. When prices return to normal, liquidators try to liquidate token B at market price, but it is insufficient to cover the loan of token A. As a result, bad debt is incurred, leaving the last supplier of A tokens to bear <span class="No-Break">the loss.</span></li>
</ol>
<p>These<a id="_idIndexMarker332"/> attacks are facilitated when the price<a id="_idIndexMarker333"/> is sourced from a single oracle, making it susceptible to manipulation. Additionally, the lower cost associated with flash loans, which do not require collateral, makes such attacks <span class="No-Break">more feasible.</span></p>
<p>An interesting dashboard created by the Risk DAO tracks the bad debt of protocols using on-chain data. You can explore it <span class="No-Break">here: </span><a href="https://bad-debt.riskdao.org/"><span class="No-Break">https://bad-debt.riskdao.org/</span></a><span class="No-Break">.</span></p>
<p>The world is moving toward a multi-chain environment, where successful chains offer differentiated products and attract distinct ideas that become <strong class="old">dApps</strong>. For example, Near, with its low fees, has developed the Sweat economy, while Avalanche subnets enable games to build their on-chain ecosystem without competing for gas slots on the main chain. As more protocols open up their services on multiple chains, they aim to leverage the benefits of each chain and reach a diverse range <span class="No-Break">of users.</span></p>
<p>The increasing demand for transferring funds between different chains has led to the emergence of crypto-native products called bridges, which we will explore in the <span class="No-Break">next section.</span></p>
<h1 id="_idParaDest-115"><a id="_idTextAnchor197"/>Multichain protocols and cross-chain bridges</h1>
<p>A bridge is a <a id="_idIndexMarker334"/>structure that facilitates the transfer of funds and information between different chains. The market recognizes three groups <span class="No-Break">of chains:</span></p>
<ul>
<li><strong class="old">L1 chains</strong> are<a id="_idIndexMarker335"/> the well-known blockchains, such as Bitcoin and Ethereum. It is called Layer 1 as the core team generates a layer of solutions over the foundation layer to increase scalability. An example of the evolution of L1 is the Ethereum merge, which occurred in <span class="No-Break">September 2022.</span></li>
<li><strong class="old">L2 chains</strong> are<a id="_idIndexMarker336"/> integrations that run on top of a blockchain to improve specific aspects, often focusing on scalability. These scaling solutions allow the main chain to offload data to a parallel architecture, processing it there and saving only the results on the main chain. Successful L2 chains include Optimism, Arbitrum, and <span class="No-Break">Polygon zkEVM.</span></li>
<li><strong class="old">Sidechains</strong> are <a id="_idIndexMarker337"/>new blockchains that are connected to a major blockchain. For instance, <strong class="old">Rootstock</strong> is linked <a id="_idIndexMarker338"/>to Bitcoin, enabling EVM smart contract programming with the decentralization and security of Bitcoin. Sidechains are separate chains, meaning that consensus methods, gas rules, and other aspects <span class="No-Break">may vary.</span></li>
</ul>
<p>Given the ongoing availability of diverse blockchain offerings and the absence of any apparent halt to this trend, users will continue to explore transitioning from one blockchain to another to capitalize on the unique advantages offered by each. This underscores the persistent demand for bridge connections between these blockchains, which is expected to <span class="No-Break">remain robust.</span></p>
<p>Depending on how a bridge operates, the transaction structure and the data points required for analysis may vary. Generally, there are two main types of bridges: centralized bridges and <a id="_idIndexMarker339"/>trustless bridges. <strong class="old">Centralized bridges</strong> have a <a id="_idIndexMarker340"/>central entity responsible for bridge security. Examples include the Ronin bridge and the Multichain bridge. On <a id="_idIndexMarker341"/>the other hand, <strong class="old">trustless bridges</strong> rely solely on smart contracts, such as the Near bridge and the <a id="_idIndexMarker342"/><span class="No-Break">Hop bridge.</span></p>
<h2 id="_idParaDest-116"><a id="_idTextAnchor198"/>Hands-on example – Hop bridge</h2>
<p>Let’s delve into <a id="_idIndexMarker343"/>how a Multichain bridge such as Hop works. Hop describes itself in <a href="https://hop.exchange/">https://hop.exchange/</a> as a “<em class="italic">scalable rollup-to-rollup general token bridge.</em>” It enables bridging between ETH and its L2 solutions, such as Polygon, Gnosis, Optimism, <span class="No-Break">and Arbitrum.</span></p>
<p>The Hop bridge operates with three <span class="No-Break">core products:</span></p>
<ul>
<li>A Hop token, which is pegged to the value of the underlying asset that’s minted in each of the chains, where Hop is active and redeemable in the <span class="No-Break">L1 chain</span></li>
<li>A bonder or <span class="No-Break">liquidity provider</span></li>
<li>Automatic market makers, which allow us to swap between the Hop token and the native token in the <span class="No-Break">destination chain</span></li>
</ul>
<p>Let’s consider<a id="_idIndexMarker344"/> an <span class="No-Break">example transaction:</span></p>
<ol>
<li>Alice wants to use a dApp active on Optimism but her funds are in ETH. So, to be able to interact with the dApp, she <a id="_idIndexMarker345"/>needs <strong class="old">oETH</strong>, which is wrapped ETH <span class="No-Break">on Optimism.</span></li>
<li>Alice bridges her ETH to Optimism by doing <span class="No-Break">the following:</span><ol><li class="upper-roman">A bridge transaction is issued on ETH and will be executed on the native bridge after the waiting time and exit time <span class="No-Break">have passed.</span></li><li class="upper-roman">The bonder deposits<a id="_idIndexMarker346"/> hop-ETH or <strong class="old">hETH</strong> in Alice’s address on Optimism for the bridged amount minus fees and <span class="No-Break">gas costs.</span></li></ol></li>
<li>Alice can swap hETH for oETH and interact with <span class="No-Break">the dApp.</span></li>
<li>After the exit time has passed, the bonder receives the funds previously provided to Alice along with a <span class="No-Break">small fee.</span></li>
</ol>
<p>This is a bridge transaction where the user can transfer funds between chains swiftly, sending an asset in one chain and receiving the equivalent (minus a fee) in another chain. In this example, we mentioned tokens such as oETH and hETH, which are minted and burned in each chain to represent the flow of funds between chains. This is known as a Lock and Mint type <span class="No-Break">of bridge.</span></p>
<p>To analyze bridge contracts, refer to the complete list available at <a href="https://github.com/hop-protocol/hop/blob/develop/packages/core/src/addresses/mainnet.ts">https://github.com/hop-protocol/hop/blob/develop/packages/core/src/addresses/mainnet.ts</a>. There are a few <strong class="source-inline">view</strong> functions <span class="No-Break">in it.</span></p>
<p>A useful view function is <strong class="source-inline">l1CanonicalToken()</strong> that provides information about the locked token in the bridge. Knowing this information, we can calculate the TVL, as explained in the <span class="No-Break"><strong class="source-inline">Bridges.ipynb</strong></span><span class="No-Break"> notebook.</span></p>
<p>For aggregated<a id="_idIndexMarker347"/> transactional data analysis, understanding the transaction’s structure is essential. For instance, let’s analyze the transaction under the <strong class="source-inline">0xaf6089e3d7377b5b0c4ad86e486406a19e29280410402aab71195b0995608e81</strong> hash, which involves transferring 0.4378 ETHs to the same address <span class="No-Break">on Optimism:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer079">
<img alt="Figure 5.9 – Transaction details (source: https://etherscan.io/tx/0xaf6089e3d7377b5b0c4ad86e486406a19e29280410402aab71195b0995608e81)" height="64" src="image/B19446_05_09.jpg" width="845"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – Transaction details (source: https://etherscan.io/tx/0xaf6089e3d7377b5b0c4ad86e486406a19e29280410402aab71195b0995608e81)</p>
<p>To locate this data in the <strong class="source-inline">raw_transactions</strong> table of any data provider of those listed in <a href="B19446_02.xhtml#_idTextAnchor073"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, look for the signature or <strong class="source-inline">TransferSentToL2</strong> event, which includes the amount transferred, the bonder, and <span class="No-Break">the user:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer080">
<img alt="Figure 5.10 – Bridge cross transaction logs – ETH side" height="568" src="image/B19446_05_10.jpg" width="1658"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – Bridge cross transaction logs – ETH side</p>
<p>The transaction has its correlation in the Optimism chain. The relevant information is on the logs of the <strong class="source-inline">l2canonical</strong> token, as per the documentation. For wETH, this is <strong class="source-inline">'0x4200000000000000000000000000000000000006'</strong>. The transaction in Optimism <span class="No-Break">is </span><a href="https://optimistic.etherscan.io/tx/0x4e76ee9b997868ba894ea9362347bfa9ed64c2aaf5b4482d6482940efbe3e738"><span class="No-Break">https://optimistic.etherscan.io/tx/0x4e76ee9b997868ba894ea9362347bfa9ed64c</span>
2aaf5b4482d6482940efbe3e738</a>, and the relevant log looks <span class="No-Break">like this:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer081">
<img alt="Figure 5.11 – Bridge cross transaction logs – OPT side" height="362" src="image/B19446_05_11.jpg" width="1051"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – Bridge cross transaction logs – OPT side</p>
<p>Most of <a id="_idIndexMarker348"/>these main protocols are already indexed and translated by major data providers, making analysis more accessible. For example, explore the very interesting dashboard at <a href="https://dune.com/rchen8/Hop-Exchange">https://dune.com/rchen8/Hop-Exchange</a>, which leverages events from the reviewed <span class="No-Break">smart contracts.</span></p>
<p>Hop also offers a subgraph, and examples of queries can be found in the <span class="No-Break">documentation: </span><span class="No-Break">https://docs.hop.exchange/v<a id="_idTextAnchor199"/>/developer-docs/subgraphs/queries</span><span class="No-Break"><span class="hidden">.</span></span></p>
<p class="callout-heading">A note on DeFi risks and challenges</p>
<p class="callout">DeFi is a young, growing business with multiple challenges ahead. Data practitioners play a crucial role in preventing hacks, identifying unusual activities, measuring the risks associated with certain decisions, and handling <span class="No-Break">damage control.</span></p>
<p class="callout">There may be instances where we find ourselves supporting governmental efforts to establish a regulatory framework for the activity, paving the way for a more substantial flow of funds into this ecosystem. As of today, regulatory uncertainty and diverse rules prevail. Although there are multiple initiatives aiming to create uniformity in legislation, it remains a work in progress. This situation directly impacts the industry, where concepts such as deposit guarantees are not applied, resulting in many users irrecoverably losing their funds after <span class="No-Break">a hack.</span></p>
<p class="callout">The DeFi experience is still in its early stages, and data practitioners may also find themselves studying product experiences to enhance user interactions or educate users on better interacting with these products. Initiatives such as the SAFE wallet aim to bridge the gap between Web2 and Web3 experiences. This company leads in expanding what a wallet can do to match the experience of our traditional <span class="No-Break">home banking.</span></p>
<p class="callout">The opportunities for creation in this space are vast, and data-driven decisions <span class="No-Break">are imperative.</span></p>
<h1 id="_idParaDest-117"><a id="_idTextAnchor200"/>Summary</h1>
<p>In this chapter, we delved into the world of DeFi, exploring its core components and the primary products offered in the sector. Our analysis covered a wide array of areas, including tokens, stablecoins, and DEXs with a focus on pools and DEX aggregation, lending and borrowing protocols, and the significance of bridges in facilitating <span class="No-Break">cross-chain transactions.</span></p>
<p>In each case, we analyzed the business flow and how it generates revenue, and leveraged some of the data providers to generate <span class="No-Break">aggregated metrics.</span></p>
<p>While the landscape of DeFi is ever-evolving, with new players emerging and innovative services being introduced, our focus remains on comprehending the underlying business models and mechanisms. Understanding the essence of these protocols enables us to effectively trace transactional details to construct informative metrics for <span class="No-Break">further analysis.</span></p>
<p>Analytics companies play a vital role in simplifying this domain. Leveraging both on-chain and off-chain data and collaborating with protocol developers, these companies provide invaluable insights. By starting our analysis with well-established analytics firms, we can expedite our understanding of the DeFi landscape. However, the knowledge we’ve acquired in this chapter empowers us to establish our own criteria, delve into the code and the mathematical rationale, and tailor metrics to suit our unique requirements. This flexibility allows us to gain deeper insights into the DeFi space and make informed decisions based on our <span class="No-Break">specific needs.</span></p>
<p>In the next chapter, we'll dive into the details of <span class="No-Break">data preparation.</span></p>
<h1 id="_idParaDest-118"><a id="_idTextAnchor201"/>Further reading</h1>
<p>To complement this chapter, the following sources <span class="No-Break">may help:</span></p>
<ul>
<li>Lau, D., Lau, D., Jin, T. S., Kho, K., Azmi, E., Fang, L., Hor, B., &amp; Win, K. W. (2021). <em class="italic">How to DeFi: </em><span class="No-Break"><em class="italic">Beginner</em></span><span class="No-Break">. CoinGecko.</span></li>
<li>Fang, L., Hor, B., Azmi, E., Khor, W. W., &amp; Gecko, C. (2021). <em class="italic">How to DeFi: </em><span class="No-Break"><em class="italic">Advanced</em></span><span class="No-Break">. CoinGecko.</span></li>
<li><em class="italic">A deep dive into automated market maker decentralized exchanges</em> (Uniswap v1). (n.d.). <span class="No-Break">LearnWeb3: </span><a href="https://learnWeb3.io/degrees/ethereum-developer-degree/sophomore/a-deep-dive-into-automated-market-maker-decentralized-exchanges-uniswap-v1/"><span class="No-Break">https://learnWeb3.io/degrees/ethereum-developer-degree/sophomore/a-deep-dive-into-automated-market-maker-decentralized-exchanges-uniswap-v1/</span></a><span class="No-Break">.</span></li>
<li><em class="italic">The maker protocol white paper</em> | Feb 2020. (n.d.). MakerDAO | An Unbiased Global Financial <span class="No-Break">System: </span><a href="https://makerdao.com/en/whitepaper#abstract"><span class="No-Break">https://makerdao.com/en/whitepaper#abstract</span></a><span class="No-Break">.</span></li>
<li>Fabian Vogelsteller &lt;fabian@ethereum.org&gt;, Vitalik Buterin &lt;vitalik.buterin@ethereum.org&gt;, <em class="italic">ERC-20: Token Standard</em>, Ethereum Improvement Proposals, no. 20, November 2015. [Online serial]. Available <span class="No-Break">at </span><a href="https://eips.ethereum.org/EIPS/eip-20"><span class="No-Break">https://eips.ethereum.org/EIPS/eip-20</span></a><span class="No-Break">.</span></li>
<li>Ori Pomerantz. (n.d.). <em class="italic">ERC-20 contract walk-through</em>. <span class="No-Break">ethereum.org: </span><a href="https://ethereum.org/es/developers/tutorials/erc20-annotated-code/#the-actual-contract"><span class="No-Break">https://ethereum.org/developers/tutorials/erc20-annotated-code/#the-actual-contract</span></a><span class="No-Break">.</span></li>
<li><em class="italic">Introducing Permit2 &amp; universal router</em>. (2022, November 17). Uniswap <span class="No-Break">Protocol: </span><a href="https://blog.uniswap.org/permit2-and-universal-router#universal-router-unified-token-and-nft-swaps"><span class="No-Break">https://blog.uniswap.org/permit2-and-universal-router#universal-router-unified-token-and-nft-swaps</span></a><span class="No-Break">.</span></li>
<li>Finematics. (n.d.). <em class="italic">What is DeFi? Decentralized Finance Explained</em> (Ethereum, MakerDAO, Compound, Uniswap, Kyber) [Video]. <span class="No-Break">YouTube: </span><a href="https://www.youtube.com/watch?v=k9HYC0EJU6E"><span class="No-Break">https://www.youtube.com/watch?v=k9HYC0EJU6E</span></a><span class="No-Break">.</span></li>
<li><em class="italic">Helper functions</em>. (n.d.). Compound III <span class="No-Break">Documentation: </span><a href="https://docs.compound.finance/helper-functions/"><span class="No-Break">https://docs.compound.finance/helper-functions/</span></a><span class="No-Break">.</span></li>
<li><em class="italic">Dune Analytics</em>. (n.d.). How to Write SQL to Get TVL &amp; Diversification Metrics such as HHI and Weighted Volatility [Part 4] [Video]. <span class="No-Break">YouTube: </span><a href="https://www.youtube.com/watch?v=UiETadtYaLY"><span class="No-Break">https://www.youtube.com/watch?v=UiETadtYaLY</span></a><span class="No-Break">.</span></li>
<li><em class="italic">Flash </em><span class="No-Break"><em class="italic">loans</em></span><span class="No-Break">: </span><span class="No-Break">https://docs.aave.com/faq/flash-loans</span><span class="No-Break">.</span></li>
<li>Jp12. (2022, June 17). <em class="italic">Optimism bridge comparison</em>. <span class="No-Break">Medium: </span><a href="https://jp12.medium.com/optimism-bridge-comparison-453fa1f476f6"><span class="No-Break">https://jp12.medium.com/optimism-bridge-comparison-453fa1f476f6</span></a><span class="No-Break">.</span></li>
<li>Dogecoin. (n.d.). <em class="italic">Do only good everyday</em>. Dogecoin – An open-source peer-to-peer digital <span class="No-Break">currency: </span><a href="https://dogecoin.com/#what-is-dogecoin"><span class="No-Break">https://dogecoin.com/#what-is-dogecoin</span></a><span class="No-Break">.</span></li>
<li>More <span class="No-Break">Hop stats:</span><ul><li><a href="https://dune.com/eliasimos/Bridge-Away-(from-Ethereum)"><span class="No-Break">https://dune.com/eliasimos/Bridge-Away-(from-Ethereum)</span></a></li><li><a href="https://dune.com/queries/417810"><span class="No-Break">https://dune.com/queries/417810</span></a></li><li><a href="https://dune.xyz/rchen8/Hop-Exchange"><span class="No-Break">https://dune.xyz/rchen8/Hop-Exchange</span></a></li><li><a href="https://DeFillama.com/protocol/hop-protocol"><span class="No-Break">https://DeFillama.com/protocol/hop-protocol</span></a></li><li><a href="https://cryptofees.info/"><span class="No-Break">https://cryptofees.info/</span></a></li><li><a href="https://vfat.tools/polygon/hop/"><span class="No-Break">https://vfat.tools/polygon/hop/</span></a></li><li><a href="https://explorer.hop.exchange/"><span class="No-Break">https://explorer.hop.exchange/</span></a></li><li><a href="https://app.hop.exchange/stats"><span class="No-Break">https://app.hop.exchange/stats</span></a></li><li><a href="https://volume.hop.exchange/"><span class="No-Break">https://volume.hop.exchange/</span></a></li></ul></li>
<li>Hop Bridge. (n.d.). <em class="italic">Hop transfer diagram</em>. <span class="No-Break">GitHub: </span><a href="https://github.com/hop-exchange/contracts/blob/master/assets/Hop_Transfer_Diagrams.jpg"><span class="No-Break">https://github.com/hop-exchange/contracts/blob/master/assets/Hop_Transfer_Diagrams.jpg</span></a><span class="No-Break">.</span></li>
<li>The following is a list of very valuable dashboards and <span class="No-Break">analytical resources:</span><table class="No-Table-Style _idGenTablePara-1" id="table003-1"><colgroup><col/><col/></colgroup><tbody><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">CoinStats</strong></span></p></td><td class="No-Table-Style"><p><a href="https://coinstats.app/es/"><span class="No-Break">https://coinstats.app/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">DeFillama</strong></span></p></td><td class="No-Table-Style"><p><a href="https://DeFillama.com/"><span class="No-Break">https://DeFillama.com/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Debank</strong></span></p></td><td class="No-Table-Style"><p><a href="https://debank.com/"><span class="No-Break">https://debank.com/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">DeFiPulse</strong></span></p></td><td class="No-Table-Style"><p><a href="https://www.DeFipulse.com/"><span class="No-Break">https://www.DeFipulse.com/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">LoanScan</strong></span></p></td><td class="No-Table-Style"><p><a href="https://linen.app/interest-rates/"><span class="No-Break">https://linen.app/interest-rates/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Nansen</strong></span></p></td><td class="No-Table-Style"><p><a href="https://www.nansen.ai/"><span class="No-Break">https://www.nansen.ai/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Token Terminal</strong></span></p></td><td class="No-Table-Style"><p><a href="https://tokenterminal.com/terminal/markets/lending"><span class="No-Break">https://tokenterminal.com/terminal/markets/lending</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Zapper</strong></span></p></td><td class="No-Table-Style"><p><a href="https://zapper.xyz/dashboard"><span class="No-Break">https://zapper.xyz/dashboard</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Zerion</strong></span></p></td><td class="No-Table-Style"><p><a href="https://zerion.io/"><span class="No-Break">https://zerion.io/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">DEXTools</strong></span></p></td><td class="No-Table-Style"><p><a href="https://www.dextools.io/app/en"><span class="No-Break">https://www.dextools.io/app/en</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">GeckoTerminal</strong></span></p></td><td class="No-Table-Style"><p><a href="https://www.geckoterminal.com/"><span class="No-Break">https://www.geckoterminal.com/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><strong class="old">Into </strong><span class="No-Break"><strong class="old">the Block</strong></span></p></td><td class="No-Table-Style"><p><a href="https://www.intotheblock.com/"><span class="No-Break">https://www.intotheblock.com/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Messari</strong></span></p></td><td class="No-Table-Style"><p><a href="https://messari.io/"><span class="No-Break">https://messari.io/</span></a></p></td></tr><tr class="No-Table-Style"><td class="No-Table-Style"><p><span class="No-Break"><strong class="old">Stablecoin dashboard</strong></span></p></td><td class="No-Table-Style"><p><a href="https://stablecoins.wtf/"><span class="No-Break">https://stablecoins.wtf/</span></a></p></td></tr></tbody></table></li>
</ul>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.3 – A list of valuable dashboards</p>
</div>
</div>

<div id="sbo-rt-content"><div class="Content" id="_idContainer083">
<h1 id="_idParaDest-119" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor202"/>Part 2 Web3 Machine Learning Cases</h1>
<p>In this part of the book, we will apply common artificial intelligence tasks to Web3-related data. This approach offers us an overview of the tools commonly used in the Web3 space, building upon the data and sources explored in <em class="italic">Part 1</em> of <span class="No-Break">the book.</span></p>
<p>This part comprises the <span class="No-Break">following chapters:</span></p>
<ul>
<li><a href="B19446_06.xhtml#_idTextAnchor210"><em class="italic">Chapter 6</em></a>, <a id="_idTextAnchor203"/><em class="italic">Preparing and Exploring Our Data </em></li>
<li><a href="B19446_07.xhtml#_idTextAnchor228"><em class="italic">Chapter 7</em></a>, <a id="_idTextAnchor204"/><em class="italic">A Primer on Machine Learning and Deep Learning</em></li>
<li><a href="B19446_08.xhtml#_idTextAnchor250"><em class="italic">Chapter 8</em></a>, <a id="_idTextAnchor205"/><em class="italic">Sentiment Analysis – NLP and Crypto-News</em></li>
<li><a href="B19446_09.xhtml#_idTextAnchor269"><em class="italic">Chapter 9</em></a>, <a id="_idTextAnchor206"/><em class="italic">Generative Art for NFTs</em></li>
<li><a href="B19446_10.xhtml#_idTextAnchor294"><em class="italic">Chapter 10</em></a>, <a id="_idTextAnchor207"/><em class="italic">A Primer on Security and Fraud Detection</em></li>
<li><a href="B19446_11.xhtml#_idTextAnchor307"><em class="italic">Chapter 11</em></a>, <a id="_idTextAnchor208"/><em class="italic">Price Prediction with Time Series</em></li>
<li><a href="B19446_12.xhtml#_idTextAnchor327"><em class="italic">Chapter 12</em></a>, <a id="_idTextAnchor209"/><em class="italic">Marketing Discovery with Graphs</em></li>
</ul>
</div>
<div>
<div id="_idContainer084">
</div>
</div>
<div>
<div class="Basic-Graphics-Frame" id="_idContainer085">
</div>
</div>
</div></body></html>