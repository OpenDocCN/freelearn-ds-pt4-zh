["```py\nimport pandas as pd\nfile_url = 'https://github.com/PacktWorkshops/'\\\n           'The-Data-Science-Workshop/blob/'\\\n           'master/Chapter12/Dataset/'\\\n           'Online%20Retail.xlsx?raw=true'\ndf = pd.read_excel(file_url)\ndf.head()\n```", "```py\nuk_holidays_2010 = pd.read_csv\\\n                   ('https://date.nager.at/PublicHoliday/'\\\n                    'Country/GB/2010/CSV')\n```", "```py\nuk_holidays_2010.shape\n```", "```py\n(13, 8)\n```", "```py\nuk_holidays_2010.head()\n```", "```py\nuk_holidays_2011 = pd.read_csv\\\n                   ('https://date.nager.at/PublicHoliday/'\\\n                    'Country/GB/2011/CSV')\nuk_holidays_2011.shape\n```", "```py\n(15, 8)\n```", "```py\nuk_holidays = uk_holidays_2010.append(uk_holidays_2011)\n```", "```py\nuk_holidays.shape\n```", "```py\n(28, 8)\n```", "```py\ndf['InvoiceDay'] = df['InvoiceDate'].astype(str)\\\n                                    .str.slice(stop=10)\ndf.head()\n```", "```py\ndf_left = pd.merge(df, uk_holidays, left_on='InvoiceDay', \\\n                   right_on='Date', how='left')\ndf_left.shape\n```", "```py\n(541909, 17)\n```", "```py\ndf_left.head()\n```", "```py\ndf_right = df.merge(uk_holidays, left_on='InvoiceDay', \\\n                    right_on='Date', how='right')\ndf_right.shape\n```", "```py\n(9602, 17)\n```", "```py\ndf_right.head()\n```", "```py\ndf_inner = df.merge(uk_holidays, left_on='InvoiceDay', \\\n                    right_on='Date', how='inner')\ndf_inner.shape\n```", "```py\n(9579, 17)\n```", "```py\ndf_outer = df.merge(uk_holidays, left_on='InvoiceDay', \\\n                    right_on='Date', how='outer')\ndf_outer.shape\n```", "```py\n(541932, 17)\n```", "```py\n    import pandas as pd\n    ```", "```py\n    file_url = 'https://raw.githubusercontent.com/'\\\n               'PacktWorkshops/The-Data-Science-Workshop/'\\\n               'master/Chapter12/Dataset/taxstats2015.csv'\n    ```", "```py\n    df = pd.read_csv(file_url)\n    ```", "```py\n    df.shape\n    ```", "```py\n    (2473, 28)\n    ```", "```py\n    df.head()\n    ```", "```py\n    df['Postcode'].nunique()\n    ```", "```py\n    2473\n    ```", "```py\n    postcode_url = 'https://github.com/PacktWorkshops/'\\\n                   'The-Data-Science-Workshop/blob/'\\\n                   'master/Chapter12/Dataset/'\\\n                   'taxstats2016individual06taxablestatusstate'\\\n                   'territorypostcodetaxableincome%20(2).xlsx?'\\\n                   'raw=true'\n    ```", "```py\n    postcode_df = pd.read_excel(postcode_url, \\\n                                sheet_name='Individuals Table 6B', \\\n                                header=2)\n    ```", "```py\n    postcode_df.shape\n    ```", "```py\n    (2567, 150)\n    ```", "```py\n    postcode_df.head()\n    ```", "```py\n    postcode_df['Postcode'].nunique()\n    ```", "```py\n    2567\n    ```", "```py\n    merged_df = pd.merge(df, postcode_df, \\\n                         how='left', on='Postcode')\n    ```", "```py\n    merged_df.shape\n    ```", "```py\n    (2473, 177)\n    ```", "```py\n    merged_df['State/ Territory1'].isna().sum()\n    ```", "```py\n    4\n    ```", "```py\n    merged_df.loc[merged_df['State/ Territory1'].isna(), \\\n                  'Postcode']\n    ```", "```py\nimport pandas as pd\nfile_url = 'https://github.com/PacktWorkshops/'\\\n           'The-Data-Science-Workshop/blob/'\\\n           'master/Chapter12/Dataset/'\\\n           'Online%20Retail.xlsx?raw=true'\ndf = pd.read_excel(file_url)\n```", "```py\ndf['Country'].unique()\n```", "```py\ndf['Country_bin'] = df['Country']\n```", "```py\nasian_countries = ['Japan', 'Hong Kong', 'Singapore']\n```", "```py\ndf.loc[df['Country'].isin(asian_countries), \\\n       'Country_bin'] = 'Asia'\n```", "```py\ndf['Country_bin'].unique()\n```", "```py\nm_east_countries = ['Israel', 'Bahrain', 'Lebanon', \\\n                    'United Arab Emirates', 'Saudi Arabia']\ndf.loc[df['Country'].isin(m_east_countries), \\\n       'Country_bin'] = 'Middle East'\ndf['Country_bin'].unique()\n```", "```py\namerican_countries = ['Canada', 'Brazil', 'USA']\ndf.loc[df['Country'].isin(american_countries), \\\n       'Country_bin'] = 'America'\ndf['Country_bin'].unique()\n```", "```py\ndf['Country_bin'].nunique()\n```", "```py\n30\n```", "```py\n    import pandas as pd\n    import altair as alt\n    ```", "```py\n    file_url = 'https://raw.githubusercontent.com/'\\\n               'PacktWorkshops/The-Data-Science-Workshop/'\\\n               'master/Chapter12/Dataset/ames_iowa_housing.csv'\n    ```", "```py\n    df = pd.read_csv(file_url)\n    ```", "```py\n    df.head()\n    ```", "```py\n    df['YearBuilt'].nunique()\n    ```", "```py\n    112\n    ```", "```py\n    alt.Chart(df).mark_circle().encode(alt.X('YearBuilt:O'),\\\n                                       y='count()')\n    ```", "```py\n    year_built = df['YearBuilt'].unique()\n    ```", "```py\n    decade_list = [year - (year % 10) for year in year_built]\n    ```", "```py\n    decade_built = sorted(set(decade_list))\n    ```", "```py\n    decade_built\n    ```", "```py\n    df['DecadeBuilt'] = pd.cut(df['YearBuilt'], \\\n                               bins=decade_built)\n    ```", "```py\n    df[['YearBuilt', 'DecadeBuilt']].head()\n    ```", "```py\nimport pandas as pd\nfile_url = 'https://github.com/PacktWorkshops/'\\\n           'The-Data-Science-Workshop/blob/'\\\n           'master/Chapter12/Dataset/'\\\n           'Online%20Retail.xlsx?raw=true'\ndf = pd.read_excel(file_url)\ndf.dtypes\n```", "```py\ndf['InvoiceDate'] = pd.to_datetime(df['InvoiceDate'])\n```", "```py\ndf['InvoiceDate'].dt.year\n```", "```py\ndf['InvoiceDate'].dt.dayofweek\n```", "```py\ndf['InvoiceDate'] + pd.tseries.offsets.Day(3)\n```", "```py\ndf['InvoiceDate'] + pd.tseries.offsets.BusinessDay(-1)\n```", "```py\ndf['InvoiceDate'] + pd.Timedelta(1, unit='MS')\n```", "```py\n    import pandas as pd\n    ```", "```py\n    file_url = 'https://raw.githubusercontent.com/'\\\n               'PacktWorkshops/The-Data-Science-Workshop/'\\\n               'master/Chapter12/Dataset/Consumer_Complaints.csv'\n    ```", "```py\n    df = pd.read_csv(file_url)\n    ```", "```py\n    df.head()\n    ```", "```py\n    df.dtypes\n    ```", "```py\n    df['Date received'] = pd.to_datetime(df['Date received'])\n    df['Date sent to company'] = pd.to_datetime\\\n                                 (df['Date sent to company'])\n    ```", "```py\n    df.dtypes\n    ```", "```py\n    df['YearReceived'] = df['Date received'].dt.year\n    ```", "```py\n    df['MonthReceived'] = df['Date received'].dt.month\n    ```", "```py\n    df['DomReceived'] = df['Date received'].dt.day\n    ```", "```py\n    df['DowReceived'] = df['Date received'].dt.dayofweek\n    ```", "```py\n    df.head()\n    ```", "```py\n    df['IsWeekendReceived'] = df['DowReceived'] >= 5\n    ```", "```py\n    df.head()\n    ```", "```py\n    df['RoutingDays'] = df['Date sent to company'] \\\n                        - df['Date received']\n    ```", "```py\n    df['RoutingDays'].dtype\n    ```", "```py\n    df['RoutingDays'] = df['RoutingDays'].dt.days\n    ```", "```py\n    df.head()\n    ```", "```py\nimport pandas as pd\nfile_url = 'https://github.com/PacktWorkshops/'\\\n           'The-Data-Science-Workshop/blob/'\\\n           'master/Chapter12/Dataset/'\\\n           'Online%20Retail.xlsx?raw=true'\ndf = pd.read_excel(file_url)\n```", "```py\ndf.groupby('Country').agg({'Quantity': 'sum'})\n```", "```py\ndf.groupby(['Country', 'StockCode']).agg({'Quantity': 'sum'})\n```", "```py\ndf['Invoice_Date'] = df['InvoiceDate'].dt.date\n```", "```py\ndf.groupby(['Country', 'StockCode', \\\n            'Invoice_Date']).agg({'Quantity': 'sum'})\n```", "```py\ndf_agg = df.groupby(['Country', 'StockCode', 'Invoice_Date'])\\\n           .agg({'Quantity': 'sum'}).reset_index()\ndf_agg.head()\n```", "```py\ndf_merged = pd.merge(df, df_agg, how='left', \\\n                     on = ['Country', 'StockCode', \\\n                           'Invoice_Date'])\ndf_merged\n```", "```py\ndf_merged.rename(columns={\"Quantity_x\": \"Quantity\", \\\n                          \"Quantity_y\": \"DailyQuantity\"}, \\\n                 inplace=True)\ndf_merged\n```", "```py\ndf_merged['QuantityRatio'] = df_merged['Quantity'] \\\n                             / df_merged['DailyQuantity']\ndf_merged\n```", "```py\n    import pandas as pd\n    ```", "```py\n    file_url = 'https://raw.githubusercontent.com/'\\\n               'PacktWorkshops/The-Data-Science-Workshop/'\\\n               'master/Chapter12/Dataset/ames_iowa_housing.csv'\n    ```", "```py\n    df = pd.read_csv(file_url)\n    ```", "```py\n    df_agg = df.groupby(['Neighborhood', 'YrSold'])\\\n               .agg({'SalePrice': 'max'}).reset_index()\n    ```", "```py\n    df_agg.columns = ['Neighborhood', 'YrSold', 'SalePriceMax']\n    ```", "```py\n    df_agg.head()\n    ```", "```py\n    df_new = pd.merge(df, df_agg, how='left', \\\n                      on=['Neighborhood', 'YrSold'])\n    ```", "```py\n    df_new.head()\n    ```", "```py\n    df_new['SalePriceRatio'] = df_new['SalePrice'] \\\n                               / df_new['SalePriceMax']\n    ```", "```py\n    df_new.head()\n    ```", "```py\n    df_agg2 = df.groupby(['Neighborhood', 'YrSold'])\\\n                .agg({'LotArea': 'max'}).reset_index()\n    ```", "```py\n    df_agg2.columns = ['Neighborhood', 'YrSold', 'LotAreaMax']\n    df_agg2.head()\n    ```", "```py\n    df_final = pd.merge(df_new, df_agg2, how='left', \\\n                        on=['Neighborhood', 'YrSold'])\n    ```", "```py\n    df_final['LotAreaRatio'] = df_final['LotArea'] \\\n                               / df_final['LotAreaMax']\n    ```", "```py\n    df_final[['Id', 'Neighborhood', 'YrSold', 'SalePrice', \\\n              'SalePriceMax', 'SalePriceRatio', 'LotArea', \\\n              'LotAreaMax', 'LotAreaRatio']].head()\n    ```"]