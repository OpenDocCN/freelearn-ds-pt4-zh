<html><head></head><body>
		<div id="_idContainer012">
			<h1 id="_idParaDest-17" class="chapter-number"><a id="_idTextAnchor016"/>1</h1>
			<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>Data Augmentation Made Easy</h1>
			<p>Data augmentation is essential for developing a successful <strong class="bold">deep learning</strong> (<strong class="bold">DL</strong>) project. However, data scientists and developers often overlook this crucial step. It is no secret that you will spend the majority of your project time gathering, cleaning, and augmenting the dataset in a real-world DL project. Thus, learning how to expand the dataset without purchasing new data is essential. This book covers standard and advanced techniques for extending image, text, audio, and tabular datasets. Furthermore, you will learn about data biases and learn how to code on <strong class="bold">Jupyter </strong><span class="No-Break"><strong class="bold">Python Notebooks</strong></span><span class="No-Break">.</span></p>
			<p><a href="B17990_01.xhtml#_idTextAnchor016"><span class="No-Break"><em class="italic">Chapter 1</em></span></a><em class="italic"> </em>will introduce various data augmentation concepts, set up the coding environment, and create the foundation class. Later chapters will explain various techniques in detail, including Python coding. The effective use of data augmentation has proven to be the deciding factor between success and failure in <strong class="bold">machine learning</strong> (<strong class="bold">ML</strong>). Many real-world ML projects stay in the conceptual phase because of insufficient data for training the ML model. Data augmentation is a cost-effective technique that can increase the size of the dataset, lower the training error rate, and produce a more accurate prediction <span class="No-Break">and forecast.</span></p>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">The car gasoline analogy is helpful for students who first learn about data augmentation and <strong class="bold">artificial intelligence</strong> (<strong class="bold">AI</strong>). You can think of data for the AI engine as the gasoline and data augmentation as the additive, such as the Chevron Techron fuel cleaner, that makes your car engine run faster, smoother, and further without <span class="No-Break">extra petrol.</span></p>
			<p>In this chapter, we’ll define the data augmentation role and the limitations of extending data without changing its integrity. We’ll briefly discuss the different types of input data, such as image, text, audio, and tabular data, and the challenges in supplementing it. Finally, we’ll set up the system requirements and the programming style in the accompanying <span class="No-Break">Python notebook.</span></p>
			<p>I designed this book to be a hands-on journey. It will be most effective to read a chapter, run the code, re-read the part of the chapter that confused you, and jump back to hacking the code until you firmly understand the concept or technique that <span class="No-Break">was presented.</span></p>
			<p>You are encouraged to change or add new code to the Python notebook. The primary purpose of this book is interactive learning. So, if something goes wrong, download a fresh copy from the book's GitHub. The surest method to learn is to make mistakes and create <span class="No-Break">something new.</span></p>
			<p>Data augmentation is an iterative process. There is no fixed recipe. In other words, depending on the dataset, you select augmented functions and jiggle the parameters. A subject domain expert may provide insight into how much distortion is acceptable. By the end of this chapter, you will know the general rules for data augmentation, what type of input data can be augmented, the programming style, and how to set up a Python Notebook online <span class="No-Break">or offline.</span></p>
			<p>In particular, this chapter covers the following <span class="No-Break">primary topics:</span></p>
			<ul>
				<li>Data <span class="No-Break">augmentation role</span></li>
				<li>Data <span class="No-Break">input types</span></li>
				<li><span class="No-Break">Python Notebook</span></li>
				<li><span class="No-Break">Programming styles</span></li>
			</ul>
			<p>Let’s start with the data <span class="No-Break">augmentation role.</span></p>
			<h1 id="_idParaDest-19"><a id="_idTextAnchor018"/>Data augmentation role</h1>
			<p>Data is paramount <a id="_idIndexMarker000"/>in any AI project. This is especially true when using<a id="_idIndexMarker001"/> the <strong class="bold">artificial neural network</strong> (<strong class="bold">ANN</strong>) algorithm, also known as <strong class="bold">DL</strong>. The success or failure of a DL project is primarily due to the input <span class="No-Break">data quality.</span></p>
			<p>One primary reason for the significance of data augmentation is that it is relatively too easy to develop an AI for prediction and forecasting, and those models require robust data input. With the remarkable advancement in developing, training, and deploying a DL project, such as using <a id="_idIndexMarker002"/>the <strong class="bold">FastAI</strong> framework, you can create a world-class DL model in a handful of Python code lines. Thus, expanding the dataset is an effective option to improve the DL model’s accuracy over <span class="No-Break">your competitor.</span></p>
			<p>The traditional method of acquiring additional data is difficult, expensive, and impractical. Sometimes, the only available option is to use data augmentation techniques to extend <span class="No-Break">the dataset.</span></p>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">Data augmentation methods can increase the data’s size tenfold. For example, it is relatively challenging to acquire additional skin cancer images. Thus, using a random combination of image transformations, such as vertical flip, horizontal flip, rotating, and skewing, is a practical technique that can expand the skin cancer <span class="No-Break">photo data.</span></p>
			<p>Without data augmentation, sourcing new skin cancer photos and labeling them is expensive and time-consuming. The <strong class="bold">International Skin Imaging Collaboration</strong> (<strong class="bold">ISIC</strong>) is the <a id="_idIndexMarker003"/>authoritative data source for skin diseases, where a team of dermatologists verified and classified the images. ISIC made the datasets available to the public to download for free. If you can’t find a particular dataset from ISIC, it is difficult to find other means, as accessing hospital or university labs to acquire skin disease images is laced with legal and logistic blockers. After obtaining the photos, hiring a team of dermatologists to classify the pictures to correct diseases would <span class="No-Break">be costly.</span></p>
			<p>Another example of the impracticality of attaining additional images instead of augmentation is when you download photos from social media or online search engines. Social media is a rich<a id="_idIndexMarker004"/> source of image, text, audio, and video data. Search engines, such as <strong class="bold">Google</strong> or <strong class="bold">Bing</strong>, make <a id="_idIndexMarker005"/>it relatively easy to download additional data for a project, but copyrights and legal usage are a quagmire. Most images, texts, audio, and videos on social media, such <a id="_idIndexMarker006"/>as <strong class="bold">YouTube</strong>, <strong class="bold">Facebook</strong>, <strong class="bold">TikTok</strong>, and <strong class="bold">Twitter</strong>, are <a id="_idIndexMarker007"/>not <a id="_idIndexMarker008"/>clearly labeled as<a id="_idIndexMarker009"/> copyrights or public <span class="No-Break">domain material.</span></p>
			<p>Furthermore, social media promotes popular content, not unfavorable or obscure material. For example, let’s say you want to add more images of parrots to your parrot classification AI system. Online searches will return a lot of blue-and-yellow macaws, red-and-green macaws, or sulfur-crested cockatoos, but not as many Galah, Kea, or the mythical Norwegian-blue parrot – a fake parrot from the Monty Python <span class="No-Break">comedy skit.</span></p>
			<p>Insufficient data for AI training is exacerbated for text, audio, and tabular data types. Generally, obtaining additional text, audio, and tabular data is expensive and time-consuming. There are strong copyright laws protecting text data. Audio files are less common online, and tabular data is primarily from private <span class="No-Break">company databases.</span></p>
			<p>The following section will define the four commonly used <span class="No-Break">data types.</span></p>
			<h1 id="_idParaDest-20"><a id="_idTextAnchor019"/>Data input types</h1>
			<p>The four <a id="_idIndexMarker010"/>data input types are self-explanatory, but it is worth clearly defining the data input types and what is out <span class="No-Break">of scope:</span></p>
			<ul>
				<li><span class="No-Break">Image definition</span></li>
				<li><span class="No-Break">Text definition</span></li>
				<li><span class="No-Break">Audio definition</span></li>
				<li>Tabular <span class="No-Break">data definition</span></li>
			</ul>
			<div>
				<div id="_idContainer006" class="IMG---Figure">
					<img src="image/B17990_01_01.jpg" alt="Figure 1.1 – Image, text, tabular, and audio augmentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.1 – Image, text, tabular, and audio augmentation</p>
			<p><span class="No-Break"><em class="italic">Figure 1</em></span><em class="italic">.1</em> provides a sneak peek at image, text, tabular and audio augmentation. Later in this book, you will learn how to implement <span class="No-Break">augmentation methods.</span></p>
			<p>Let’s get started <span class="No-Break">with images.</span></p>
			<h2 id="_idParaDest-21"><a id="_idTextAnchor020"/>Image definition</h2>
			<p>Image is a<a id="_idIndexMarker011"/> large category because you can represent <a id="_idIndexMarker012"/>almost anything as an image, such as people, landscapes, animals, plants, and various objects around us. Pictures can also represent action, such as sports, sign language, yoga poses, and many more. One particularly creative use of images is capturing a computer mouse’s movement over time to predict whether a user is a computer hacker <span class="No-Break">or not.</span></p>
			<p>The techniques for increasing the number of pictures are horizontal flip, vertical flip, enlarge, zoom in, zoom out, skew, warp, and lighting. Humans are experts at processing images. Thus, if a picture is slightly distorted or darkened, you can still tell that it is the same image. However, this is not the same for a computer. AI represents a color picture as a three-dimensional array of float numbers – the width, height, and RGB as depth. Any image distortion will yield an array with <span class="No-Break">different values.</span></p>
			<p>Graphs, such as time series data charts, and mathematical equation plots, such as 3D topology plots, are outside the scope of <span class="No-Break">image augmentation.</span></p>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">You can eliminate the <strong class="bold">overfitting</strong> problem in DL image classification training by creatively using data <span class="No-Break">augmentation methods.</span></p>
			<p>Text augmentation has different concerns than image augmentation. Let’s take <span class="No-Break">a look.</span></p>
			<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/>Text definition</h2>
			<p>The primary text input data is in English, but the same techniques for text augmentation can be applied to other West Germanic languages. Python lessons use English as the text <span class="No-Break">input data.</span></p>
			<p>The techniques for supplementing the text input are back translation, easy data augmentation, and albumentation. A few methods might be counterintuitive at first glance, such as deleting or swamping words in a sentence. However, it is an acceptable practice because, in the real world, not everyone writes <span class="No-Break">perfect English.</span></p>
			<p>For example, movie <a id="_idIndexMarker013"/>reviewers on the <strong class="bold">American Multi-Cinema</strong> (<strong class="bold">AMC</strong>) website<a id="_idIndexMarker014"/> write incomplete or grammatically incorrect sentences. They omit verbs or use inappropriate words. As a rule of thumb, you should not expect perfect English for text input data in many <span class="No-Break">NLP projects.</span></p>
			<p>If an NLP model<a id="_idIndexMarker015"/> is trained in perfect English as text input data, it could cause bias against typical online reviewers. In other words, the NLP model will predict inaccurately when deployed to a real-world audience. For example, in sentiment analysis, the AI system will predict whether a movie review has a positive or negative sentiment. Suppose you trained the system using a perfect English dataset. In that case, the AI system might forecast a <strong class="bold">false positive </strong>or<strong class="bold"> false negative</strong> when people write a short line with misspelled words and <span class="No-Break">grammatical errors.</span></p>
			<p>Language translation, ideograms, and hieroglyphs are outside the scope of this book. Now, let’s look at <span class="No-Break">audio augmentation.</span></p>
			<h2 id="_idParaDest-23"><a id="_idTextAnchor022"/>Audio definition</h2>
			<p>Audio input data <a id="_idIndexMarker016"/>can be any sound wave recording <a id="_idIndexMarker017"/>such as music, speech, and natural sounds. Sound wave attributes such as amplitude and frequency are represented as graphs, which are technically images, but you can’t use any image augmentation methods for audio <span class="No-Break">input data.</span></p>
			<p>The techniques for expanding audio input are split into two<a id="_idIndexMarker018"/> types: <strong class="bold">waveform</strong> and <strong class="bold">spectrograph</strong>. For <a id="_idIndexMarker019"/>raw audio, the transformation methods range from time-shifting and pitch scaling to random gain, while for spectrographs, the functions are time masking, time stretching, pitch scaling, and <span class="No-Break">many others.</span></p>
			<p>Speech in a language other than English is outside the scope of this book. This is not due to technical difficulties but rather because this book is written in English. Writing about the aftermath effects of switching to a different language would be problematic.Audio augmentation is demanding, but tabular data is even more challenging <span class="No-Break">to expand.</span></p>
			<h2 id="_idParaDest-24"><a id="_idTextAnchor023"/>Tabular data definition</h2>
			<p>Tabular data<a id="_idIndexMarker020"/> is information<a id="_idIndexMarker021"/> in a relational database, spreadsheet, or text file in <strong class="bold">comma-separated values</strong> (<strong class="bold">CSV</strong>) format. Tabular <a id="_idIndexMarker022"/>data augmentation is a fast-growing field in ML and DL. The tabular data augmentation techniques are transforming, interacting, mapping, <span class="No-Break">and extraction.</span></p>
			<p class="callout-heading">Fun challenge</p>
			<p class="callout">Here is a thought experiment. Can you think of data types other than image, text, audio, and tabular? A hint is <em class="italic">Casablanca</em> and <span class="No-Break"><em class="italic">Blade Runner</em></span><span class="No-Break">.</span></p>
			<p>There are <a id="_idIndexMarker023"/>two parts to this chapter. The first half discussed the various concepts and techniques; what follows is hands-on Python coding on a Python Notebook. The book will use this learn-then-code pattern in all the chapters. It is time to get your hands dir<a id="_idTextAnchor024"/>ty and write <span class="No-Break">Python code.</span></p>
			<h1 id="_idParaDest-25"><a id="_idTextAnchor025"/>Python Notebook</h1>
			<p><strong class="bold">Jupyter Notebook</strong> is an <a id="_idIndexMarker024"/>open source web application that is the de<a id="_idIndexMarker025"/> facto choice for AI, ML, and data scientists. Jupyter Notebook supports multiple computer languages, and the most popular <span class="No-Break">is Python.</span></p>
			<p>Throughout this book, the<a id="_idIndexMarker026"/> term <strong class="bold">Python Notebook</strong> will be used synonymously <a id="_idIndexMarker027"/>for <strong class="bold">Jupyter Notebook</strong>, <strong class="bold">JupyterLab</strong>, and <strong class="bold">Google Colab </strong><span class="No-Break"><strong class="bold">Jupyter Notebook</strong></span><span class="No-Break">.</span></p>
			<p>For Python developers, there<a id="_idIndexMarker028"/> are many choices of <strong class="bold">integrated development environment</strong> (<strong class="bold">IDE</strong>) platforms, such as <strong class="bold">Integrated Development and Learning Environment</strong> (<strong class="bold">IDLE</strong>), PyCharm, Microsoft Visual Studio, Atom, Sublime, and <a id="_idIndexMarker029"/>many more. Still, a Python Notebook is the preferred choice for AI, ML, and data scientists. It is an interactive IDE fit for exploring, coding, and deploying <span class="No-Break">AI projects.</span></p>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">The easiest learning method is reading this book, running the code, and hacking it. This book cannot cover all scenarios; therefore, you must be comfortable with hacking the code so that it matches your real-world dataset. The Python Notebook is designed for interactivity. It gives us the freedom to play, explore, and <span class="No-Break">make mistakes.</span></p>
			<p>Python Notebook is <a id="_idIndexMarker030"/>the development tool of choice, and in particular, we will review <span class="No-Break">the following:</span></p>
			<ul>
				<li><span class="No-Break">Google Colab</span></li>
				<li>Python <span class="No-Break">Notebook options</span></li>
				<li>Installing <span class="No-Break">Python Notebook</span></li>
			</ul>
			<p>Let’s begin with <span class="No-Break">Google Colab.</span></p>
			<h1 id="_idParaDest-26"><a id="_idTextAnchor026"/>Google Colab</h1>
			<p><strong class="bold">Google Colab Jupyter Notebook</strong> with <a id="_idIndexMarker031"/>Python is one of the popular options for developing AI and ML projects. All you need is a <span class="No-Break">Gmail account.</span></p>
			<p>Colab can be found at <a href="https://colab.research.google.com/">https://colab.research.google.com/</a>. The free Colab version is sufficient for the code in this book; the Pro+ version enables more CPU and <span class="No-Break">GPU RAM.</span></p>
			<p>After logging in to Colab, you can retrieve this book’s Python Notebooks from the following GitHub <span class="No-Break">URL: </span><span class="No-Break">https://github.com/PacktPublishing/data-augmentation-with-python</span><span class="No-Break">.</span></p>
			<p>You can start using Colab by using one of the <span class="No-Break">following options:</span></p>
			<ul>
				<li>The <em class="italic">first method</em> of opening a Python Notebook is copying it from GitHub. From Colab, go to the <strong class="bold">File</strong> menu, choose <strong class="bold">Open Notebook</strong>, and then click on the <strong class="bold">GitHub</strong> tab. In the <strong class="bold">Repository</strong> field, enter the GitHub URL specified previously; refer to <span class="No-Break"><em class="italic">Figure 1</em></span><em class="italic">.2</em>. Lastly, select the chapter and Python Notebook (<strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">ipynb</strong></span><span class="No-Break">) file:</span></li>
			</ul>
			<div>
				<div id="_idContainer007" class="IMG---Figure">
					<img src="image/B17990_01_02.jpg" alt="Figure 1.2 – Loading a Python Notebook from GitHub"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.2 – Loading a Python Notebook from GitHub</p>
			<ul>
				<li>The <em class="italic">second method</em> of opening<a id="_idIndexMarker032"/> a Python Notebook is auto-loading it from GitHub. Go to the GitHub link mentioned previously and click on the Python Notebook (<strong class="source-inline">ipynb</strong>) file. Click the blue-colored <strong class="bold">Open in Colab</strong> button, as shown in <span class="No-Break"><em class="italic">Figure 1</em></span><em class="italic">.3</em>; it should be on the first line of the Python Notebook. It will launch Colab and load in the Python <span class="No-Break">Notebook automatically:</span></li>
			</ul>
			<div>
				<div id="_idContainer008" class="IMG---Figure">
					<img src="image/B17990_01_03.jpg" alt="Figure 1.3 – Loading a Python Notebook from Colab"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.3 – Loading a Python Notebook from Colab</p>
			<ul>
				<li>Ensure you save a copy of the Python Notebook to your local Google Drive by clicking on the <strong class="bold">File</strong> menu and selecting the <strong class="bold">Save a copy in Drive</strong> option. Afterward, close the original and use the <span class="No-Break">copy version.</span></li>
				<li>The <em class="italic">third method</em> of opening a Python Notebook is by downloading a copy from GitHub. Upload the Python Notebook to Colab by clicking on the <strong class="bold">File</strong> menu, choosing <strong class="bold">Open Notebook</strong>, then clicking on the <strong class="bold">Upload</strong> tab, as shown in <span class="No-Break"><em class="italic">Figure 1</em></span><span class="No-Break"><em class="italic">.4</em></span><span class="No-Break">:</span></li>
			</ul>
			<div>
				<div id="_idContainer009" class="IMG---Figure">
					<img src="image/B17990_01_04.jpg" alt="Figure 1.4 – Loading a Python Notebook by uploading it to Colab"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.4 – Loading a Python Notebook by uploading it to Colab</p>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">For a quick overview of Colab’s features, go to <a href="https://colab.research.google.com/notebooks/basic_features_overview.ipynb">https://colab.research.google.com/notebooks/basic_features_overview.ipynb</a>. For a tutorial on how to use a Python Notebook, go <span class="No-Break">to </span><a href="https://colab.research.google.com/github/cs231n/cs231n.github.io/blob/master/jupyter-notebook-tutorial.ipynb"><span class="No-Break">https://colab.research.google.com/github/cs231n/cs231n.github.io/blob/master/jupyter-notebook-tutorial.ipynb</span></a><span class="No-Break">.</span></p>
			<p>Choosing<a id="_idIndexMarker033"/> <strong class="bold">Colab</strong> follows the same rationale as selecting an IDE: it is based mainly on your preferences. The following section describes additional Python <span class="No-Break">Notebook options.</span></p>
			<h2 id="_idParaDest-27"><a id="_idTextAnchor027"/>Additional Python Notebook options</h2>
			<p>Python notebooks are available in free and paid versions from many online companies, such as Microsoft, Amazon, Kaggle, Paperspace, and others. Using more than one vendor is typical because a Python Notebook behaves the same way across multiple vendors. However, it is similar to choosing an IDE – once selected, we tend to stay in the <span class="No-Break">same environment.</span></p>
			<p>You can use the following feature criteria to select a <span class="No-Break">Python Notebook:</span></p>
			<ul>
				<li>Easy to set up. Can you load and run a Python Notebook in <span class="No-Break">15 minutes?</span></li>
				<li>A free version where you can run the Python Notebooks in <span class="No-Break">this book.</span></li>
				<li>Free CPU <span class="No-Break">and GPU.</span></li>
				<li>Free permanent storage for the Python Notebooks <span class="No-Break">and versioning.</span></li>
				<li>Easy access <span class="No-Break">to GitHub.</span></li>
				<li>Easy to upload and download the Python Notebooks to and from the local <span class="No-Break">disk drive.</span></li>
				<li>Option to upgrade to a paid version for faster and additional RAM in terms of CPU <span class="No-Break">and GPU.</span></li>
			</ul>
			<p>The choice of Python Notebook is based on your needs, preferences, or familiarity. You don’t have to use Google Colab for the lessons in this book. This book’s Python Notebooks will run on, but are not limited to, the <span class="No-Break">following vendors:</span></p>
			<ul>
				<li><span class="No-Break">Google Colab</span></li>
				<li><span class="No-Break">Kaggle Notebooks</span></li>
				<li><span class="No-Break">Deepnote</span></li>
				<li>Amazon SageMaker <span class="No-Break">Studio Lab</span></li>
				<li><span class="No-Break">Paperspace Gradient</span></li>
				<li><span class="No-Break">DataCrunch</span></li>
				<li>Microsoft Notebooks in Visual <span class="No-Break">Studio Code</span></li>
			</ul>
			<p>The cloud-based options depend on having fast internet access at all times, so if internet access is a problem, you might want to install the Python Notebook locally on your laptop/computer. The installation process <span class="No-Break">is straightforward.</span></p>
			<h2 id="_idParaDest-28"><a id="_idTextAnchor028"/>Installing Python Notebook</h2>
			<p>Python Notebook <a id="_idIndexMarker034"/>can be installed on a local desktop or laptop for Windows, Mac, and Linux. The advantages of the online version are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><span class="No-Break">Fully customizable</span></li>
				<li>No limit on runtime –  that is, no timeout on the Python Notebook during long <span class="No-Break">training sessions</span></li>
				<li>No rules or <span class="No-Break">arbitrary limitations</span></li>
			</ul>
			<p>The disadvantage is that you have to set up and maintain the environment. For example, you must do <span class="No-Break">the following:</span></p>
			<ul>
				<li>Install Python and <span class="No-Break">Jupyter Notebook</span></li>
				<li>Install and configure the NVIDIA graphic card (optional for <span class="No-Break">data augmentation)</span></li>
				<li>Maintain and update dozens of dependency <span class="No-Break">Python libraries</span></li>
				<li>Upgrade the disk drive, CPU, and <span class="No-Break">GPU RAM</span></li>
			</ul>
			<p>Installing <a id="_idIndexMarker035"/>Python Notebook is easy, requiring just one console or terminal command, but first, check the Python version. Type the following command in the terminal or <span class="No-Break">console application:</span></p>
			<pre class="source-code">
&gt;python3 --version</pre>
			<p>You should have version 3.7.0 or later. If you don’t have Python 3 or have an older version, install<a id="_idIndexMarker036"/> Python <span class="No-Break">from </span><a href="https://www.python.org/downloads/"><span class="No-Break">https://www.python.org/downloads/</span></a><span class="No-Break">.</span></p>
			<p>Install JupyterLab using <strong class="source-inline">pip</strong>, which contains Python Notebook. On a Windows, Mac, or Linux laptop, use the following command for all <span class="No-Break">three OSs:</span></p>
			<pre class="source-code">
&gt;pip install jupyterlab</pre>
			<p>If you don’t like <strong class="source-inline">pip</strong>, <span class="No-Break">use </span><span class="No-Break"><strong class="source-inline">conda</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
&gt;conda install -c conda-forge jupyterlab</pre>
			<p>Other than <strong class="source-inline">pip</strong> and <strong class="source-inline">conda</strong>, you can <span class="No-Break">use </span><span class="No-Break"><strong class="source-inline">mamba</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
&gt;mamba install -c conda-forge jupyterlab</pre>
			<p>Start JupyterLab or Python Notebook with the <span class="No-Break">following command:</span></p>
			<pre class="source-code">
&gt;jupyter lab</pre>
			<p>The result of installing Python Notebook on a Mac is <span class="No-Break">as follows:</span></p>
			<div>
				<div id="_idContainer010" class="IMG---Figure">
					<img src="image/B17990_01_05.jpg" alt="Figure 1.5 – Jupyter Notebook on a local MacBook"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.5 – Jupyter Notebook on a local MacBook</p>
			<p>The next <a id="_idIndexMarker037"/>step is cloning this book’s Python Notebook from the respective GitHub link. You can use the GitHub desktop app, the GitHub command on the terminal command line, or the Python Notebook using the magic character exclamation point (<strong class="source-inline">!</strong>) and standard GitHub command, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
url = 'https://github.com/PacktPublishing/Data-Augmentation-with-Python'
!git clone {url}</pre>
			<p>Regardless of whether you choose the cloud-based options, such as Google Colab or Kaggle, or work offline, the Python Notebook code will work the same. The following section will dive into the Python Notebook programming style and introduce you <span class="No-Break">to Pluto.</span></p>
			<h1 id="_idParaDest-29"><a id="_idTextAnchor029"/>Programming styles</h1>
			<p>The coding style is<a id="_idIndexMarker038"/> the standard, tried-and-true method of object-oriented programing and is the variable naming convention for functions <span class="No-Break">and variables.</span></p>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">The majority of Python code you find on blogs and websites is snippets. Therefore, they are not very helpful in studying fundamental topics such as data augmentation. In addition, Python on a Notebook induces lazy practices because programmers think each Notebook’s code cell is a separate snippet from the whole. In reality, the entire Python Notebook is one program. Chief among the benefits of using best programming practices is that it’s easier to learn and retain knowledge. A programming style may include many standard best practices, but it is also unique to your programming style. Use it to your advantage by learning new concepts and techniques faster, such as how to write data <span class="No-Break">augmentation code.</span></p>
			<p>There are<a id="_idIndexMarker039"/> quite a few topics in this section. In particular, we will cover the <span class="No-Break">following concepts:</span></p>
			<ul>
				<li><span class="No-Break">Source control</span></li>
				<li>The <span class="No-Break"><strong class="source-inline">PackTDataAug</strong></span><span class="No-Break"> class</span></li>
				<li><span class="No-Break">Naming convention</span></li>
				<li>Extend <span class="No-Break">base class</span></li>
				<li><span class="No-Break">Referencing library</span></li>
				<li>Exporting <span class="No-Break">Python code</span></li>
				<li><span class="No-Break">Pluto</span></li>
			</ul>
			<p>Let’s begin with <span class="No-Break">source control.</span></p>
			<h2 id="_idParaDest-30"><a id="_idTextAnchor030"/>Source control</h2>
			<p>The first <a id="_idIndexMarker040"/>rule of programming is to manage the source code version. It will help you answer questions such as, <em class="italic">What did you code last week?</em>, <em class="italic">What was fixed yesterday?</em>, <em class="italic">What new feature was added today?</em>, and <em class="italic">How do I share my code with </em><span class="No-Break"><em class="italic">my team?</em></span></p>
			<p>The Git process manages the source code for one person or a team. Among many of Git's virtues is the freedom to make mistakes. In other words, Git allows you to try something new or break the code because you can always roll back to a <span class="No-Break">previous version.</span></p>
			<p>For source control, <strong class="bold">GitHub</strong> is a<a id="_idIndexMarker041"/> popular website, and <strong class="bold">Bitbucket</strong> comes in second<a id="_idIndexMarker042"/> place. You can use the Git process from a command-line terminal or Git applications, such as <span class="No-Break">GitHub Desktop.</span></p>
			<p>Google Colab <a id="_idIndexMarker043"/>has a built-in Git feature. You have seen how easy it is to load a Python Notebook on Google Colab, and saving it is just as easy. In Git, you must commit and push. The steps are <span class="No-Break">as follows:</span></p>
			<ol>
				<li>From the <strong class="bold">Colab</strong> menu, click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">File</strong></span><span class="No-Break">.</span></li>
				<li>Select <strong class="bold">Save a copy </strong><span class="No-Break"><strong class="bold">in GitHub</strong></span><span class="No-Break">.</span></li>
				<li>Enter your GitHub URL in the <strong class="bold">Repository</strong> field and select the <span class="No-Break">code branch.</span></li>
				<li>Enter the <span class="No-Break">commit message.</span></li>
				<li><span class="No-Break">Click </span><span class="No-Break"><strong class="bold">OK</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer011" class="IMG---Figure">
					<img src="image/B17990_01_06.jpg" alt="Figure 1.6 – Google Colab – saving to GitHub"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.6 – Google Colab – saving to GitHub</p>
			<p><span class="No-Break"><em class="italic">Figure 1</em></span><em class="italic">.6</em> shows the interface between Google Colab Python Notebook and GitHub. Next, we’ll look at the base <span class="No-Break">class, </span><span class="No-Break"><strong class="source-inline">PacktDataAug</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-31"><a id="_idTextAnchor031"/>The PacktDataAug class</h2>
			<p>The<a id="_idIndexMarker044"/> code for the base class is neither original nor unique to this book. It is standard Python code for constructing an object-oriented class. The name of the object is different for every project. For this book, the name of the class <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">PacktDataAug</strong></span><span class="No-Break">.</span></p>
			<p>Every chapter begins with this base class, and we will add new methods to the object using a Python decorator as we learn new concepts and techniques for <span class="No-Break">augmenting data.</span></p>
			<p>This exercise's Python<a id="_idIndexMarker045"/> code is in the Python Notebooks and on this book’s GitHub repository. Thus, I will not copy or display the complete code in this book. I will show relevant code lines, explain their significance, and rely on you to study the entire code in the <span class="No-Break">Python Notebooks.</span></p>
			<p>The definition of the base class is <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
<strong class="bold"># class definition</strong>
class PacktDataAug(object):
  def __init__(self,
    name="Pluto",
    is_verbose=True,
    args, **kwargs):</pre>
			<p><strong class="source-inline">PacktDataAug</strong> is inherent from the based <strong class="source-inline">Object</strong> class, and the definition has two <span class="No-Break">optional parameters:</span></p>
			<ul>
				<li>The <strong class="source-inline">name</strong> parameter is a string, and it is the name of your object. It has no essential function other than labeling <span class="No-Break">your object.</span></li>
				<li><strong class="source-inline">is_verbose</strong> is a Boolean that tells the object to print the object information <span class="No-Break">during instantiation.</span></li>
			</ul>
			<p>The next topic we will cover is the code <span class="No-Break">naming convention.</span></p>
			<h2 id="_idParaDest-32"><a id="_idTextAnchor032"/>Naming convention</h2>
			<p>The code naming convention<a id="_idIndexMarker046"/> is <span class="No-Break">as follows:</span></p>
			<ul>
				<li>The function’s name will begin with an action verb, such as <strong class="source-inline">print_</strong>, <strong class="source-inline">fetch_</strong>, <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">say_</strong></span><span class="No-Break">.</span></li>
				<li>A function that returns a Boolean value begins with <strong class="source-inline">is_</strong> <span class="No-Break">or </span><span class="No-Break"><strong class="source-inline">has_</strong></span><span class="No-Break">.</span></li>
				<li>Variable names begin with a noun, not an <span class="No-Break">action verb.</span></li>
				<li>There<a id="_idIndexMarker047"/> is a heated discussion in the Python community on whether to use camelCase – for example, <strong class="source-inline">fetchKaggleData()</strong> – or use lowercase with underscores – for example, <strong class="source-inline">fetch_kaggle_data()</strong>. This book uses lowercase <span class="No-Break">with underscores.</span></li>
				<li>Functions or variables that begin with underscores are temporary variables or helper functions – for example, <strong class="source-inline">_image_auto_id</strong>, <strong class="source-inline">_drop_images()</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">_append_full_path()</strong></span><span class="No-Break">.</span></li>
				<li>Variable or function abbreviations are sparingly used because the descriptive name is easier to understand. In addition, Colab has auto-complete functionality. Thus, it makes using long, descriptive names easier to type with <span class="No-Break">fewer typos.</span></li>
			</ul>
			<p>The code for instantiating a base class is standard Python code. I used <strong class="source-inline">pluto</strong> as the object name, but you can choose <span class="No-Break">any name:</span></p>
			<pre class="source-code">
<strong class="bold"># Instantiate Pluto</strong>
pluto = PackTDataAug("Pluto")</pre>
			<p>The output is <span class="No-Break">as follows:</span></p>
			<pre class="console">
--------------------------- : ---------------------------
            Hello from class : &lt;class '__main__.PacktDataAug '&gt; Class: PacktDataAug
                   Code name : Pluto
                   Author is : Duc Haba
---------------------------- : ---------------------------</pre>
			<p>The base class comes with two simple helper methods. They are both for printing pretty – that is, making the printing of status or output messages <span class="No-Break">neatly centered.</span></p>
			<p>The <strong class="source-inline">self._ph()</strong> method prints the header line with an equal number of dashes on both sides of the colon character, while the <strong class="source-inline">self._pp()</strong> function takes two parameters, one for the left-hand side and the other for the <span class="No-Break">right-hand side.</span></p>
			<p>You have already <a id="_idIndexMarker048"/>seen the result of instantiating pluto with the default parameter of <strong class="source-inline">is_verbose=True</strong>. As standard practice, I will not print the complete code in this book. I am relying on you to view and run the code in the Python Notebook, but I will make an exception for this chapter and show you the snippet of code for the <strong class="source-inline">is_verbose</strong> option. This demonstrates how easy it is to read Python code in the Python Notebook. The snippet is <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
<strong class="bold"># code snippet for verbose option</strong>
if (is_verbose):
  self._ph()
  self._pp(f"Hello from class {self.__class__} Class: {self.__class__.__name__}")
  self._pp("Code name", self.name)
  self._pp("Author is", self.author)
  self._ph()</pre>
			<p class="callout-heading">Fun fact</p>
			<p class="callout">This book’s primary goal is to help you write clean and easy-to-understand code and not write compact code that may lead <span class="No-Break">to obfuscation.</span></p>
			<p>Another powerful programming technique is using a Python decorator to extend the <span class="No-Break">base class.</span></p>
			<h2 id="_idParaDest-33"><a id="_idTextAnchor033"/>Extend base class</h2>
			<p>This book has <a id="_idIndexMarker049"/>been designed as an interactive journey where you learn and discover new data augmentation concepts and techniques sequentially, from image, text, and audio data to tabular data. The object, <strong class="source-inline">pluto</strong>, will acquire new methods as the journey progresses. Thus, having a technique to extend the class with new functions is essential. In contrast, providing the fully built class at the beginning of this book would not allow you to embark on the learning journey. Learning by exploration helps you retain knowledge longer compared to learning <span class="No-Break">by memorization.</span></p>
			<p>The <strong class="source-inline">@add_method()</strong> decorator function extends any class with a <span class="No-Break">new function.</span></p>
			<p>Here is an <a id="_idIndexMarker050"/>excellent example of extending the base class. The root cause of Python’s most common and frustrating error is having a different library version from the class homework or code snippet copy from the Python community. Python data scientists seldom write code from scratch and rely heavily on existing libraries. Thus, printing the Python library versions on a local or cloud-based server would save hours of aggravating <span class="No-Break">debugging sessions.</span></p>
			<p>To resolve this issue, we can extend the <strong class="source-inline">PacktDataAug</strong> class or use the journey metaphor of teaching Pluto a new trick. The new method, <strong class="source-inline">say_sys_info()</strong>, prints this book’s expected system library version on the left-hand side and the actual library version on your local or remote servers on the right-hand side. The decorator’s definition for extending the Pluto class is <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
<strong class="bold"># using decorator to add new method</strong>
@add_method(PackTDataAug)
def say_sys_info(self):</pre>
			<p>After running the aforementioned code cell, you can ask Pluto to print the library version using the <span class="No-Break">following command:</span></p>
			<pre class="source-code">
<strong class="bold"># check Python and libraries version</strong>
pluto.say_sys_info()</pre>
			<p>The results are <span class="No-Break">as follows:</span></p>
			<pre class="console">
---------------------------- : ---------------------------
                 System time : 2022/07/23 06:36
                    Platform : linux
     Pluto Version (Chapter) : 1.0
            Python (3.7.10)  : actual: 3.7.12 (default, Apr 24 2022, 17:11:25) [GCC 7.5.0]
            PyTorch (1.11.0) : actual: 1.12.1+cu113
              Pandas (1.3.5) : actual: 1.3.5
                 PIL (9.0.0) : actual: 7.1.2
          Matplotlib (3.2.2) : actual: 3.2.2
                   CPU count : 2
                  CPU speed : NOT available
---------------------------- : ---------------------------</pre>
			<p>If your result<a id="_idIndexMarker051"/> contains libraries that are older versions than this book’s expected value, you might run into bugs while working through the lessons. For <a id="_idIndexMarker052"/>example, the <strong class="bold">Pillow</strong> (<strong class="bold">PIL</strong>) library version is 7.1.2, which is lower than the book’s expected version <span class="No-Break">of 9.0.0.</span></p>
			<p>To correct this issue, run the following code line in the Notebook to install the <span class="No-Break">9.0.0 version:</span></p>
			<pre class="source-code">
<strong class="bold"># upgrade to Pillow library version 9.0.0</strong>
!pip install Pillow==9.0.0</pre>
			<p>Rerunning <strong class="source-inline">pluto.say_sys_info()</strong> should now show the <strong class="bold">PIL</strong> version <span class="No-Break">as 9.0.0.</span></p>
			<p class="callout-heading">Fun challenge</p>
			<p class="callout">Extend Pluto with a new function to display the system’s GPU total RAM and available free RAM. The function name can be <strong class="source-inline">fetch_system_gpu_ram()</strong>. A hint is to use the <strong class="source-inline">torch</strong> library and the <strong class="source-inline">torch.to cuda.memory_allocated()</strong> and <strong class="source-inline">torch.cuda.memory_reserved()</strong> functions. You can use this technique to extend any Python library class. For example, to add a new function to the <strong class="source-inline">numpy</strong> library, you <a id="_idIndexMarker053"/>can use the <strong class="source-inline">@</strong><span class="No-Break"><strong class="source-inline">add_method(numpy)</strong></span><span class="No-Break"> decorator.</span></p>
			<p>There are a few more programming-style topics. Next, you’ll discover how best to reference <span class="No-Break">a library.</span></p>
			<h2 id="_idParaDest-34"><a id="_idTextAnchor034"/>Referencing a library</h2>
			<p>Python is a<a id="_idIndexMarker054"/> flexible language when it comes to importing libraries. There are aliases and direct imports. Here are a few examples of importing the same function – that <span class="No-Break">is, </span><span class="No-Break"><strong class="source-inline">plot()</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
<strong class="bold"># display many options to import a function</strong>
from matplotlib.pyplot import plot
import matplotlib.pyplot
import matplotlib.pyplot as plt # most popular
<strong class="bold"># more exotics importing examples</strong>
from matplotlib.pyplot import plot as paint
import matplotlib.pyplot as canvas
from matplotlib import pyplot as plotter</pre>
			<p>The salient point is that all these examples are valid, and that is both good and bad. It enables flexibility, but at the same time, sharing code snippets online or maintaining code can lead to frustration when they break. Python often gives an unintelligible error message when the system cannot locate the function. To fix this bug, you need to know which library to upgrade. The problem is compounded when many libraries use the same function name, such as the <strong class="source-inline">imread()</strong> method, which appears in at least <span class="No-Break">four libraries.</span></p>
			<p>By adhering to this book’s programming style, when the <strong class="source-inline">imread()</strong> method fails, you know which library needs to be upgraded or, in rare conditions, downgraded. The code is <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
<strong class="bold"># example of use full method name</strong>
import matplotlib
matplotlib.pyplot.imread()</pre>
			<p><strong class="source-inline">matplotlib</strong> might need to be upgraded, or equally, you might be using the wrong <strong class="source-inline">imread()</strong> method. It could be <a id="_idIndexMarker055"/>from <strong class="bold">OpenCV</strong> version 4.7.0.72. Thus, the call should <span class="No-Break">be </span><span class="No-Break"><strong class="source-inline">cv2.imread()</strong></span><span class="No-Break">.</span></p>
			<p>The next concept is exporting. It may not strictly belong to the programming style, but it is necessary if you wish to reuse and add extra functions to this <span class="No-Break">chapter’s code.</span></p>
			<h2 id="_idParaDest-35"><a id="_idTextAnchor035"/>Exporting Python code</h2>
			<p>This <a id="_idIndexMarker056"/>book ensures that every chapter has its own Python Notebook. The advanced image, text, and audio chapters need the previous chapter's code. Thus, it is necessary to export the selected Python code cells from the <span class="No-Break">Python Notebook.</span></p>
			<p>The Python Notebook has both markup and code cells, and not all code cells must be exported. You only need to export code cells that define new functions. For the code cells that you want to export to a Python file, use the Python Notebook <strong class="source-inline">%%writefile file_name.py</strong> magic command at the beginning of the code cells and <strong class="source-inline">%%writefile -a file_name.py</strong> to append additional code to the file. <strong class="source-inline">file_name</strong> is the name of the Python file – for <span class="No-Break">example, </span><span class="No-Break"><strong class="source-inline">pluto_chapter_1.py</strong></span><span class="No-Break">.</span></p>
			<p>The last and best part of the programming style is introducing <strong class="bold">Pluto</strong> as your <span class="No-Break">coding companion.</span></p>
			<h2 id="_idParaDest-36"><a id="_idTextAnchor036"/>Pluto</h2>
			<p>Pluto uses a<a id="_idIndexMarker057"/> whimsical idea of teaching by including<a id="_idIndexMarker058"/> dialogs with an imaginary digital character. We can give Pluto tasks to complete. It has a friendly tone, and sometimes the author addresses you directly. It moves away from the direct lecturing format. There are scholarly papers that explain how lecturing in monologue is not the optimal method for learning new concepts, such as the article <em class="italic">Why Students Learn More From Dialogue- Than Monologue-Videos: Analyses of Peer Interactions</em> by Michelene T. H. Chi, Seokmin Kang, and David L. Yaghmourian that was published by the <em class="italic">Journal of the Learning Sciences</em> <span class="No-Break">in 2016.</span></p>
			<p>You are most likely reading this book alone rather than engaging in a group, learning how to write augmentation code together. Thus, creating an imaginary companion as the instantiated object might infuse imagination. It makes writing and reading more accessible – for example, the <strong class="source-inline">pluto.fetch_kaggle_data()</strong> function is self-explanatory, and little additional documentation is needed. It simplifies Python code to a common subject and <span class="No-Break">action-verb-sentence format.</span></p>
			<p class="callout-heading">Fun challenge</p>
			<p class="callout">Change the object name from <strong class="bold">Pluto</strong> to your favorite canine name, such<a id="_idIndexMarker059"/> as <strong class="bold">Biggy</strong>, <strong class="bold">Sunny</strong>, or <strong class="bold">Hanna</strong>. It will<a id="_idIndexMarker060"/> make the<a id="_idIndexMarker061"/> learning process more personal. For example, change <strong class="source-inline">pluto = PackTDataAug("Pluto")</strong> to <strong class="source-inline">hanna = </strong><span class="No-Break"><strong class="source-inline">PackTDataAug("Hanna")</strong></span><span class="No-Break">.</span></p>
			<p><strong class="bold">Fair warning</strong>: Do <a id="_idIndexMarker062"/>not<a id="_idIndexMarker063"/> choose your beloved cat as the object’s name because felines will not listen to any commands. Imagine asking your cat to <span class="No-Break">play fetch.</span></p>
			<h1 id="_idParaDest-37"><a id="_idTextAnchor037"/>Summary</h1>
			<p>In this chapter, you learned that data augmentation is essential for achieving higher accuracy prediction in DL and generative AI. Data augmentation is an economical option for extending a dataset without the difficulty of purchasing and labeling <span class="No-Break">new data.</span></p>
			<p>The four input data types are image, text, audio, and tabular. Each data type faces different challenges, techniques, and limitations. Furthermore, the dataset dictates which functions and parameters are suitable. For example, people’s faces and aerial photographs are image datasets, but you can’t expand the data by vertically flipping people’s images; however, you can vertically flip <span class="No-Break">aerial photos.</span></p>
			<p>In the second part of this chapter, you used <strong class="bold">Python notebooks</strong> to reinforce your learning of these augmentation concepts. This involved selecting a Python Notebook as the default IDE to access a cloud-based platform, such as <strong class="bold">Google Colab</strong> or <strong class="bold">Kaggle</strong>, or installing the Python Notebook locally on <span class="No-Break">your laptop.</span></p>
			<p>The <em class="italic">Programming styles</em> section lay the foundation for the Python Notebook’s structure. It touched on <strong class="bold">GitHub</strong> as a form of source control, using base classes, extending base classes, long library function names, exporting to Python, and <span class="No-Break">introducing Pluto.</span></p>
			<p>This chapter laid the foundation with Pluto as the main object. Pluto does not start with complete data augmentation functions – he begins with a minimum structure, and as he learns new data augmentation concepts and techniques from chapter to chapter, he will add new methods to <span class="No-Break">his arsenal.</span></p>
			<p>By the end of this book, Pluto and you will learn techniques regarding how to augment image, text, audio, and tabular data. In other words, you will learn how to write a powerful image, text, audio, and tabular augmentation class from scratch using real-world data, which you can reuse in future data <span class="No-Break">augmentation projects.</span></p>
			<p>Throughout this chapter, there were <em class="italic">fun facts</em> and <em class="italic">fun challenges</em>. Pluto hopes you will take advantage of what’s been provided and expand your experience beyond the scope of <span class="No-Break">this chapter.</span></p>
			<p>In <a href="B17990_02.xhtml#_idTextAnchor038"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <em class="italic">Biases in Data Augmentation</em>, Pluto and you will explore how data augmentation can increase biases. Using data biases as a guiding principle to data augmentation is an <span class="No-Break">often-overlooked technique.</span></p>
		</div>
	</body></html>