<html><head></head><body>
<div id="_idContainer153" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-290"><a id="_idTextAnchor342" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.1.1">14</span></h1>
<h1 id="_idParaDest-291" class="calibre5"><a id="_idTextAnchor343" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.2.1">Beyond Local Resources – Scaling Genetic Algorithms in the Cloud</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.3.1">This chapter builds on the previous one, which focused on using multiprocessing to enhance genetic algorithm performance. </span><span class="kobospan" id="kobo.3.2">It restructures the genetic algorithm into a </span><strong class="bold"><span class="kobospan" id="kobo.4.1">client-server</span></strong><span class="kobospan" id="kobo.5.1"> model, where the client employs </span><strong class="bold"><span class="kobospan" id="kobo.6.1">asynchronous I/O</span></strong><span class="kobospan" id="kobo.7.1">, and the server manages fitness function calculations. </span><span class="kobospan" id="kobo.7.2">The server component is then deployed to the cloud via </span><strong class="bold"><span class="kobospan" id="kobo.8.1">AWS Lambda</span></strong><span class="kobospan" id="kobo.9.1">, demonstrating a practical application of serverless architecture in optimizing genetic </span><span><span class="kobospan" id="kobo.10.1">algorithm computations.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.11.1">This chapter starts by discussing the advantages of dividing genetic algorithms into client and server components. </span><span class="kobospan" id="kobo.11.2">It then progresses to implementing this client-server model while using the same One-Max benchmark problem from the previous chapter. </span><span class="kobospan" id="kobo.11.3">The server is built using Flask, while the client leverages Python’s </span><strong class="source-inline"><span class="kobospan" id="kobo.12.1">asyncio</span></strong><span class="kobospan" id="kobo.13.1"> library for asynchronous operations. </span><span class="kobospan" id="kobo.13.2">The chapter includes experiments with deploying the Flask application on production-grade servers before ultimately deploying it on AWS Lambda, a serverless computing service, showcasing how cloud resources can be used to enhance the computational efficiency of </span><span><span class="kobospan" id="kobo.14.1">genetic algorithms.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.15.1">In this chapter, you will do </span><span><span class="kobospan" id="kobo.16.1">the following:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span class="kobospan" id="kobo.17.1">Understand the restructuring of genetic algorithms into a </span><span><span class="kobospan" id="kobo.18.1">client-server model</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.19.1">Learn how to use Flask to create a server that performs </span><span><span class="kobospan" id="kobo.20.1">fitness calculations</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.21.1">Develop an asynchronous I/O client in Python that interacts with the Flask server for genetic </span><span><span class="kobospan" id="kobo.22.1">algorithm evaluations</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.23.1">Gain familiarity with Python WSGI HTTP servers such as Gunicorn </span><span><span class="kobospan" id="kobo.24.1">and Waitress</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.25.1">Learn how to deploy the Flask server component to the cloud using Zappa for serverless execution on </span><span><span class="kobospan" id="kobo.26.1">AWS Lambda</span></span></li>
</ul>
<h1 id="_idParaDest-292" class="calibre5"><a id="_idTextAnchor344" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.27.1">Technical requirements</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.28.1">In this chapter, we will be using Python 3 with the following </span><span><span class="kobospan" id="kobo.29.1">supporting libraries:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span><strong class="source-inline1"><span class="kobospan" id="kobo.30.1">deap</span></strong></span></li>
<li class="calibre11"><span><strong class="source-inline1"><span class="kobospan" id="kobo.31.1">numpy</span></strong></span></li>
<li class="calibre11"><strong class="source-inline1"><span class="kobospan" id="kobo.32.1">aiohttp</span></strong><span class="kobospan" id="kobo.33.1"> – introduced in </span><span><span class="kobospan" id="kobo.34.1">this chapter</span></span></li>
</ul>
<p class="callout-heading"><span class="kobospan" id="kobo.35.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.36.1">If you use the </span><strong class="source-inline1"><span class="kobospan" id="kobo.37.1">requirements.txt</span></strong><span class="kobospan" id="kobo.38.1"> file we provide (see </span><a href="B20851_03.xhtml#_idTextAnchor091" class="calibre6 pcalibre pcalibre1"><span><em class="italic"><span class="kobospan" id="kobo.39.1">Chapter 3</span></em></span></a><span class="kobospan" id="kobo.40.1">), these libraries are already included in </span><span><span class="kobospan" id="kobo.41.1">your environment.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.42.1">In addition, a separate server virtual environment will be created and used for a separate server module, with the following </span><span><span class="kobospan" id="kobo.43.1">supporting libraries:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span><strong class="source-inline1"><span class="kobospan" id="kobo.44.1">flask</span></strong></span></li>
<li class="calibre11"><span><strong class="source-inline1"><span class="kobospan" id="kobo.45.1">gunicorn</span></strong></span></li>
<li class="calibre11"><span><strong class="source-inline1"><span class="kobospan" id="kobo.46.1">waitress</span></strong></span></li>
<li class="calibre11"><span><strong class="source-inline1"><span class="kobospan" id="kobo.47.1">zappa</span></strong></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.48.1">The programs that will be used in this chapter can be found in this book’s GitHub repository </span><span><span class="kobospan" id="kobo.49.1">at </span></span><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_14" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.50.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_14</span></span></a><span><span class="kobospan" id="kobo.51.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.52.1">Check out the following video to see the Code in Action: </span></p>
<p class="calibre3"><a href="https://packt.link/OEBOd" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.53.1">https://packt.link/OEBOd</span></span></a></p>
<h1 id="_idParaDest-293" class="calibre5"><a id="_idTextAnchor345" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.54.1">The next level in genetic algorithm performance –embracing a client-server architecture</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.55.1">In the previous chapter, we</span><a id="_idIndexMarker838" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.56.1"> implemented our genetic algorithm in a multiprocessor approach, leveraging the “embarrassingly parallelizable” nature of genetic algorithms to significantly reduce the time required for each generation to complete. </span><span class="kobospan" id="kobo.56.2">Recognizing that the most time-consuming aspect of the algorithm is typically the computation of the fitness function, we established a benchmark that simulates a CPU-intensive fitness function. </span><span class="kobospan" id="kobo.56.3">By employing Python’s built-in multiprocessing capabilities as well as an external library named </span><a id="_idIndexMarker839" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.57.1">SCOOP, we successfully managed to decrease the </span><span><span class="kobospan" id="kobo.58.1">runtime substantially.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.59.1">However, these implementations were constrained to a single program operating on a single machine. </span><span class="kobospan" id="kobo.59.2">When addressing real-world problems, this approach is likely to encounter resource limitations of the machine—not just in terms of available CPU cores but also in essential resources such as memory and storage. </span><span class="kobospan" id="kobo.59.3">In contrast to our benchmark program, which primarily consumes CPU time, real-world fitness functions may have extensive demands for both processing power and memory, presenting a </span><span><span class="kobospan" id="kobo.60.1">significant challenge.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.61.1">We have observed that the SCOOP library supports distributed computing by utilizing additional machines on our network. </span><span class="kobospan" id="kobo.61.2">However, in this chapter, we will explore a different approach that involves dividing our program into two separate components. </span><span class="kobospan" id="kobo.61.3">This methodology will afford us greater flexibility in selecting the platforms for these components. </span><span class="kobospan" id="kobo.61.4">Such a strategy opens up opportunities for more diverse and powerful computing solutions, including cloud-based services or specialized hardware, thereby overcoming some limitations inherent in relying solely on </span><span><span class="kobospan" id="kobo.62.1">networked machines.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.63.1">The upcoming sections will detail the design and implementation of this new structure, which we will carry out in </span><span><span class="kobospan" id="kobo.64.1">several stages.</span></span></p>
<h1 id="_idParaDest-294" class="calibre5"><a id="_idTextAnchor346" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.65.1">Implementing a client-server model</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.66.1">Our plan is to divide the execution </span><a id="_idIndexMarker840" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.67.1">of the genetic algorithm into two distinct parts—client and server—outlined </span><span><span class="kobospan" id="kobo.68.1">as follows:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.69.1">Client Component</span></strong><span class="kobospan" id="kobo.70.1">: The client will oversee the evolutionary logic in a centralized manner. </span><span class="kobospan" id="kobo.70.2">This includes managing the initialization of populations, selection processes, and genetic operations such as crossover </span><span><span class="kobospan" id="kobo.71.1">and mutation.</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.72.1">Server Component</span></strong><span class="kobospan" id="kobo.73.1">: The server will be tasked with executing the resource-intensive fitness function calculations. </span><span class="kobospan" id="kobo.73.2">It will employ multiprocessing to fully leverage its computational resources, circumventing </span><a id="_idIndexMarker841" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.74.1">the limitations imposed by Python’s </span><strong class="bold"><span class="kobospan" id="kobo.75.1">Global Interpreter </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.76.1">Lock</span></strong></span><span><span class="kobospan" id="kobo.77.1"> (</span></span><span><strong class="bold"><span class="kobospan" id="kobo.78.1">GIL</span></strong></span><span><span class="kobospan" id="kobo.79.1">).</span></span></li>
<li class="calibre11"><strong class="bold"><span class="kobospan" id="kobo.80.1">Client’s Use of Asynchronous I/O</span></strong><span class="kobospan" id="kobo.81.1">: Additionally, the client will employ asynchronous I/O, which </span><a id="_idIndexMarker842" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.82.1">operates on a single-threaded, event-driven model. </span><span class="kobospan" id="kobo.82.2">This approach can efficiently handle I/O-bound tasks, allowing the program to concurrently manage other operations while waiting for I/O processes to complete. </span><span class="kobospan" id="kobo.82.3">In adopting asynchronous I/O for server communication, the client is able to send a request and then proceed with other tasks, rather than waiting passively for a response. </span><span class="kobospan" id="kobo.82.4">This is akin to a waiter who delivers a guest’s order to the kitchen and, instead of waiting there, takes the next order from another table while the previous orders are being prepared. </span><span class="kobospan" id="kobo.82.5">Similarly, our client optimizes the workflow by not blocking the main thread of execution while waiting for </span><span><span class="kobospan" id="kobo.83.1">server responses.</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.84.1">This client-server model and its operational dynamics are illustrated in the </span><span><span class="kobospan" id="kobo.85.1">following diagram:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer146">
<span class="kobospan" id="kobo.86.1"><img alt="Figure 14.1: Block diagram of the proposed client-server setup" src="image/B20851_14_1.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.87.1">Figure 14.1: Block diagram of the proposed client-server setup</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.88.1">Before we dive into</span><a id="_idIndexMarker843" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.89.1"> implementing this model, it’s highly recommended to set up a separate Python environment specifically for the server component, as described in the </span><span><span class="kobospan" id="kobo.90.1">next section.</span></span></p>
<h2 id="_idParaDest-295" class="calibre7"><a id="_idTextAnchor347" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.91.1">Using a separate environment</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.92.1">As we began coding in </span><a href="B20851_03.xhtml#_idTextAnchor091" class="calibre6 pcalibre pcalibre1"><span><em class="italic"><span class="kobospan" id="kobo.93.1">Chapter 3</span></em></span></a><span class="kobospan" id="kobo.94.1">, </span><em class="italic"><span class="kobospan" id="kobo.95.1">Using the DEAP Framework</span></em><span class="kobospan" id="kobo.96.1">, we recommended creating a virtual environment for our programs, utilizing tools such as </span><strong class="source-inline"><span class="kobospan" id="kobo.97.1">venv</span></strong><span class="kobospan" id="kobo.98.1"> or </span><strong class="source-inline"><span class="kobospan" id="kobo.99.1">conda</span></strong><span class="kobospan" id="kobo.100.1">. </span><span class="kobospan" id="kobo.100.2">Employing a virtual environment is a best practice in Python development, as it allows us to keep the dependencies </span><a id="_idIndexMarker844" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.101.1">of our projects isolated from both other Python projects and the system’s default settings </span><span><span class="kobospan" id="kobo.102.1">and dependencies.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.103.1">Given that the client part manages the logic of the genetic algorithm and uses the DEAP framework, we can continue developing it within the same environment we’ve been using so far. </span><span class="kobospan" id="kobo.103.2">However, it’s advisable to create a separate environment for the server component. </span><span class="kobospan" id="kobo.103.3">The reasoning is twofold: firstly, the server will not be using the DEAP dependency but will instead rely on a different set of Python libraries; and secondly, we ultimately plan to deploy the server outside our local computer, so it’s preferable to have this deployment as lightweight </span><span><span class="kobospan" id="kobo.104.1">as possible.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.105.1">For reference, you can review the process of creating a virtual environment using </span><strong class="source-inline"><span class="kobospan" id="kobo.106.1">venv</span></strong> <span><span class="kobospan" id="kobo.107.1">here: </span></span><a href="https://docs.python.org/3/library/venv.html" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.108.1">https://docs.python.org/3/library/venv.html</span></span></a><span><span class="kobospan" id="kobo.109.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.110.1">Similarly, environment management using </span><strong class="source-inline"><span class="kobospan" id="kobo.111.1">conda</span></strong><span class="kobospan" id="kobo.112.1"> is described </span><span><span class="kobospan" id="kobo.113.1">here: </span></span><a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.114.1">https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html</span></span></a><span><span class="kobospan" id="kobo.115.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.116.1">The code for the server module is best kept in a separate directory as well; in our repository, we keep it in a directory named </span><strong class="source-inline"><span class="kobospan" id="kobo.117.1">server</span></strong><span class="kobospan" id="kobo.118.1">, under the </span><span><strong class="source-inline"><span class="kobospan" id="kobo.119.1">chapter_13</span></strong></span><span><span class="kobospan" id="kobo.120.1"> directory.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.121.1">Once we have created and activated a virtual environment for the server component, we’re ready to dive into the coding of the components. </span><span class="kobospan" id="kobo.121.2">But first, let’s take a moment to recap the benchmark problem </span><span><span class="kobospan" id="kobo.122.1">we’re tackling.</span></span></p>
<h1 id="_idParaDest-296" class="calibre5"><a id="_idTextAnchor348" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.123.1">Revisiting the One-Max problem, yet again</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.124.1">As a reminder, in </span><a href="B20851_13.xhtml#_idTextAnchor326" class="calibre6 pcalibre pcalibre1"><span><em class="italic"><span class="kobospan" id="kobo.125.1">Chapter 13</span></em></span></a><span class="kobospan" id="kobo.126.1">, </span><em class="italic"><span class="kobospan" id="kobo.127.1">Accelerating Genetic Algorithms</span></em><span class="kobospan" id="kobo.128.1">, we employed a version of the OneMax </span><a id="_idIndexMarker845" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.129.1">problem as a benchmark. </span><span class="kobospan" id="kobo.129.2">The goal of this program is to find the binary string of a specified length that maximizes the sum of its digits. </span><span class="kobospan" id="kobo.129.3">For our purposes, we used a reduced problem length of 10 digits, along with smaller figures for the population size and the number of generations. </span><span class="kobospan" id="kobo.129.4">Additionally, we introduced a </span><strong class="source-inline"><span class="kobospan" id="kobo.130.1">busy_wait()</span></strong><span class="kobospan" id="kobo.131.1"> function into the original fitness evaluation function. </span><span class="kobospan" id="kobo.131.2">This function kept the CPU busy for three seconds during each evaluation, significantly increasing the program’s execution time. </span><span class="kobospan" id="kobo.131.3">This setup </span><a id="_idIndexMarker846" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.132.1">allowed us to experiment with various multiprocessing schemes and to compare their respective </span><span><span class="kobospan" id="kobo.133.1">running durations.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.134.1">For our experiments with the client-server model, we will continue to use this same program, albeit with modifications tailored to our current requirements. </span><span class="kobospan" id="kobo.134.2">This approach will allow us to directly compare the results with those obtained in the </span><span><span class="kobospan" id="kobo.135.1">previous chapter.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.136.1">We are finally ready to write some code—starting with the server module, which will be based on Flask, the Python web </span><span><span class="kobospan" id="kobo.137.1">application framework.</span></span></p>
<h2 id="_idParaDest-297" class="calibre7"><a id="_idTextAnchor349" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.138.1">Creating the server component</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.139.1">Flask, known for its lightweight </span><a id="_idIndexMarker847" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.140.1">and flexible nature, will be the cornerstone of our server component in the Python environment. </span><span class="kobospan" id="kobo.140.2">Its simplicity and user-friendly approach make it a popular choice, especially for projects that require adaptability across various platforms and </span><span><span class="kobospan" id="kobo.141.1">cloud installations.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.142.1">To install Flask, make sure you are within the server’s virtual environment, and use the </span><span><span class="kobospan" id="kobo.143.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.144.1">
pip install Flask</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.145.1">One of the key advantages of using Flask is that it requires minimal coding effort on our part. </span><span class="kobospan" id="kobo.145.2">We just need to write the handlers for incoming requests, and Flask efficiently manages all the other underlying processes. </span><span class="kobospan" id="kobo.145.3">Given that our server component’s primary responsibility is to handle the calculation of the fitness function, the amount of code we need to write </span><span><span class="kobospan" id="kobo.146.1">is minimal.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.147.1">The relevant Python</span><a id="_idIndexMarker848" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.148.1"> program we created is </span><strong class="source-inline"><span class="kobospan" id="kobo.149.1">fitness_evaluator.py</span></strong><span class="kobospan" id="kobo.150.1">, available at the </span><span><span class="kobospan" id="kobo.151.1">following link:</span></span></p>
<p class="calibre3"><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/server/fitness_evaluator.py" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.152.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/server/fitness_evaluator.py</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.153.1">This program extends the minimal application outlined in Flask’s Quickstart documentation, as </span><span><span class="kobospan" id="kobo.154.1">detailed here:</span></span></p>
<ol class="calibre15">
<li class="calibre11"><span class="kobospan" id="kobo.155.1">First, we import the </span><strong class="source-inline1"><span class="kobospan" id="kobo.156.1">Flask</span></strong><span class="kobospan" id="kobo.157.1"> class and create an instance of this class. </span><span class="kobospan" id="kobo.157.2">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.158.1">__name__</span></strong><span class="kobospan" id="kobo.159.1"> argument represents the name of the application’s module </span><span><span class="kobospan" id="kobo.160.1">or package:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.161.1">
from flask import Flask
app = Flask(__name__)</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.162.1">Next, we define the </span><strong class="source-inline1"><span class="kobospan" id="kobo.163.1">welcome()</span></strong><span class="kobospan" id="kobo.164.1"> function for “health-check” purposes. </span><span class="kobospan" id="kobo.164.2">This function returns an HTML-formatted welcome message. </span><span class="kobospan" id="kobo.164.3">When we direct our browser to the base URL of the server, this message is displayed, confirming that the server is operational. </span><span class="kobospan" id="kobo.164.4">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.165.1">@app.route("/")</span></strong><span class="kobospan" id="kobo.166.1"> decorator specifies that this function should be triggered by the </span><span><span class="kobospan" id="kobo.167.1">root URL:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.168.1">@app.route("/")</span></strong><span class="kobospan1" id="kobo.169.1">
def welcome():
    return "&lt;p&gt;Welcome to our Fitness Evaluation Server!&lt;/p&gt;"</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.170.1">We then reuse the </span><strong class="source-inline1"><span class="kobospan" id="kobo.171.1">busy_wait()</span></strong><span class="kobospan" id="kobo.172.1"> function from the previous chapter. </span><span class="kobospan" id="kobo.172.2">This function simulates a CPU-intensive fitness evaluation, of a duration specified by the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.173.1">DELAY_SECONDS</span></strong></span><span><span class="kobospan" id="kobo.174.1"> constant:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.175.1">
def busy_wait(duration):
    current_time = time.time()
    while (time.time() &lt; current_time + duration):
        pass</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.176.1">Finally, we define the actual fitness evaluation function, </span><strong class="source-inline1"><span class="kobospan" id="kobo.177.1">oneMaxFitness()</span></strong><span class="kobospan" id="kobo.178.1">. </span><span class="kobospan" id="kobo.178.2">Decorated by the </span><strong class="source-inline1"><span class="kobospan" id="kobo.179.1">/one_max_fitness</span></strong><span class="kobospan" id="kobo.180.1"> route, it expects a value (the genetic individual) to be </span><a id="_idIndexMarker849" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.181.1">passed in the URL, which is then processed by the function. </span><span class="kobospan" id="kobo.181.2">The function calls </span><strong class="source-inline1"><span class="kobospan" id="kobo.182.1">busy_wait</span></strong><span class="kobospan" id="kobo.183.1"> to simulate processing, then calculates the sum of 1s in the provided string and returns this sum as a string. </span><span class="kobospan" id="kobo.183.2">We use strings as input and output for this function to accommodate HTTP’s text-based data transmission in </span><span><span class="kobospan" id="kobo.184.1">web applications:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.185.1">
@app.route("</span><strong class="bold1"><span class="kobospan1" id="kobo.186.1">/one_max_fitness/&lt;individual_as_string&gt;</span></strong><span class="kobospan1" id="kobo.187.1">")
def oneMaxFitness(individual_as_string):
    busy_wait(DELAY_SECONDS)
    </span><strong class="bold1"><span class="kobospan1" id="kobo.188.1">individual = [int(char) for char in individual_as_string]</span></strong><span class="kobospan1" id="kobo.189.1">
    return str(sum(individual))</span></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.190.1">To initiate our Flask-based web application, we first need to navigate into the </span><strong class="source-inline"><span class="kobospan" id="kobo.191.1">server</span></strong><span class="kobospan" id="kobo.192.1"> directory, and then activate the server’s virtual environment. </span><span class="kobospan" id="kobo.192.2">Once activated, the application can be launched with the following command, executed from the terminal within </span><span><span class="kobospan" id="kobo.193.1">that environment:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.194.1">
flask --app fitness_evaluator run</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.195.1">This yields the </span><span><span class="kobospan" id="kobo.196.1">following output:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.197.1">
* Serving Flask app 'fitness_evaluator'
* Debug mode: off
WARNING: This is a development server. </span><span class="kobospan1" id="kobo.197.2">Do not use it in a production deployment. </span><span class="kobospan1" id="kobo.197.3">Use a production WSGI server instead.
</span><span class="kobospan1" id="kobo.197.4">* Running on http://127.0.0.1:5000
Press CTRL+C to quit</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.198.1">The warning regarding Flask’s built-in server is a reminder that it’s not designed for performance optimization</span><a id="_idIndexMarker850" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.199.1"> and is meant for development purposes only. </span><span class="kobospan" id="kobo.199.2">However, for our current needs, this server is perfectly appropriate to test and verify the logic of our application. </span><span class="kobospan" id="kobo.199.3">To do this, we can simply use a web browser on our </span><span><span class="kobospan" id="kobo.200.1">local machine.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.201.1">Upon opening a browser and navigating to the specified URL (</span><strong class="source-inline"><span class="kobospan" id="kobo.202.1">http://127.0.0.1:5000</span></strong><span class="kobospan" id="kobo.203.1">), we should see the “Welcome” message appear, indicating that our server is up and running, as </span><span><span class="kobospan" id="kobo.204.1">illustrated here:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer147">
<span class="kobospan" id="kobo.205.1"><img alt="Figure 14.2: Display of the Welcome message at the server’s root URL" src="image/B20851_14_2.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.206.1">Figure 14.2: Display of the Welcome message at the server’s root URL</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.207.1">Next, let’s test the fitness function by navigating to the following </span><span><span class="kobospan" id="kobo.208.1">URL: </span></span><a href="http://127.0.0.1:5000/one_max_fitness/1100110010" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.209.1">http://127.0.0.1:5000/one_max_fitness/1100110010</span></span></a><span><span class="kobospan" id="kobo.210.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.211.1">Accessing this URL internally triggers a call to the </span><strong class="source-inline"><span class="kobospan" id="kobo.212.1">oneMaxFitness()</span></strong><span class="kobospan" id="kobo.213.1"> function with </span><strong class="source-inline"><span class="kobospan" id="kobo.214.1">1100110010</span></strong><span class="kobospan" id="kobo.215.1"> as the argument. </span><span class="kobospan" id="kobo.215.2">As expected, after a delay of several seconds (introduced by the </span><strong class="source-inline"><span class="kobospan" id="kobo.216.1">busy_wait()</span></strong><span class="kobospan" id="kobo.217.1"> function to simulate processing time), we receive a response. </span><span class="kobospan" id="kobo.217.2">The browser displays the number </span><strong class="source-inline"><span class="kobospan" id="kobo.218.1">5</span></strong><span class="kobospan" id="kobo.219.1">, which represents the calculated sum of 1s in the input string, as illustrated in the </span><span><span class="kobospan" id="kobo.220.1">figure here:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer148">
<span class="kobospan" id="kobo.221.1"><img alt="Figure 14.3: Testing the server’s fitness function via a browser" src="image/B20851_14_3.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.222.1">Figure 14.3: Testing the server’s fitness function via a browser</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.223.1">Now that we’ve successfully</span><a id="_idIndexMarker851" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.224.1"> set up and verified the server, let’s move on to implementing the </span><span><span class="kobospan" id="kobo.225.1">client side.</span></span></p>
<h2 id="_idParaDest-298" class="calibre7"><a id="_idTextAnchor350" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.226.1">Creating the client component</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.227.1">To start working on</span><a id="_idIndexMarker852" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.228.1"> the client module, we need to switch back to the original virtual environment used for our genetic algorithms’ programs. </span><span class="kobospan" id="kobo.228.2">This can be</span><a id="_idIndexMarker853" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.229.1"> done by using a separate terminal or opening a new window in the IDE where this environment is activated. </span><span class="kobospan" id="kobo.229.2">The various programs implementing the client module can be found at the </span><span><span class="kobospan" id="kobo.230.1">following location:</span></span></p>
<p class="calibre3"><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_14" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.231.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_14</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.232.1">The first program we’ll examine is </span><strong class="source-inline"><span class="kobospan" id="kobo.233.1">01_one_max_client.py</span></strong><span class="kobospan" id="kobo.234.1">, which functions as a straightforward (synchronous) client. </span><span class="kobospan" id="kobo.234.2">This program can be found at the </span><span><span class="kobospan" id="kobo.235.1">following location:</span></span></p>
<p class="calibre3"><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/01_one_max_client.py" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.236.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/01_one_max_client.py</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.237.1">This program adapts </span><strong class="source-inline"><span class="kobospan" id="kobo.238.1">01_one_max_start.py</span></strong><span class="kobospan" id="kobo.239.1"> from the previous chapter—the basic OneMax problem solver. </span><span class="kobospan" id="kobo.239.2">To support the delegation of fitness calculation to the server, we made the </span><span><span class="kobospan" id="kobo.240.1">following modifications:</span></span></p>
<ol class="calibre15">
<li class="calibre11"><span class="kobospan" id="kobo.241.1">The Python </span><strong class="source-inline1"><span class="kobospan" id="kobo.242.1">urllib</span></strong><span class="kobospan" id="kobo.243.1"> module is imported. </span><span class="kobospan" id="kobo.243.2">This module provides a suite of functions and classes for working with URLs, which we will use to send HTTP requests to the server and retrieve </span><span><span class="kobospan" id="kobo.244.1">the responses.</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.245.1">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.246.1">BASE_URL</span></strong><span class="kobospan" id="kobo.247.1"> constant is defined to point to the base URL of </span><span><span class="kobospan" id="kobo.248.1">the server:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.249.1">
BASE_URL="http://127.0.0.1:5000"</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.250.1">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.251.1">oneMaxFitness()</span></strong><span class="kobospan" id="kobo.252.1"> function is renamed </span><strong class="source-inline1"><span class="kobospan" id="kobo.253.1">oneMaxFitness_client()</span></strong><span class="kobospan" id="kobo.254.1">. </span><span class="kobospan" id="kobo.254.2">This function converts the given individual—a list of integers (</span><strong class="source-inline1"><span class="kobospan" id="kobo.255.1">0</span></strong><span class="kobospan" id="kobo.256.1"> or </span><strong class="source-inline1"><span class="kobospan" id="kobo.257.1">1</span></strong><span class="kobospan" id="kobo.258.1">)—into a single string. </span><span class="kobospan" id="kobo.258.2">It then uses the </span><strong class="source-inline1"><span class="kobospan" id="kobo.259.1">urlopen()</span></strong><span class="kobospan" id="kobo.260.1"> function from </span><strong class="source-inline1"><span class="kobospan" id="kobo.261.1">urllib</span></strong><span class="kobospan" id="kobo.262.1"> to send</span><a id="_idIndexMarker854" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.263.1"> this string to the fitness calculation endpoint on the server, by combining the base URL with the function’s route and appending the string representing the individual. </span><span class="kobospan" id="kobo.263.2">The function waits (synchronously) for the response and converts it back to </span><span><span class="kobospan" id="kobo.264.1">an integer:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.265.1">
def oneMaxFitness_client(individual):
    </span><strong class="bold1"><span class="kobospan1" id="kobo.266.1">individual_as_str</span></strong><span class="kobospan1" id="kobo.267.1"> = ''.join(str(bit) for bit in individual)
    response = urlopen(f'{</span><strong class="bold1"><span class="kobospan1" id="kobo.268.1">BASE_URL}/one_max_fitness/{individual_as_str}</span></strong><span class="kobospan1" id="kobo.269.1">')
    if response.status != 200:
        print("Exception!")
    sum_digits_str = response.read().decode('utf-8')
    return </span><strong class="bold1"><span class="kobospan1" id="kobo.270.1">int(sum_digits_str),</span></strong></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.271.1">We can now launch this client program while the Flask server is up, and watch the server’s output, showing requests coming in. </span><span class="kobospan" id="kobo.271.2">It is evident that the requests are coming one at a time, with a noticeable three-second delay between them. </span><span class="kobospan" id="kobo.271.3">Meanwhile, on the client side, the output mirrors what we observed in the previous chapter before </span><span><span class="kobospan" id="kobo.272.1">introducing multiprocessing:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.273.1">
gen     nevals  max     avg
0       20      7       4.35
1       14      7       6.1
2       16      9       6.85
3       16      9       7.6
4       16      9       8.45
5       13      10      8.9
Best Individual =  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Elapsed time = </span><strong class="bold1"><span class="kobospan1" id="kobo.274.1">285.53 seconds</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.275.1">The elapsed time is similar as well, roughly</span><a id="_idIndexMarker855" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.276.1"> 3 seconds times the amount of fitness function invocations (95), reaffirming the synchronous nature of our current </span><span><span class="kobospan" id="kobo.277.1">client-server interaction.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.278.1">Now that the operation has been successful and the fitness function has been effectively separated and moved to the server, let’s take the next step and convert the client into an </span><span><span class="kobospan" id="kobo.279.1">asynchronous one.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.280.1">Creating the asynchronous client</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.281.1">To support asynchronous I/O, we are going to use </span><strong class="source-inline"><span class="kobospan" id="kobo.282.1">aiohttp</span></strong><span class="kobospan" id="kobo.283.1">, a powerful Python library for asynchronous HTTP client/server</span><a id="_idIndexMarker856" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.284.1"> networking. </span><span class="kobospan" id="kobo.284.2">This library, along</span><a id="_idIndexMarker857" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.285.1"> with its dependencies, can be installed in the client’s virtual environment using the </span><span><span class="kobospan" id="kobo.286.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.287.1">
pip install aiohttp</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.288.1">The modules modified for the asynchronous version of the client include not only the </span><strong class="source-inline"><span class="kobospan" id="kobo.289.1">02_one_max_async_client.py</span></strong><span class="kobospan" id="kobo.290.1"> program but also </span><strong class="source-inline"><span class="kobospan" id="kobo.291.1">elitism_async.py</span></strong><span class="kobospan" id="kobo.292.1">, which replaces </span><strong class="source-inline"><span class="kobospan" id="kobo.293.1">elitism.py</span></strong><span class="kobospan" id="kobo.294.1"> used in most of our programs so far. </span><span class="kobospan" id="kobo.294.2">While </span><strong class="source-inline"><span class="kobospan" id="kobo.295.1">02_one_max_async_client.py</span></strong><span class="kobospan" id="kobo.296.1"> contains the function that sends fitness calculation requests to the server, </span><strong class="source-inline"><span class="kobospan" id="kobo.297.1">elitism_async.py</span></strong><span class="kobospan" id="kobo.298.1"> manages the main genetic algorithm loop and is responsible</span><a id="_idIndexMarker858" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.299.1"> for calling that function. </span><span class="kobospan" id="kobo.299.2">The following subsections will delve into the details of</span><a id="_idIndexMarker859" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.300.1"> these </span><span><span class="kobospan" id="kobo.301.1">two programs.</span></span></p>
<h4 class="calibre19"><span class="kobospan" id="kobo.302.1">Updating the OneMax solver</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.303.1">Let’s start with </span><strong class="source-inline"><span class="kobospan" id="kobo.304.1">02_one_max_async_client.py</span></strong><span class="kobospan" id="kobo.305.1">, which can be </span><span><span class="kobospan" id="kobo.306.1">found here:</span></span></p>
<p class="calibre3"><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/02_one_max_async_client.py" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.307.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/02_one_max_async_client.py</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.308.1">The differences from the previous, synchronous</span><a id="_idIndexMarker860" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.309.1"> program </span><strong class="source-inline"><span class="kobospan" id="kobo.310.1">01_one_max_client.py</span></strong><span class="kobospan" id="kobo.311.1"> are </span><span><span class="kobospan" id="kobo.312.1">highlighted here:</span></span></p>
<ol class="calibre15">
<li class="calibre11"><span class="kobospan" id="kobo.313.1">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.314.1">oneMaxFitness_client()</span></strong><span class="kobospan" id="kobo.315.1"> function has been renamed </span><strong class="source-inline1"><span class="kobospan" id="kobo.316.1">async_oneMaxFitness_client()</span></strong><span class="kobospan" id="kobo.317.1">. </span><span class="kobospan" id="kobo.317.2">In addition to </span><strong class="source-inline1"><span class="kobospan" id="kobo.318.1">individual</span></strong><span class="kobospan" id="kobo.319.1">, the new function also receives a </span><strong class="source-inline1"><span class="kobospan" id="kobo.320.1">session</span></strong><span class="kobospan" id="kobo.321.1"> argument of the </span><strong class="source-inline1"><span class="kobospan" id="kobo.322.1">aiohttp.ClientSession</span></strong><span class="kobospan" id="kobo.323.1"> type; this object is responsible for managing asynchronous requests while reusing connections. </span><span class="kobospan" id="kobo.323.2">The function signature is preceded by the </span><strong class="source-inline1"><span class="kobospan" id="kobo.324.1">async</span></strong><span class="kobospan" id="kobo.325.1"> keyword, marking it as a </span><em class="italic"><span class="kobospan" id="kobo.326.1">coroutine</span></em><span class="kobospan" id="kobo.327.1">. </span><span class="kobospan" id="kobo.327.2">This designation allows the function to pause its execution and yield control back to the event loop, enabling the concurrent sending </span><span><span class="kobospan" id="kobo.328.1">of requests:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.329.1">async</span></strong><span class="kobospan1" id="kobo.330.1"> def async_oneMaxFitness_client(</span><strong class="bold1"><span class="kobospan1" id="kobo.331.1">session</span></strong><span class="kobospan1" id="kobo.332.1">, individual):</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.333.1">The HTTP GET request to the server is sent using the </span><strong class="source-inline1"><span class="kobospan" id="kobo.334.1">session</span></strong><span class="kobospan" id="kobo.335.1"> object. </span><span class="kobospan" id="kobo.335.2">When a response is received, it is available in the </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.336.1">response</span></strong></span><span><span class="kobospan" id="kobo.337.1"> variable:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.338.1">async</span></strong><span class="kobospan1" id="kobo.339.1"> with </span><strong class="bold1"><span class="kobospan1" id="kobo.340.1">session.get</span></strong><span class="kobospan1" id="kobo.341.1">(url) as </span><strong class="bold1"><span class="kobospan1" id="kobo.342.1">response</span></strong><span class="kobospan1" id="kobo.343.1">:
    ...</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.344.1">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.345.1">main()</span></strong><span class="kobospan" id="kobo.346.1"> function, which now utilizes calls to async functions, is defined with the </span><strong class="source-inline1"><span class="kobospan" id="kobo.347.1">async</span></strong><span class="kobospan" id="kobo.348.1"> keyword </span><span><span class="kobospan" id="kobo.349.1">as well.</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.350.1">The call to the genetic algorithm’s main loop now utilizes the </span><strong class="source-inline1"><span class="kobospan" id="kobo.351.1">elitism_async</span></strong><span class="kobospan" id="kobo.352.1"> module instead of the original </span><strong class="source-inline1"><span class="kobospan" id="kobo.353.1">elitism</span></strong><span class="kobospan" id="kobo.354.1">. </span><span class="kobospan" id="kobo.354.2">This module will be examined shortly. </span><span class="kobospan" id="kobo.354.3">In addition, the call is</span><a id="_idIndexMarker861" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.355.1"> preceded by the </span><strong class="source-inline1"><span class="kobospan" id="kobo.356.1">await</span></strong><span class="kobospan" id="kobo.357.1"> keyword, required when calling an async function, to signify the function’s ability to hand control back over to the </span><span><span class="kobospan" id="kobo.358.1">event loop:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.359.1">
population, _ = </span><strong class="bold1"><span class="kobospan1" id="kobo.360.1">await</span></strong> <strong class="bold1"><span class="kobospan1" id="kobo.361.1">elitism_async.eaSimpleWithElitism</span></strong><span class="kobospan1" id="kobo.362.1">(
    population, toolbox, cxpb=P_CROSSOVER, mutpb=P_MUTATION, 
    ngen=MAX_GENERATIONS, stats=stats, 
    halloffame=hof, verbose=True)</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.363.1">The call to the </span><strong class="source-inline1"><span class="kobospan" id="kobo.364.1">main()</span></strong><span class="kobospan" id="kobo.365.1"> function is made using </span><strong class="source-inline1"><span class="kobospan" id="kobo.366.1">asyncio.run()</span></strong><span class="kobospan" id="kobo.367.1">. </span><span class="kobospan" id="kobo.367.2">This method of invocation is used to designate the main entry point for running the asynchronous program. </span><span class="kobospan" id="kobo.367.3">It initiates and manages the </span><strong class="source-inline1"><span class="kobospan" id="kobo.368.1">asyncio</span></strong><span class="kobospan" id="kobo.369.1"> event loop, thereby allowing asynchronous tasks to be scheduled </span><span><span class="kobospan" id="kobo.370.1">and executed:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.371.1">asyncio.run</span></strong><span class="kobospan1" id="kobo.372.1">(main())</span></pre></li> </ol>
<h4 class="calibre19"><span class="kobospan" id="kobo.373.1">Updating the genetic algorithm loop</span></h4>
<p class="calibre3"><span class="kobospan" id="kobo.374.1">The counterpart </span><a id="_idIndexMarker862" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.375.1">program, </span><strong class="source-inline"><span class="kobospan" id="kobo.376.1">elitism_async.py</span></strong><span class="kobospan" id="kobo.377.1">, can be </span><span><span class="kobospan" id="kobo.378.1">found here:</span></span></p>
<p class="calibre3"><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/elitism_async.py" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.379.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/elitism_async.py</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.380.1">As previously mentioned, this program is a modified version of the familiar </span><strong class="source-inline"><span class="kobospan" id="kobo.381.1">elitism.py</span></strong><span class="kobospan" id="kobo.382.1">, tailored to execute the genetic algorithm’s main loop asynchronously and manage the asynchronous calls to the fitness function. </span><span class="kobospan" id="kobo.382.2">The key modifications are </span><span><span class="kobospan" id="kobo.383.1">highlighted here:</span></span></p>
<ol class="calibre15">
<li class="calibre11"><span class="kobospan" id="kobo.384.1">First, an </span><strong class="source-inline1"><span class="kobospan" id="kobo.385.1">aiohttp.TCPConnector</span></strong><span class="kobospan" id="kobo.386.1"> object is created before the loop starts. </span><span class="kobospan" id="kobo.386.2">This object is in charge of creating and managing TCP connections for sending HTTP requests. </span><span class="kobospan" id="kobo.386.3">The </span><strong class="source-inline1"><span class="kobospan" id="kobo.387.1">limit</span></strong><span class="kobospan" id="kobo.388.1"> parameter is used here to control the number of simultaneous </span><a id="_idIndexMarker863" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.389.1">connections to </span><span><span class="kobospan" id="kobo.390.1">the server:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.391.1">
connector = aiohttp.</span><strong class="bold1"><span class="kobospan1" id="kobo.392.1">TCPConnector</span></strong><span class="kobospan1" id="kobo.393.1">(limit=100)</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.394.1">Next, an </span><strong class="source-inline1"><span class="kobospan" id="kobo.395.1">aiohttp.ClientSession</span></strong><span class="kobospan" id="kobo.396.1"> object is created. </span><span class="kobospan" id="kobo.396.2">This session, which facilitates the sending of HTTP requests asynchronously, is used throughout the rest of the code. </span><span class="kobospan" id="kobo.396.3">It’s also passed to the </span><strong class="source-inline1"><span class="kobospan" id="kobo.397.1">async_oneMaxFitness_client()</span></strong><span class="kobospan" id="kobo.398.1"> function where it is used to transmit requests to the server. </span><span class="kobospan" id="kobo.398.2">The session remains active throughout the loop, enabling responses to be matched with their respective requests as </span><span><span class="kobospan" id="kobo.399.1">they arrive:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.400.1">async</span></strong><span class="kobospan1" id="kobo.401.1"> with </span><strong class="bold1"><span class="kobospan1" id="kobo.402.1">aiohttp.ClientSession</span></strong><span class="kobospan1" id="kobo.403.1">(connector=connector) as </span><strong class="bold1"><span class="kobospan1" id="kobo.404.1">session</span></strong><span class="kobospan1" id="kobo.405.1">:</span></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.406.1">The original calls to the fitness evaluation function, implemented using the </span><strong class="source-inline1"><span class="kobospan" id="kobo.407.1">map()</span></strong><span class="kobospan" id="kobo.408.1"> function to apply the </span><strong class="source-inline1"><span class="kobospan" id="kobo.409.1">evaluate</span></strong><span class="kobospan" id="kobo.410.1"> operation to all individuals needing updated fitness values (</span><strong class="source-inline1"><span class="kobospan" id="kobo.411.1">invalid_ind</span></strong><span class="kobospan" id="kobo.412.1">), are now replaced with the following two lines of code. </span><span class="kobospan" id="kobo.412.2">These lines create a list of </span><strong class="source-inline1"><span class="kobospan" id="kobo.413.1">Task</span></strong><span class="kobospan" id="kobo.414.1"> objects named </span><strong class="source-inline1"><span class="kobospan" id="kobo.415.1">evaluation_tasks</span></strong><span class="kobospan" id="kobo.416.1">, representing scheduled calls to the asynchronous fitness function, and then wait for all of them </span><span><span class="kobospan" id="kobo.417.1">to complete:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.418.1">evaluation_tasks</span></strong><span class="kobospan1" id="kobo.419.1"> = [asyncio.ensure_future(
    toolbox.</span><strong class="bold1"><span class="kobospan1" id="kobo.420.1">evaluate</span></strong><span class="kobospan1" id="kobo.421.1">(session, ind)) for ind in invalid_ind]
fitnesses = await asyncio.gather(*</span><strong class="bold1"><span class="kobospan1" id="kobo.422.1">evaluation_tasks</span></strong><span class="kobospan1" id="kobo.423.1">)</span></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.424.1">We are now ready to use the new asynchronous client, as will be </span><span><span class="kobospan" id="kobo.425.1">described next.</span></span></p>
<h2 id="_idParaDest-299" class="calibre7"><a id="_idTextAnchor351" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.426.1">Running the asynchronous client</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.427.1">First, ensure that the</span><a id="_idIndexMarker864" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.428.1"> Flask server is operational. </span><span class="kobospan" id="kobo.428.2">If it’s not already running, you can start it using the </span><span><span class="kobospan" id="kobo.429.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.430.1">
flask --app fitness_evaluator run</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.431.1">Next, let’s launch the </span><strong class="source-inline"><span class="kobospan" id="kobo.432.1">02_one_max_async_client.py</span></strong><span class="kobospan" id="kobo.433.1"> program and observe the outputs both from the server and the </span><span><span class="kobospan" id="kobo.434.1">client windows.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.435.1">In contrast to the previous experiment, it’s now evident that the requests are reaching the server several at a time and are being handled concurrently. </span><span class="kobospan" id="kobo.435.2">On the client side, while the output appears similar to the previous run, the runtime is significantly improved—more than 10 </span><span><span class="kobospan" id="kobo.436.1">times faster:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.437.1">
gen     nevals  max     avg
0       20      7       4.35
1       14      7       6.1
2       16      9       6.85
3       16      9       7.6
4       16      9       8.45
5       13      10      8.9
Best Individual =  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Elapsed time = </span><strong class="bold1"><span class="kobospan1" id="kobo.438.1">25.61 seconds</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.439.1">Now that we have learned how to utilize a client-server model for the OneMax problem, we’ll learn how to use a production app server to host </span><span><span class="kobospan" id="kobo.440.1">the models.</span></span></p>
<h1 id="_idParaDest-300" class="calibre5"><a id="_idTextAnchor352" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.441.1">Using a production-grade app server</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.442.1">As we have mentioned </span><a id="_idIndexMarker865" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.443.1">before, the built-in server that comes with Flask is not optimized for performance and is intended primarily for development purposes. </span><span class="kobospan" id="kobo.443.2">While it appears to perform adequately in our asynchronous experiment, when transitioning an application to a production environment, it’s strongly recommended to use a</span><a id="_idIndexMarker866" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.444.1"> production-grade </span><strong class="bold"><span class="kobospan" id="kobo.445.1">Web Server Gateway Interface</span></strong><span class="kobospan" id="kobo.446.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.447.1">WSGI</span></strong><span class="kobospan" id="kobo.448.1">) server. </span><span class="kobospan" id="kobo.448.2">WSGI is a specification in Python that provides a universal interface between web servers and web applications or frameworks. </span><span class="kobospan" id="kobo.448.3">Several robust options are available, including Gunicorn, uWSGI, and Apache with </span><strong class="source-inline"><span class="kobospan" id="kobo.449.1">mod_wsgi</span></strong><span class="kobospan" id="kobo.450.1">. </span><span class="kobospan" id="kobo.450.2">These servers are designed to meet the demands of a production environment, offering enhanced performance, security, stability, and </span><a id="_idIndexMarker867" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.451.1">scalability. </span><span class="kobospan" id="kobo.451.2">As we will demonstrate next, migrating to one of these servers is a relatively </span><span><span class="kobospan" id="kobo.452.1">easy task.</span></span></p>
<h2 id="_idParaDest-301" class="calibre7"><a id="_idTextAnchor353" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.453.1">Using the Gunicorn server</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.454.1">The first server option we will </span><a id="_idIndexMarker868" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.455.1">explore is </span><strong class="bold"><span class="kobospan" id="kobo.456.1">Gunicorn</span></strong><span class="kobospan" id="kobo.457.1">, short for </span><strong class="bold"><span class="kobospan" id="kobo.458.1">Green unicorn</span></strong><span class="kobospan" id="kobo.459.1">. </span><span class="kobospan" id="kobo.459.2">It is a widely used Python WSGI HTTP server for Unix systems, known for its simplicity and efficiency, making it a popular</span><a id="_idIndexMarker869" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.460.1"> choice for deploying Python </span><span><span class="kobospan" id="kobo.461.1">web applications.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.462.1">Although Gunicorn is not natively supported on Windows, it can be used via the </span><strong class="bold"><span class="kobospan" id="kobo.463.1">Windows Subsystem for Linux</span></strong><span class="kobospan" id="kobo.464.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.465.1">WSL</span></strong><span class="kobospan" id="kobo.466.1">), which is </span><a id="_idIndexMarker870" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.467.1">supported by Windows 10 and later versions. </span><span class="kobospan" id="kobo.467.2">WSL allows you to run a GNU/Linux environment directly on Windows, unmodified, without the overhead of a traditional virtual machine or dual-boot setup. </span><span class="kobospan" id="kobo.467.3">Gunicorn can be installed and run within this </span><span><span class="kobospan" id="kobo.468.1">Linux environment.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.469.1">To install Gunicorn, make sure you are within the server’s virtual environment, and use the </span><span><span class="kobospan" id="kobo.470.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.471.1">
pip install gunicorn</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.472.1">Then, launch the server with the </span><span><span class="kobospan" id="kobo.473.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.474.1">
gunicorn -b 127.0.0.1:5000 --workers 20 fitness_evaluator:app</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.475.1">The </span><strong class="source-inline"><span class="kobospan" id="kobo.476.1">-b</span></strong><span class="kobospan" id="kobo.477.1"> parameter, which is optional, is used here to run the server on the local URL </span><strong class="source-inline"><span class="kobospan" id="kobo.478.1">127.0.0.1:5000</span></strong><span class="kobospan" id="kobo.479.1">, aligning with the original Flask server configuration. </span><span class="kobospan" id="kobo.479.2">By default, Gunicorn runs on </span><span><span class="kobospan" id="kobo.480.1">port </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.481.1">8000</span></strong></span><span><span class="kobospan" id="kobo.482.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.483.1">The </span><strong class="source-inline"><span class="kobospan" id="kobo.484.1">--workers</span></strong><span class="kobospan" id="kobo.485.1"> argument specifies the number of worker processes. </span><span class="kobospan" id="kobo.485.2">In the absence of this argument, Gunicorn defaults to using a single </span><span><span class="kobospan" id="kobo.486.1">worker process.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.487.1">Once the Gunicorn server is</span><a id="_idIndexMarker871" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.488.1"> up, running the client yields the </span><span><span class="kobospan" id="kobo.489.1">following output:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.490.1">
gen     nevals  max     avg
0       20      7       4.35
1       14      7       6.1
2       16      9       6.85
3       16      9       7.6
4       16      9       8.45
5       13      10      8.9
Best Individual =  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Elapsed time = </span><strong class="bold1"><span class="kobospan1" id="kobo.491.1">18.71 seconds</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.492.1">Recall that the best theoretical result we can achieve in this experiment is 18 seconds, as we have 6 “rounds” of fitness calculation, and the best possible result for each round is 3 seconds, the duration of a single fitness evaluation. </span><span class="kobospan" id="kobo.492.2">The result we obtained here is impressively close to that </span><span><span class="kobospan" id="kobo.493.1">theoretical limit.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.494.1">In case you would like to use a server native to Windows, we will cover the Waitress server in the </span><span><span class="kobospan" id="kobo.495.1">next subsection.</span></span></p>
<h2 id="_idParaDest-302" class="calibre7"><a id="_idTextAnchor354" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.496.1">Using the Waitress server</span></h2>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.497.1">Waitress</span></strong><span class="kobospan" id="kobo.498.1"> is a production-quality </span><a id="_idIndexMarker872" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.499.1">pure-Python WSGI server. </span><span class="kobospan" id="kobo.499.2">It’s a cross-platform server compatible with various </span><a id="_idIndexMarker873" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.500.1">operating systems, including Unix, Windows, </span><span><span class="kobospan" id="kobo.501.1">and macOS.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.502.1">Waitress is often used as an alternative to Gunicorn, especially in environments where Gunicorn is not available or preferred, such as Windows, or when a pure-Python solution </span><span><span class="kobospan" id="kobo.503.1">is desired.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.504.1">To install Waitress, make sure </span><a id="_idIndexMarker874" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.505.1">you are within the server’s virtual environment, and use the </span><span><span class="kobospan" id="kobo.506.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.507.1">
pip install waitress</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.508.1">Next, we need to make a </span><a id="_idIndexMarker875" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.509.1">couple of modifications to our Flask application. </span><span class="kobospan" id="kobo.509.2">The modified program, </span><strong class="source-inline"><span class="kobospan" id="kobo.510.1">fitness_evaluator_waitress.py</span></strong><span class="kobospan" id="kobo.511.1">, can be </span><span><span class="kobospan" id="kobo.512.1">found here:</span></span></p>
<p class="calibre3"><a href="https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/server/fitness_evaluator_waitress.py" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.513.1">https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_14/server/fitness_evaluator_waitress.py</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.514.1">The differences from the original program, </span><strong class="source-inline"><span class="kobospan" id="kobo.515.1">fitness_evaluator.py</span></strong><span class="kobospan" id="kobo.516.1">, are </span><span><span class="kobospan" id="kobo.517.1">highlighted here:</span></span></p>
<ol class="calibre15">
<li class="calibre11"><span class="kobospan" id="kobo.518.1">First, we import the </span><strong class="source-inline1"><span class="kobospan" id="kobo.519.1">serve</span></strong><span class="kobospan" id="kobo.520.1"> function from the </span><span><span class="kobospan" id="kobo.521.1">Waitress module:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.522.1">
from waitress import </span><strong class="bold1"><span class="kobospan1" id="kobo.523.1">serve</span></strong></pre></li> <li class="calibre11"><span class="kobospan" id="kobo.524.1">Then, we use the </span><strong class="source-inline1"><span class="kobospan" id="kobo.525.1">serve()</span></strong><span class="kobospan" id="kobo.526.1"> function to launch the server from within the program. </span><span class="kobospan" id="kobo.526.2">This function allows us to specify the server’s configuration through its arguments. </span><span class="kobospan" id="kobo.526.3">In our case, we’re setting the host, port, and the number of threads to </span><span><span class="kobospan" id="kobo.527.1">handle requests:</span></span><pre class="source-code"><span class="kobospan1" id="kobo.528.1">
if __name__ == "__main__":
    </span><strong class="bold1"><span class="kobospan1" id="kobo.529.1">serve</span></strong><span class="kobospan1" id="kobo.530.1">(app, host='0.0.0.0', port=5000, threads=20)</span></pre></li> </ol>
<p class="calibre3"><span class="kobospan" id="kobo.531.1">The server can be started by running the following </span><span><span class="kobospan" id="kobo.532.1">program: </span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.533.1">fitness_evaluator_waitress.py</span></strong></span><span><span class="kobospan" id="kobo.534.1">.</span></span></p>
<h2 id="_idParaDest-303" class="calibre7"><a id="_idTextAnchor355" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.535.1">Breaking out of the box</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.536.1">The next logical step would be to deploy the server component of your application to a separate platform. </span><span class="kobospan" id="kobo.536.2">Doing so offers</span><a id="_idIndexMarker876" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.537.1"> several key advantages, including scalability, enhanced performance, and improved reliability. </span><span class="kobospan" id="kobo.537.2">While deploying your server on-premises using your own hardware is an option, leveraging </span><strong class="bold"><span class="kobospan" id="kobo.538.1">cloud computing services</span></strong><span class="kobospan" id="kobo.539.1"> often </span><a id="_idIndexMarker877" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.540.1">provides a more efficient and effective solution. </span><span class="kobospan" id="kobo.540.2">We will cover this in more detail in the </span><span><span class="kobospan" id="kobo.541.1">next section.</span></span></p>
<h1 id="_idParaDest-304" class="calibre5"><a id="_idTextAnchor356" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.542.1">Reaching for the sky with cloud computing</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.543.1">Cloud computing services provide</span><a id="_idIndexMarker878" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.544.1"> businesses and individuals with on-demand access to a wide range of applications, storage solutions, and computing power over the internet. </span><span class="kobospan" id="kobo.544.2">These services eliminate the need for substantial upfront investment in physical infrastructure, allowing users to pay only for the resources they use. </span><span class="kobospan" id="kobo.544.3">Cloud computing supports an extensive array of applications, ranging from data storage and web hosting to advanced analytics and artificial intelligence, revolutionizing how organizations manage and deploy </span><span><span class="kobospan" id="kobo.545.1">IT solutions.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.546.1">Additional advantages of cloud platforms include high-level security measures, data redundancy, and global reach, ensuring low latency for users worldwide. </span><span class="kobospan" id="kobo.546.2">Moreover, cloud services reduce the need for upfront capital investment in hardware and minimize the burden of ongoing maintenance and upgrades. </span><span class="kobospan" id="kobo.546.3">This approach enables a greater focus on application development rather than </span><span><span class="kobospan" id="kobo.547.1">infrastructure management.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.548.1">When considering the deployment of our Flask-based server component on a cloud platform, it’s important to note that most major cloud service providers offer straightforward methods to deploy Flask applications. </span><span class="kobospan" id="kobo.548.2">For example, a Flask application can be easily deployed to </span><strong class="bold"><span class="kobospan" id="kobo.549.1">Azure App Service</span></strong><span class="kobospan" id="kobo.550.1">, a fully </span><a id="_idIndexMarker879" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.551.1">managed platform for hosting web applications provided by Microsoft’s Azure cloud computing service. </span><span class="kobospan" id="kobo.551.2">This platform simplifies much of the deployment and management process, making it a convenient choice for Flask deployments. </span><span class="kobospan" id="kobo.551.3">Detailed instructions and guidelines for deploying a Flask application to Azure App Service can be found at </span><span><span class="kobospan" id="kobo.552.1">this link:</span></span></p>
<p class="calibre3"><a href="https://learn.microsoft.com/en-us/azure/app-service/quickstart-python" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.553.1">https://learn.microsoft.com/en-us/azure/app-service/quickstart-python</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.554.1">Several other options are </span><a id="_idIndexMarker880" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.555.1">available from </span><strong class="bold"><span class="kobospan" id="kobo.556.1">Amazon Web Services</span></strong><span class="kobospan" id="kobo.557.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.558.1">AWS</span></strong><span class="kobospan" id="kobo.559.1">). </span><span class="kobospan" id="kobo.559.2">You can use </span><strong class="bold"><span class="kobospan" id="kobo.560.1">Amazon EC2</span></strong><span class="kobospan" id="kobo.561.1"> for comprehensive </span><a id="_idIndexMarker881" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.562.1">control over virtual servers, or opt for </span><strong class="bold"><span class="kobospan" id="kobo.563.1">AWS Fargate</span></strong><span class="kobospan" id="kobo.564.1"> if you </span><a id="_idIndexMarker882" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.565.1">prefer a container-based compute service that doesn’t require managing underlying servers. </span><span class="kobospan" id="kobo.565.2">A more straightforward approach is </span><a id="_idIndexMarker883" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.566.1">using </span><strong class="bold"><span class="kobospan" id="kobo.567.1">AWS Elastic Beanstalk</span></strong><span class="kobospan" id="kobo.568.1">, a user-friendly service for deploying and scaling web applications. </span><span class="kobospan" id="kobo.568.2">Elastic Beanstalk automates various deployment details such as capacity provisioning, load balancing, auto-scaling, and</span><a id="_idIndexMarker884" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.569.1"> application health monitoring. </span><span class="kobospan" id="kobo.569.2">Deploying an existing Flask application to Elastic Beanstalk</span><a id="_idIndexMarker885" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.570.1"> using the AWS </span><strong class="bold"><span class="kobospan" id="kobo.571.1">Command-Line Interface</span></strong><span class="kobospan" id="kobo.572.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.573.1">CLI</span></strong><span class="kobospan" id="kobo.574.1">) is straightforward, as </span><span><span class="kobospan" id="kobo.575.1">described here:</span></span></p>
<p class="calibre3"><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-flask.html" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.576.1">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-flask.html</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.577.1">In the rest of this chapter, however, our focus shifts to a fourth option—</span><strong class="bold"><span class="kobospan" id="kobo.578.1">AWS Lambda</span></strong><span class="kobospan" id="kobo.579.1">. </span><span class="kobospan" id="kobo.579.2">AWS Lambda represents a paradigm shift in application deployment and management. </span><span class="kobospan" id="kobo.579.3">As a serverless computing service, it </span><a id="_idIndexMarker886" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.580.1">allows the execution of code without the need for provisioning or managing servers, automatically scaling in response to incoming requests. </span><span class="kobospan" id="kobo.580.2">This serverless approach offers a distinct set of benefits for deploying </span><span><span class="kobospan" id="kobo.581.1">Flask applications.</span></span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.582.1">Important – limitations of Lambda</span></p>
<p class="callout"><span class="kobospan" id="kobo.583.1">Before proceeding, it’s essential to remember that the AWS Lambda service, while powerful and versatile, does have certain limitations and restrictions. </span><span class="kobospan" id="kobo.583.2">The most significant of these is the </span><a id="_idIndexMarker887" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.584.1">maximum execution time limit per function invocation, currently set at 15 minutes. </span><span class="kobospan" id="kobo.584.2">This means that for a genetic algorithm where a single evaluation of the fitness function is expected to exceed this duration, the method we describe next will not be suitable, and one of the aforementioned alternative approaches, such as AWS Elastic Beanstalk, should </span><span><span class="kobospan" id="kobo.585.1">be considered.</span></span></p>
<p class="callout"><span class="kobospan" id="kobo.586.1">Other limitations of Lambda include constraints on memory and compute resources, deployment package size, and the number of concurrent executions, as </span><span><span class="kobospan" id="kobo.587.1">described here:</span></span></p>
<p class="callout"><a href="https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.588.1">https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html</span></span></a><span><span class="kobospan" id="kobo.589.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.590.1">Despite the aforementioned </span><a id="_idIndexMarker888" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.591.1">limitations, AWS Lambda remains a viable option for numerous problems tackled by genetic algorithms. </span><span class="kobospan" id="kobo.591.2">In many cases, the duration required to complete a single evaluation of the fitness function falls well within the 15-minute execution time limit imposed by Lambda. </span><span class="kobospan" id="kobo.591.3">Additionally, the resources provided by the Lambda service are often more than adequate for these applications. </span><span class="kobospan" id="kobo.591.4">This compatibility makes AWS Lambda an attractive choice for executing genetic algorithms efficiently, which we will explore in the </span><span><span class="kobospan" id="kobo.592.1">following sections.</span></span></p>
<h2 id="_idParaDest-305" class="calibre7"><a id="_idTextAnchor357" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.593.1">AWS Lambda and API Gateway – a winning combination</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.594.1">AWS Lambda is a serverless </span><a id="_idIndexMarker889" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.595.1">computing service offered by AWS, enabling the execution of code without the need for server provisioning or management. </span><span class="kobospan" id="kobo.595.2">As a prime example of </span><strong class="bold"><span class="kobospan" id="kobo.596.1">Function-as-a-Service</span></strong><span class="kobospan" id="kobo.597.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.598.1">FaaS</span></strong><span class="kobospan" id="kobo.599.1">), a cloud </span><a id="_idIndexMarker890" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.600.1">computing model, Lambda empowers developers to write and update code executed in response to specific events. </span><span class="kobospan" id="kobo.600.2">In this model, the underlying physical hardware, server operating system maintenance, automatic scaling, and capacity provisioning are all managed by the platform, allowing developers to concentrate on individual functions in their application code. </span><span class="kobospan" id="kobo.600.3">Lambda’s automatic scaling adjusts the compute capacity for each trigger, ensuring </span><span><span class="kobospan" id="kobo.601.1">high availability.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.602.1">The cost-effectiveness of using AWS Lambda</span><a id="_idIndexMarker891" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.603.1"> lies in its billing structure, which charges only for the actual compute time used, with no costs incurred when the code is not running. </span><span class="kobospan" id="kobo.603.2">Moreover, Lambda’s seamless integration with other AWS services makes it an invaluable tool for developing complex applications. </span><span class="kobospan" id="kobo.603.3">A key integration is with </span><strong class="bold"><span class="kobospan" id="kobo.604.1">AWS API Gateway</span></strong><span class="kobospan" id="kobo.605.1">, a fully managed service that serves as</span><a id="_idIndexMarker892" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.606.1"> a “front door” for applications, effectively enabling API Gateway to trigger Lambda functions in response to HTTP requests. </span><span class="kobospan" id="kobo.606.2">This integration facilitates the creation of serverless architectures, where</span><a id="_idIndexMarker893" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.607.1"> Lambda functions are invoked via API calls through </span><span><span class="kobospan" id="kobo.608.1">API Gateway.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.609.1">This powerful combination</span><a id="_idIndexMarker894" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.610.1"> allows us to deploy our existing Flask application to the AWS cloud, leveraging both the API Gateway and Lambda service. </span><span class="kobospan" id="kobo.610.2">What’s more, thanks to the Zappa framework, which will be described in the next section, we can deploy our Flask application without any modifications, fully utilizing the benefits of </span><span><span class="kobospan" id="kobo.611.1">serverless architecture.</span></span></p>
<h2 id="_idParaDest-306" class="calibre7"><a id="_idTextAnchor358" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.612.1">Serverless Python with Zappa</span></h2>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.613.1">Zappa</span></strong><span class="kobospan" id="kobo.614.1"> is an open source framework that simplifies the deployment of Python web applications on AWS Lambda. </span><span class="kobospan" id="kobo.614.2">It’s particularly</span><a id="_idIndexMarker895" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.615.1"> well-suited for Flask (as well as Django—another Python web framework) applications. </span><span class="kobospan" id="kobo.615.2">Zappa handles all of the setup and configuration required to run a web application on Lambda, turning it into a serverless application. </span><span class="kobospan" id="kobo.615.3">This includes packaging the application, setting up the necessary AWS configurations, and deploying it </span><span><span class="kobospan" id="kobo.616.1">to Lambda.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.617.1">In addition, Zappa provides features such as database migrations, scheduling of function executions, and integration with various AWS services, making it a comprehensive tool for deploying Python web applications on </span><span><span class="kobospan" id="kobo.618.1">AWS Lambda.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.619.1">To install Zappa, make sure you are within the server’s virtual environment, and use the </span><span><span class="kobospan" id="kobo.620.1">following command:</span></span></p>
<pre class="console"><span class="kobospan1" id="kobo.621.1">
pip install zappa</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.622.1">Before proceeding further, it’s important to have a working AWS account, as described in the </span><span><span class="kobospan" id="kobo.623.1">next subsection.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.624.1">Setting up an AWS account</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.625.1">To be able to deploy our server to the AWS cloud, you need a valid AWS account. </span><span class="kobospan" id="kobo.625.2">The </span><strong class="bold"><span class="kobospan" id="kobo.626.1">AWS Free Tier</span></strong><span class="kobospan" id="kobo.627.1">, available to new AWS </span><a id="_idIndexMarker896" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.628.1">customers, allows you to explore and use AWS services for free within certain </span><span><span class="kobospan" id="kobo.629.1">usage limits.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.630.1">If you don’t currently have an AWS account, you can sign up for a free </span><span><span class="kobospan" id="kobo.631.1">account here:</span></span></p>
<p class="calibre3"><a href="https://aws.amazon.com/free/" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.632.1">https://aws.amazon.com/free/</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.633.1">Next, install the AWS CLI by following the</span><a id="_idIndexMarker897" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.634.1"> instructions </span><span><span class="kobospan" id="kobo.635.1">available here:</span></span></p>
<p class="calibre3"><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.636.1">https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.637.1">You will also need to set up your AWS credentials file, as </span><span><span class="kobospan" id="kobo.638.1">described here:</span></span></p>
<p class="calibre3"><a href="https://wellarchitectedlabs.com/common/documentation/aws_credentials/" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.639.1">https://wellarchitectedlabs.com/common/documentation/aws_credentials/</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.640.1">These will be used by Zappa behind the scenes as we continue to deploy </span><span><span class="kobospan" id="kobo.641.1">our service.</span></span></p>
<h2 id="_idParaDest-307" class="calibre7"><a id="_idTextAnchor359" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.642.1">Deploying the server module to the Lambda service</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.643.1">It’s time to deploy our Flask application to </span><a id="_idIndexMarker898" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.644.1">AWS using Zappa. </span><span class="kobospan" id="kobo.644.2">Navigate into the server directory, make sure the server virtual environment is active, and issue the </span><span><span class="kobospan" id="kobo.645.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.646.1">
zappa init</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.647.1">This will start an interactive dialog. </span><span class="kobospan" id="kobo.647.2">Zappa will prompt you for various details such as the production environment name (with </span><strong class="source-inline"><span class="kobospan" id="kobo.648.1">dev</span></strong><span class="kobospan" id="kobo.649.1"> as the default), a unique S3 bucket name for storing files (it suggests a unique name for you), and the name of your application (which should be set to </span><strong class="source-inline"><span class="kobospan" id="kobo.650.1">fitness_evaluator.app</span></strong><span class="kobospan" id="kobo.651.1"> in your case). </span><span class="kobospan" id="kobo.651.2">It will also ask about the global deployment option, with </span><strong class="source-inline"><span class="kobospan" id="kobo.652.1">n</span></strong><span class="kobospan" id="kobo.653.1"> as the default choice. </span><span class="kobospan" id="kobo.653.2">You can typically accept all the default values provided by Zappa during this </span><span><span class="kobospan" id="kobo.654.1">setup process.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.655.1">The outcome of this initialization process is a file named </span><strong class="source-inline"><span class="kobospan" id="kobo.656.1">zappa_settings.json</span></strong><span class="kobospan" id="kobo.657.1">. </span><span class="kobospan" id="kobo.657.2">This file contains the deployment configuration for your application. </span><span class="kobospan" id="kobo.657.3">If necessary, you can manually edit this file to modify the configuration or add </span><span><span class="kobospan" id="kobo.658.1">additional options.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.659.1">We are now ready to deploy our application. </span><span class="kobospan" id="kobo.659.2">If you chose </span><strong class="source-inline"><span class="kobospan" id="kobo.660.1">dev</span></strong><span class="kobospan" id="kobo.661.1"> as the name for your production environment during the Zappa configuration, use the </span><span><span class="kobospan" id="kobo.662.1">following command:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.663.1">
zappa deploy dev</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.664.1">The deployment process may take a few minutes. </span><span class="kobospan" id="kobo.664.2">Once it’s complete, you will see a message indicating </span><strong class="source-inline"><span class="kobospan" id="kobo.665.1">Deployment complete!</span></strong><span class="kobospan" id="kobo.666.1"> along with a URL. </span><em class="italic"><span class="kobospan" id="kobo.667.1">This URL serves as the base URL for your newly </span></em><span><em class="italic"><span class="kobospan" id="kobo.668.1">deployed application</span></em></span><span><span class="kobospan" id="kobo.669.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.670.1">We can now manually test the deployment by pointing a browser to the new URL. </span><span class="kobospan" id="kobo.670.2">The response </span><strong class="bold"><span class="kobospan" id="kobo.671.1">Welcome to our Fitness Evaluation Server!</span></strong><span class="kobospan" id="kobo.672.1"> should be displayed on the browser’s screen. </span><span class="kobospan" id="kobo.672.2">Next, we can also test the fitness evaluation endpoint, by adding </span><strong class="source-inline"><span class="kobospan" id="kobo.673.1">/one_max_fitness/1100110010</span></strong><span class="kobospan" id="kobo.674.1"> to the base URL. </span><span class="kobospan" id="kobo.674.2">The response, </span><strong class="source-inline"><span class="kobospan" id="kobo.675.1">5</span></strong><span class="kobospan" id="kobo.676.1">, should be displayed after a </span><span><span class="kobospan" id="kobo.677.1">few seconds.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.678.1">Before we continue to use our async client module with the newly deployed server, we can log in to the AWS console to review what has been deployed. </span><span class="kobospan" id="kobo.678.2">This step is optional—if you’re already familiar with the AWS console, feel free to skip to the </span><span><span class="kobospan" id="kobo.679.1">following section.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.680.1">Examining the deployment on AWS</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.681.1">To review the main components</span><a id="_idIndexMarker899" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.682.1"> deployed by Zappa, start by logging in to the AWS console </span><span><span class="kobospan" id="kobo.683.1">at </span></span><a href="https://aws.amazon.com/console/" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.684.1">https://aws.amazon.com/console/</span></span></a><span><span class="kobospan" id="kobo.685.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.686.1">Once logged in, navigate to the Lambda service, where you can view the list of available Lambda functions. </span><span class="kobospan" id="kobo.686.2">You should see your newly deployed function listed there, similar to the following </span><span><span class="kobospan" id="kobo.687.1">screen capture:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer149">
<span class="kobospan" id="kobo.688.1"><img alt="Figure 14.4: The Lambda function created by the Zappa deployment" src="image/B20851_14_4.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.689.1">Figure 14.4: The Lambda function created by the Zappa deployment</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.690.1">In our case, the Lambda function created by Zappa is named </span><strong class="source-inline"><span class="kobospan" id="kobo.691.1">server-dev</span></strong><span class="kobospan" id="kobo.692.1">. </span><span class="kobospan" id="kobo.692.2">This name is derived from the combination of the directory name where the application resides (</span><strong class="source-inline"><span class="kobospan" id="kobo.693.1">server</span></strong><span class="kobospan" id="kobo.694.1">) and the production environment name we </span><span><span class="kobospan" id="kobo.695.1">chose (</span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.696.1">dev</span></strong></span><span><span class="kobospan" id="kobo.697.1">).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.698.1">Clicking on the function’s name</span><a id="_idIndexMarker900" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.699.1"> will bring us to the </span><strong class="bold"><span class="kobospan" id="kobo.700.1">Function overview</span></strong><span class="kobospan" id="kobo.701.1"> screen, where we can further explore detailed information, such as the function’s runtime environment, triggers, configuration settings, and monitoring metrics, as </span><span><span class="kobospan" id="kobo.702.1">seen here:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer150">
<span class="kobospan" id="kobo.703.1"><img alt="Figure 14.5: The Lambda Function overview screen" src="image/B20851_14_5.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.704.1">Figure 14.5: The Lambda Function overview screen</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.705.1">Next, let’s navigate to the API Gateway service, where you can view the list of available APIs. </span><span class="kobospan" id="kobo.705.2">You should see our</span><a id="_idIndexMarker901" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.706.1"> newly deployed API listed there, with the same name as the Lambda function, as </span><span><span class="kobospan" id="kobo.707.1">shown here:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer151">
<span class="kobospan" id="kobo.708.1"><img alt="Figure 14.6: The API created by the Zappa deployment" src="image/B20851_14_6.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.709.1">Figure 14.6: The API created by the Zappa deployment</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.710.1">Clicking on the API’s name will bring us to the </span><strong class="bold"><span class="kobospan" id="kobo.711.1">Resources</span></strong><span class="kobospan" id="kobo.712.1"> screen; then, selecting the </span><strong class="bold"><span class="kobospan" id="kobo.713.1">ANY</span></strong><span class="kobospan" id="kobo.714.1"> link will display a diagram that illustrates how the API Gateway routes incoming requests to your Lambda function and how responses are returned to the client, as shown in the following </span><span><span class="kobospan" id="kobo.715.1">screen capture:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer152">
<span class="kobospan" id="kobo.716.1"><img alt="Figure 14.7: The API Gateway Resources screen" src="image/B20851_14_7.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.717.1">Figure 14.7: The API Gateway Resources screen</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.718.1">When you click on the Lambda symbol on the right side, it will display the name of our Lambda function. </span><span class="kobospan" id="kobo.718.2">This </span><a id="_idIndexMarker902" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.719.1">includes a hyperlink, which, when clicked, will take us back to the page of our </span><span><span class="kobospan" id="kobo.720.1">Lambda function.</span></span></p>
<h2 id="_idParaDest-308" class="calibre7"><a id="_idTextAnchor360" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.721.1">Running the client with the Lambda-based server</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.722.1">To update our asynchronous client program, </span><strong class="source-inline"><span class="kobospan" id="kobo.723.1">02_one_max_async_client.py</span></strong><span class="kobospan" id="kobo.724.1">, for use with our newly deployed </span><a id="_idIndexMarker903" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.725.1">Lambda-based server, we only need to make a single change: replace the existing </span><strong class="source-inline"><span class="kobospan" id="kobo.726.1">BASE_URL</span></strong><span class="kobospan" id="kobo.727.1"> variable value with the new URL provided by the </span><span><span class="kobospan" id="kobo.728.1">Zappa deployment.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.729.1">Once this is done, running the client yields output similar to previous runs, demonstrating that the </span><a id="_idIndexMarker904" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.730.1">genetic algorithm operates the same way despite the change in </span><span><span class="kobospan" id="kobo.731.1">server infrastructure:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.732.1">
gen     nevals  max     avg
0       20      7       4.35
1       14      7       6.1
2       16      9       6.85
3       16      9       7.6
4       16      9       8.45
5       13      10      8.9
Best Individual =  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
Elapsed time = </span><strong class="bold1"><span class="kobospan1" id="kobo.733.1">19.54 seconds</span></strong></pre> <p class="calibre3"><span class="kobospan" id="kobo.734.1">Rerunning the client several times, the results indicate elapsed time values of between 19 and 21 seconds, which are reasonable considering the server is operating in a cloud environment with inherent network latency and serverless function </span><span><span class="kobospan" id="kobo.735.1">initialization times.</span></span></p>
<h2 id="_idParaDest-309" class="calibre7"><a id="_idTextAnchor361" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.736.1">Undeploying the server</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.737.1">Once we’re finished using the server deployed via Zappa, it’s a good practice to undeploy its infrastructure </span><a id="_idIndexMarker905" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.738.1">using the </span><strong class="source-inline"><span class="kobospan" id="kobo.739.1">zappa undeploy</span></strong><span class="kobospan" id="kobo.740.1"> command, initiated from within our server’s </span><span><span class="kobospan" id="kobo.741.1">virtual environment:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.742.1">
zappa undeploy dev</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.743.1">This action helps manage costs and resources efficiently by removing the deployed AWS resources that are no longer </span><span><span class="kobospan" id="kobo.744.1">in use.</span></span></p>
<h1 id="_idParaDest-310" class="calibre5"><a id="_idTextAnchor362" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.745.1">Summary</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.746.1">In this chapter, you learned how to restructure a genetic algorithm into a client-server model. </span><span class="kobospan" id="kobo.746.2">The client uses asynchronous I/O, while the server, built with Flask, handles fitness function calculations. </span><span class="kobospan" id="kobo.746.3">The server component was then successfully deployed to the cloud using Zappa, making it operational as an AWS Lambda service. </span><span class="kobospan" id="kobo.746.4">This approach demonstrates the effective use of serverless computing in enhancing the performance of </span><span><span class="kobospan" id="kobo.747.1">genetic algorithms.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.748.1">In the next chapter, we’ll explore how genetic algorithms can be creatively applied in the art world. </span><span class="kobospan" id="kobo.748.2">Specifically, we’ll learn how these algorithms can be used to reconstruct images of famous paintings using semi-transparent, overlapping shapes. </span><span class="kobospan" id="kobo.748.3">This approach not only offers a unique blend of art and technology but also provides an insightful look into the versatile applications of genetic algorithms in fields beyond </span><span><span class="kobospan" id="kobo.749.1">traditional computing.</span></span></p>
<h1 id="_idParaDest-311" class="calibre5"><a id="_idTextAnchor363" class="calibre6 pcalibre pcalibre1"/><span class="kobospan" id="kobo.750.1">Further reading</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.751.1">For more information on the topics that were covered in this chapter, please refer to the </span><span><span class="kobospan" id="kobo.752.1">following resources:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><em class="italic"><span class="kobospan" id="kobo.753.1">Building Web Applications with Flask</span></em><span class="kobospan" id="kobo.754.1"> by Italo Maia, </span><span><span class="kobospan" id="kobo.755.1">June 2015</span></span></li>
<li class="calibre11"><em class="italic"><span class="kobospan" id="kobo.756.1">Expert Python Programming: Master Python by learning the best coding practices and advanced programming concepts, 4th Edition</span></em><span class="kobospan" id="kobo.757.1"> by Michal Jaworski and Tarek Ziade, May 2021 (the </span><em class="italic"><span class="kobospan" id="kobo.758.1">Asynchronous </span></em><span><em class="italic"><span class="kobospan" id="kobo.759.1">programming</span></em></span><span><span class="kobospan" id="kobo.760.1"> chapter)</span></span></li>
<li class="calibre11"><em class="italic"><span class="kobospan" id="kobo.761.1">AWS Lambda Quick Start Guide: Learn how to build and deploy serverless applications on AWS</span></em><span class="kobospan" id="kobo.762.1"> by Markus Klems, </span><span><span class="kobospan" id="kobo.763.1">June 2018</span></span></li>
<li class="calibre11"><em class="italic"><span class="kobospan" id="kobo.764.1">Mastering AWS Lambda: Learn how to build and deploy serverless applications</span></em><span class="kobospan" id="kobo.765.1"> by Yohan Wadia and Udita Gupta,  </span><span><span class="kobospan" id="kobo.766.1">August 2017</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.767.1">Zappa </span><span><span class="kobospan" id="kobo.768.1">framework documentation:</span></span><p class="calibre3"><a href="https://github.com/zappa/Zappa" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.769.1">https://github.com/zappa/Zappa</span></span></a></p></li>
<li class="calibre11"><span class="kobospan" id="kobo.770.1">Python </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.771.1">asyncio</span></strong></span><span><span class="kobospan" id="kobo.772.1"> library:</span></span><p class="calibre3"><a href="https://docs.python.org/3/library/asyncio.html" class="calibre6 pcalibre pcalibre1"><span><span class="kobospan" id="kobo.773.1">https://docs.python.org/3/library/asyncio.html</span></span></a></p></li>
</ul>
</div>
</body></html>