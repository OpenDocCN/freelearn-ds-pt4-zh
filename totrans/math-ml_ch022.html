<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8"/>
  <meta name="generator" content="pandoc"/>
  <title>ch022.xhtml</title>
  <style>
  </style>
  <link rel="stylesheet" type="text/css" href="../styles/stylesheet1.css"/>
</head>
<body epub:type="bodymatter">
<section id="integration" class="level2 chapterHead">
<h1 class="chapterHead"><span class="titlemark"><span class="cmss-10x-x-109">14</span></span><br/>
<span id="x1-23100016"></span><span class="cmss-10x-x-109">Integration</span></h1>
<p><span class="cmss-10x-x-109">When we first encountered the concept of </span><span class="cmssi-10x-x-109">derivatives </span><span class="cmss-10x-x-109">in </span><span class="cmssi-10x-x-109">Chapter </span><a href="ch020.xhtml#differentiation"><span class="cmssi-10x-x-109">12</span></a><span class="cmss-10x-x-109">, we introduced it through an example from physics. As Newton created it, the derivative describes the velocity of a moving object as calculated from its time-distance graph. In other words, the velocity can be </span><span class="cmssi-10x-x-109">derived </span><span class="cmss-10x-x-109">from the time-distance information.</span></p>
<p><span class="cmss-10x-x-109">Can the distance be reconstructed given the velocity? In a sense, this is the inverse of differentiation.</span></p>
<p><span class="cmss-10x-x-109">Questions such as these are hard to answer if we only look at the most general case, so let’s consider a special one. Suppose that our object is moving with a constant velocity </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) = <span class="cmmi-10x-x-109">v</span><sub><span class="cmr-8">0</span></sub><img src="../media/file1312.png" class="math" data-align="middle" alt="ms-"/><span class="cmss-10x-x-109">, for a duration of </span><span class="cmmi-10x-x-109">T </span><span class="cmss-10x-x-109">seconds. With some elementary logic, we can conclude that the total distance traveled is </span><span class="cmmi-10x-x-109">v</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">T </span><span class="cmss-10x-x-109">meters.</span></p>
<p><span class="cmss-10x-x-109">When taking a look at the </span><span class="cmssi-10x-x-109">time-velocity </span><span class="cmss-10x-x-109">plot, we can immediately see that the distance is </span><span class="cmssi-10x-x-109">the area under the time-velocity </span><span class="cmss-10x-x-109">function graph </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) = <span class="cmmi-10x-x-109">v</span><sub><span class="cmr-8">0</span></sub><span class="cmss-10x-x-109">.</span></p>
<p><span class="cmss-10x-x-109">The graph of </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">describes a rectangle with width </span><span class="cmmi-10x-x-109">v</span><sub><span class="cmr-8">0</span></sub> <span class="cmss-10x-x-109">and length </span><span class="cmmi-10x-x-109">T</span><span class="cmss-10x-x-109">, hence its area is indeed </span><span class="cmmi-10x-x-109">v</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">T</span><span class="cmss-10x-x-109">.</span></p>
<div class="minipage">
<p><img src="../media/file1313.png" width="413" alt="PIC"/> <span id="x1-231001r1"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.1: Time-velocity plot of an object, moving with constant velocity</span> </span>
</div>
<p><span class="cmss-10x-x-109">Does the area under </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">equal the distance traveled in the general case? For instance, what happens when the time-velocity plot looks something like this?</span></p>
<div class="minipage">
<p><img src="../media/file1314.png" width="413" alt="PIC"/> <span id="x1-231002r2"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.2: Time-velocity plot of an object, moving with a changing velocity</span> </span>
</div>
<p><span class="cmss-10x-x-109">The speed is not constant here. In this case, we can do a simple trick: partition the time interval </span>[0<span class="cmmi-10x-x-109">,T</span>] <span class="cmss-10x-x-109">into smaller ones and approximate the object’s motion as a constant-speed motion on each of these intervals.</span></p>
<div class="minipage">
<p><img src="../media/file1315.png" width="427" alt="PIC"/> <span id="x1-231003r3"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.3: Approximating with a constant velocity motion</span> </span>
</div>
<p><span class="cmss-10x-x-109">If the time intervals</span> [<span class="cmmi-10x-x-109">t</span><sub><span class="cmmi-8">i</span></sub><span class="cmmi-10x-x-109">,t</span><sub><span class="cmmi-8">i</span><span class="cmr-8">+1</span></sub>] <span class="cmss-10x-x-109">are sufficiently granular, the distance traveled will roughly match a constant velocity motion with the average velocity at</span> [<span class="cmmi-10x-x-109">t</span><sub><span class="cmmi-8">i</span></sub><span class="cmmi-10x-x-109">,t</span><sub><span class="cmmi-8">i</span><span class="cmr-8">+1</span></sub>]<span class="cmss-10x-x-109">. That is, if we introduce the notation</span></p>

<img src="../media/file1316.png" class="math-display" alt="vi := average velocity during the time interval [ti−1,ti], i = 1,2,...,n," width="450"/>
<p><span class="cmss-10x-x-109">we should have</span></p>
<div class="math-display">
<img src="../media/file1317.png" class="math-display" alt="∑n vi(ti − ti−1) ≈ total distance traveled during [0,T]. i=1 "/>
</div>
<p><span class="cmss-10x-x-109">Let’s think about this whole process as approximating the function </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">with a stepwise constant function </span><span class="cmmi-10x-x-109">v</span><sub><span class="cmss-10x-x-109">approx</span></sub>(<span class="cmmi-10x-x-109">t</span>)<span class="cmss-10x-x-109">. From this angle, we have</span></p>
<div class="math-display">
<img src="../media/file1318.png" class="math-display" alt=" n ∑ vi(ti − ti−1) = area under vapprox(t), i=1 "/>
</div>
<p><span class="cmss-10x-x-109">and</span></p>
<div class="math-display">
<img src="../media/file1319.png" class="math-display" alt="area under vapprox(t) ≈ area under v(t). "/>
</div>
<p><span class="cmss-10x-x-109">(Very) loosely speaking, if the granularity of the time intervals</span> [<span class="cmmi-10x-x-109">t</span><sub><span class="cmmi-8">i</span></sub><span class="cmmi-10x-x-109">,t</span><sub><span class="cmmi-8">i</span><span class="cmr-8">+1</span></sub>] <span class="cmss-10x-x-109">gets infinitesimally small, the approximations turn into equality. Thus,</span></p>
<div class="math-disply">
<img src="../media/file1320.png" width="450" class="math-display" alt="total distance traveled during [0,T ] = area under v(t) in [0,T ]. "/>
</div>
<p><span class="cmss-10x-x-109">There are two key points that we need to remember: if </span><span class="cmmi-10x-x-109">s</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">is the </span><span class="cmssi-10x-x-109">distance </span><span class="cmss-10x-x-109">traveled and </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">is the velocity, then</span></p>
<ul>
<li><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">is the derivative </span><span class="cmmi-10x-x-109">s</span><sup><span class="cmsy-8">′</span></sup>(<span class="cmmi-10x-x-109">t</span>)<span class="cmss-10x-x-109">,</span></li>
<li><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">s</span>(<span class="cmmi-10x-x-109">T</span>) <span class="cmss-10x-x-109">is the area under the graph </span><span class="cmmi-10x-x-109">v</span>(<span class="cmmi-10x-x-109">t</span>) <span class="cmss-10x-x-109">between </span>0 <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">T</span><span class="cmss-10x-x-109">.</span></li>
</ul>
<p><span class="cmss-10x-x-109">In other words, calculating the area under the curve is the same as inverting differentiation. This</span> <span id="dx1-231004"></span><span class="cmss-10x-x-109">process is called </span><span class="cmssi-10x-x-109">integration</span><span class="cmss-10x-x-109">.</span></p>
<p><span class="cmss-10x-x-109">Unfortunately, things are not as simple as they seem. We missed a lot of mathematical detail in the above discussion. For one, does the sum</span></p>
<div class="math-dispay">
<img src="../media/file1321.png" width="150" class="math-display" alt="∑n vi(ti − ti−1) i=1 "/>
</div>
<p><span class="cmss-10x-x-109">converge if the partition of</span> [0<span class="cmmi-10x-x-109">,T</span>] <span class="cmss-10x-x-109">gets more granular? Does the limit depend on the partitions? Can we even define the area under the “graph” for all functions? Like the Dirichlet function, defined by</span></p>
<div style="display: flex; justify-content: space-between; align-items: center; max-width: 600px;" class="equation math-display">
  <div class="math-display">
    <img src="../media/equation_(20).png" alt="L(U,V ) = {f : U → V | f is linear}" width="150" />
  </div>
  <div style="padding-left: 1em; ">
    <!-- Label goes here, e.g. (4.2) -->(14.1)
  </div>
</div>

<p><span class="cmss-10x-x-109">How do we calculate limits of </span><span class="cmex-10x-x-109">∑</span> <sub><span class="cmmi-8">i</span><span class="cmr-8">=1</span></sub><sup><span class="cmmi-8">n</span></sup><span class="cmmi-10x-x-109">v</span><sub><span class="cmmi-8">i</span></sub>(<span class="cmmi-10x-x-109">t</span><sub><span class="cmmi-8">i</span></sub> <span class="cmsy-10x-x-109">−</span><span class="cmmi-10x-x-109">t</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub>) <span class="cmss-10x-x-109">in practice? In addition, what does all of this have to do with machine learning?</span></p>
<p><span class="cmss-10x-x-109">Fasten your seatbelts! Here comes the rigorous study of integration, clearing up all of these questions.</span></p>
<section id="integration-in-theory" class="level3 sectionHead">
<h2 class="sectionHead" id="sigil_toc_id_205"><span class="titlemark"><span class="cmss-10x-x-109">14.1 </span></span> <span id="x1-23200016.1"></span><span class="cmss-10x-x-109">Integration in theory</span></h2>
<p><span class="cmss-10x-x-109">Let’s build a solid theoretical foundation for the intuitive explanation! Let </span><span class="cmmi-10x-x-109">f </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmss-10x-x-109">be an arbitrary </span><span class="cmssi-10x-x-109">bounded </span><span class="cmss-10x-x-109">function, and our goal is to calculate the signed area</span><span id="dx1-232001"></span> <span class="cmss-10x-x-109">under the graph. (Note that the signed area is negative if the graph goes below the </span><span class="cmmi-10x-x-109">x </span><span class="cmss-10x-x-109">axis. In the time-speed graph example above, this is equivalent to moving backward, thus decreasing the distance traveled from the starting point.)</span></p>
<p><span class="cmss-10x-x-109">Let </span><span class="cmmi-10x-x-109">a </span>= <span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">…/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">n</span></sub> = <span class="cmmi-10x-x-109">b </span><span class="cmss-10x-x-109">an arbitrary partition of the interval</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmss-10x-x-109">.</span> </span></span></span></p>
<p><span class="cmss-10x-x-109">For notational convenience, we’ll denote this partition as </span><span class="cmmi-10x-x-109">X </span>= <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">,…,x</span><sub><span class="cmmi-8">n</span></sub><span class="cmsy-10x-x-109">} </span><span class="cmss-10x-x-109">as well. The </span><span class="cmssi-10x-x-109">granularity </span><span class="cmss-10x-x-109">(or </span><span class="cmssi-10x-x-109">mesh</span><span class="cmss-10x-x-109">) of </span><span class="cmmi-10x-x-109">X </span><span class="cmss-10x-x-109">is defined by</span></p>
<div class="math-display">
<img src="../media/file1323.png" class="math-display" alt="|X | := max |xi − xi−1|, i=1,...,n "/>
</div>
<p><span class="cmss-10x-x-109">which is the length of the biggest gap in </span><span class="cmmi-10x-x-109">X</span><span class="cmss-10x-x-109">. Note that the partition is not necessarily uniform, so </span><span class="cmmi-10x-x-109">jx</span><sub><span class="cmmi-8">i</span></sub> <span class="cmsy-10x-x-109">−</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">j </span><span class="cmss-10x-x-109">is not constant.</span></p>
<p><span class="cmss-10x-x-109">We are going to use an argument similar to the squeeze principle (</span><span class="cmssi-10x-x-109">Corollary </span><a href="ch018.xhtml#x1-167012r3"><span class="cmssi-10x-x-109">3</span></a><span class="cmss-10x-x-109">) to make the approximation idea rigorous. (You know, the one where we replaced the speed of a moving object with a piecewise constant one.) Instead of using the averages of </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>) <span class="cmss-10x-x-109">on each interval</span> [<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">,x</span><sub><span class="cmmi-8">i</span></sub>]<span class="cmss-10x-x-109">, we are going to provide an upper and lower estimation by using</span></p>
<div class="math-display">
<img src="../media/file1324.png" class="math-display" alt="mi := inf f (x ) x∈[xi−1,xi] "/>
</div>
<p><span class="cmss-10x-x-109">and</span></p>
<div class="math-display">
<img src="../media/file1325.png" class="math-display" alt="Mi := sup f(x). x∈ [xi− 1,xi] "/>
</div>
<p><span class="cmss-10x-x-109">Mathematically speaking, the infimum and the supremum are much easier to</span><span id="dx1-232002"></span> <span class="cmss-10x-x-109">work with than the average. Now we can approximate </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>) <span class="cmss-10x-x-109">with a piecewise constant function from both above and below. This is visualized by </span><span class="cmssi-10x-x-109">Figure </span><a href="#"><span class="cmssi-10x-x-109">14.4</span></a><span class="cmss-10x-x-109">.</span></p>
<div class="minipage">
<p><img src="../media/file1326.png" width="569" alt="PIC"/> <span id="x1-232003r4"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.4: Estimating the area under the curve of </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">using the partition </span><span class="cmmi-10x-x-109">X</span> </span>
</div>
<p><span class="cmss-10x-x-109">Our plan is to squeeze the area between the lower and upper sums</span></p>
<div class="math-display" >
  <span>
    L[f, X] := ∑<sub>i=1</sub><sup>n</sup> m<sub>i</sub>(x<sub>i</sub> − x<sub>i−1</sub>)
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.2)</span>
</div>

<p><span class="cmss-10x-x-109">and</span></p>
<div class="math-display" >
  <span>
    U[f, X] := ∑<sub>i=1</sub><sup>n</sup> M<sub>i</sub>(x<sub>i</sub> − x<sub>i−1</sub>),
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.3)</span>
</div>

<p><span class="cmss-10x-x-109">then study if these two match. (As usual, the dependence on </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">X </span><span class="cmss-10x-x-109">will be omitted if it is clear from the context.)</span></p>
<p><span class="cmss-10x-x-109">It is clear from the</span> <span id="dx1-232004"></span><span class="cmss-10x-x-109">construction that</span></p>
<div class="math-display">
<img src="../media/file1327.png" class="math-display" alt="L[f,X ] ≤ area under the graph ≤ U [f,X ] "/>
</div>
<p><span class="cmss-10x-x-109">holds for any partition </span><span class="cmmi-10x-x-109">X</span><span class="cmss-10x-x-109">.</span></p>
<p><span class="cmss-10x-x-109">As the granularity of the partition </span><span class="cmmi-10x-x-109">X </span><span class="cmss-10x-x-109">goes to zero, hopefully, both </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,X</span>] <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">U</span>[<span class="cmmi-10x-x-109">f,X</span>] <span class="cmss-10x-x-109">will converge to the same number. Intuitively, this common limit should be the “area under the function graph,” but currently, our notion of the area is not general enough to make such bold statements. For instance, how would you define the “area” under the Dirichlet function, defined by (</span><a href="#"><span class="cmss-10x-x-109">14.1</span></a><span class="cmss-10x-x-109">)? As we shall see soon, integration will generalize our heuristic notion of area. To get to that point, we have a lot to do. First, we’ll take a closer look at the </span><span class="cmssi-10x-x-109">partitions</span><span class="cmss-10x-x-109">.</span></p>
<section id="partitions-and-their-refinements" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_206"><span class="titlemark"><span class="cmss-10x-x-109">14.1.1 </span></span> <span id="x1-23300016.1.1"></span><span class="cmss-10x-x-109">Partitions and their refinements</span></h3>
<p><span class="cmss-10x-x-109">We need to introduce some</span> <span id="dx1-233001"></span><span class="cmss-10x-x-109">basic facts about refining partitions to construct mathematically correct arguments regarding the convergence of</span><span id="dx1-233002"></span> <span class="cmss-10x-x-109">the approximating sums </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,X</span>] <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">U</span>[<span class="cmmi-10x-x-109">f,X</span>]<span class="cmss-10x-x-109">.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-233003r63"></span> <span class="cmbx-10x-x-109">Definition 63.</span> </span><span class="cmbx-10x-x-109">(Refinement of partitions)</span></p>
<p>Let <span class="cmmi-10x-x-109">X </span>= <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">,…,x</span><sub><span class="cmmi-8">n</span></sub><span class="cmsy-10x-x-109">} </span>and <span class="cmmi-10x-x-109">Y </span>= <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">y</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">,…,y</span><sub><span class="cmmi-8">m</span></sub><span class="cmsy-10x-x-109">} </span>be two partitions of [<span class="cmmi-10x-x-109">a,b</span>]. We say that <span class="cmmi-10x-x-109">Y </span>is a <span class="cmti-10x-x-109">refinement </span>of <span class="cmmi-10x-x-109">X </span>if <span class="cmmi-10x-x-109">X </span><span class="cmsy-10x-x-109">⊆</span><span class="cmmi-10x-x-109">Y </span>.</p>
</div>
<p><span class="cmss-10x-x-109">We can visualize this easily.</span></p>
<div class="minipage">
<p><img src="../media/file1328.png" width="484" alt="PIC"/> <span id="x1-233004r5"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.5: The partition </span><span class="cmmi-10x-x-109">Y </span><span class="cmss-10x-x-109">, as a refinement of </span><span class="cmmi-10x-x-109">X</span> </span>
</div>
<p><span class="cmss-10x-x-109">Refinements are vital for understanding why integration works. One of</span><span id="dx1-233005"></span> <span class="cmss-10x-x-109">the core reasons is the following result.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-233006r64"></span> <span class="cmbx-10x-x-109">Definition 64.</span> </span><span class="cmbx-10x-x-109">Monotonicity of upper and lower sums</span></p>
<p>Let <span class="cmmi-10x-x-109">f </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span>be a bounded function and <span class="cmmi-10x-x-109">X </span>and <span class="cmmi-10x-x-109">Y </span>be two partitions of [<span class="cmmi-10x-x-109">a,b</span>]. Suppose that <span class="cmmi-10x-x-109">Y </span>is a refinement of <span class="cmmi-10x-x-109">X</span>. Then</p>
<div class="math-display" >
  <span>
    L[f, X] ≤ L[f, Y]
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.4)</span>
</div>

<p>and</p>
<div class="math-display" >
  <span>
    U[f, Y] ≤ U[f, X].
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.5)</span>
</div>

</div>
<div id="tcolobox-270" class="tcolorbox proofbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-content">
<p><span class="cmssi-10x-x-109">Proof. </span><span class="cmss-10x-x-109">We are going to show </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,X</span>] <span class="cmsy-10x-x-109">≤ </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,Y </span>]<span class="cmss-10x-x-109">, as (</span><a href="ch022.xhtml#x1-233006r64"><span class="cmss-10x-x-109">14.5</span></a><span class="cmss-10x-x-109">) follows from a similar argument. Suppose that </span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub> <span class="cmsy-10x-x-109">≤ </span><span class="cmmi-10x-x-109">y</span><sub><span class="cmmi-8">j</span></sub> <span class="cmsy-10x-x-109">≤</span> ⋅⋅⋅ <span class="cmsy-10x-x-109">≤ </span><span class="cmmi-10x-x-109">y</span><sub><span class="cmmi-8">l</span></sub> <span class="cmsy-10x-x-109">≤ </span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span></sub><span class="cmss-10x-x-109">. Mathematically speaking, we have</span></p>
<div class="math-disply">
<img src="../media/file1330.png" width="450" class="math-display" alt=" inf f(x) ≤ inf f(x), k = j + 1,...,l. x∈[xi−1,xi] x∈[yk−1,yk] "/>
</div>
<p><span class="cmss-10x-x-109">Since </span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span></sub> <span class="cmsy-10x-x-109">−</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub> = <span class="cmex-10x-x-109">∑</span> <sub><span class="cmmi-8">k</span><span class="cmr-8">=</span><span class="cmmi-8">j</span><span class="cmr-8">+1</span></sub><sup><span class="cmmi-8">l</span></sup><span class="cmmi-10x-x-109">y</span><sub><span class="cmmi-8">k</span></sub> <span class="cmsy-10x-x-109">−</span><span class="cmmi-10x-x-109">y</span><sub><span class="cmmi-8">k</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub><span class="cmss-10x-x-109">, the above implies that</span></p>
<div style="display: flex; justify-content: space-between; align-items: center; max-width: 600px;" class="equation math-display">
  <div class="math-display">
    <img src="../media/file1331.png" alt="L(U,V ) = {f : U → V | f is linear}" width="150" />
  </div>
  <div style="padding-left: 1em; ">
    <!-- Label goes here, e.g. (4.2) -->(14.6)
  </div>
</div>

<p><span class="cmss-10x-x-109">Don’t worry if these mathematical formalisms make this hard to follow. Just take a look at </span><span class="cmssi-10x-x-109">Figure </span><a href="#"><span class="cmssi-10x-x-109">14.6</span></a> <span class="cmss-10x-x-109">below, which summarizes all that we have done so far.</span></p>
<div class="minipage">
<p><img src="../media/file1332.png" width="484" alt="PIC"/> <span id="x1-233007r6"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.6: Refinement of lower sums</span> </span>
</div>
<p><span class="cmss-10x-x-109">Since </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,X</span>] <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,Y </span>] <span class="cmss-10x-x-109">are composed from parts like in (</span><a href="ch022.xhtml"><span class="cmss-10x-x-109">14.6</span></a><span class="cmss-10x-x-109">), summing over </span><span class="cmmi-10x-x-109">i </span><span class="cmss-10x-x-109">in the above immediately yields </span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,X</span>] <span class="cmsy-10x-x-109">≤</span><span class="cmmi-10x-x-109">L</span>[<span class="cmmi-10x-x-109">f,Y </span>]<span class="cmss-10x-x-109">.</span></p>
</div>
</div>
<p><span class="cmss-10x-x-109">We are almost there. There is one thing left for us to show: that for</span><span id="dx1-233008"></span> <span class="cmss-10x-x-109">any two partitions, the lower sum is always smaller than the upper sum. Hence, the squeeze principle (</span><span class="cmssi-10x-x-109">Corollary </span><a href="ch018.xhtml#x1-167012r3"><span class="cmssi-10x-x-109">3</span></a><span class="cmss-10x-x-109">) could be applied to</span> <span id="dx1-233009"></span><span class="cmss-10x-x-109">show that the lower and upper sums converge to the same limit in some instances.</span></p>
<p><span class="cmss-10x-x-109">For that, we need a simple but fundamental fact about partitions.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-233010r3"></span> <span class="cmbx-10x-x-109">Proposition 3.</span> </span></p>
<p><span class="cmti-10x-x-109">Let </span><img src="../media/file1333.png" class="math" alt="X "/> <span class="cmti-10x-x-109">and </span><img src="../media/file1334.png" class="math" alt="Y "/> <span class="cmti-10x-x-109">be two partitions of </span><img src="../media/file1335.png" class="math" alt="[a,b] "/><span class="cmti-10x-x-109">. Then there exists a partition</span> <img src="../media/file1336.png" class="math" alt="Z "/> <span class="cmti-10x-x-109">that is a refinement of both </span><img src="../media/file1337.png" class="math" alt="X "/> <span class="cmti-10x-x-109">and </span><img src="../media/file1338.png" class="math" alt="Y "/><span class="cmti-10x-x-109">.</span></p>
</div>
<div id="tcolobox-271" class="tcolorbox proofbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-content">
<p><span class="cmssi-10x-x-109">Proof. </span><span class="cmss-10x-x-109">It is easy to see that </span><img src="../media/file1339.png" class="math" alt="Z = X ∪Y "/> <span class="cmss-10x-x-109">satisfies our requirements.</span></p>
</div>
</div>
<p><span class="cmss-10x-x-109">The</span> <span id="dx1-233011"></span><span class="cmss-10x-x-109">above </span><span class="cmmi-10x-x-109">Z </span><span class="cmss-10x-x-109">is called a </span><span class="cmssi-10x-x-109">mutual refinement </span><span class="cmss-10x-x-109">of </span><span class="cmmi-10x-x-109">X </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">Y </span><span class="cmss-10x-x-109">. We can show a</span> <span id="dx1-233012"></span><span class="cmss-10x-x-109">fundamental relation between</span> <span id="dx1-233013"></span><span class="cmss-10x-x-109">the upper and lower sums with this idea.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-233014r4"></span> <span class="cmbx-10x-x-109">Proposition 4.</span> </span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→ </span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">be a bounded real function and let </span><span class="cmmi-10x-x-109">X </span><span class="cmti-10x-x-109">and </span><span class="cmmi-10x-x-109">Y </span><span class="cmti-10x-x-109">be two partitions of the interval</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmti-10x-x-109">. Then</span></p>
<div class="math-display">
<img src="../media/file1340.png" class="math-display" alt="L [f,X ] ≤ U[f,Y ] "/>
</div>
<p><span class="cmti-10x-x-109">holds.</span></p>
</div>
<div id="tcolobox-272" class="tcolorbox proofbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-content">
<p><span class="cmssi-10x-x-109">Proof. </span><span class="cmss-10x-x-109">Let </span><span class="cmmi-10x-x-109">Z </span><span class="cmss-10x-x-109">be a mutual refinement of </span><span class="cmmi-10x-x-109">X </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">Y </span><span class="cmss-10x-x-109">, as guaranteed by the previous result. Then, (</span><a href="ch022.xhtml#x1-233006r64"><span class="cmss-10x-x-109">14.4</span></a><span class="cmss-10x-x-109">) and (</span><a href="ch022.xhtml#x1-233006r64"><span class="cmss-10x-x-109">14.5</span></a><span class="cmss-10x-x-109">) imply that</span></p>
<div class="math-display">
<img src="../media/file1341.png" class="math-display" alt="L[f,X ] ≤ L [f,Z ] ≤ U [f,Z ] ≤ U [f,Y], "/>
</div>
<p><span class="cmss-10x-x-109">which is what we wanted to show.</span></p>
</div>
</div>
</section>
<section id="the-riemann-integral" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_207"><span class="titlemark"><span class="cmss-10x-x-109">14.1.2 </span></span> <span id="x1-23400016.1.2"></span><span class="cmss-10x-x-109">The Riemann integral</span></h3>
<p><span class="cmss-10x-x-109">Let’s denote</span><span id="dx1-234001"></span> <span class="cmss-10x-x-109">the</span> <span id="dx1-234002"></span><span class="cmss-10x-x-109">set of all partitions on</span> [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmss-10x-x-109">by </span><span class="cmsy-10x-x-109">ℱ</span>[<span class="cmmi-10x-x-109">a,b</span>]<span class="cmss-10x-x-109">:</span></p>
<div class="math-display">
<img src="../media/file1342.png" class="math-display" alt="ℱ [a,b] = {X : X is a partition of [a,b]}. "/>
</div>
<p><span class="cmss-10x-x-109">Now we are ready to define the integral of the function as the single value that separates upper and lower sums.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-234003r65"></span> <span class="cmbx-10x-x-109">Definition 65.</span> </span><span class="cmbx-10x-x-109">(Riemann-integrability)</span></p>
<p>Let <span class="cmmi-10x-x-109">f </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→ </span><span class="msbm-10x-x-109">ℝ </span>be a bounded function. We say that <span class="cmmi-10x-x-109">f </span>is <span class="cmti-10x-x-109">Riemann-integrable </span>(or just integrable) on [<span class="cmmi-10x-x-109">a,b</span>] if</p>
<div class="math-display">
<img src="../media/file1343.png" class="math-display" alt="X∈suℱp[a,b]L[f,X ] = X i∈nℱf[a,b]U [f,X ]. "/>
</div>
<p>This value is called the Riemann integral (or just the integral) of <span class="cmmi-10x-x-109">f </span>over [<span class="cmmi-10x-x-109">a,b</span>], denoted by</p>
<img src="../media/file1344.png" width="150" class="math-display" alt="∫ b f (x )dx. a "/>

</div>
<p><span class="cmss-10x-x-109">The function </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">in </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx </span><span class="cmss-10x-x-109">is called the </span><span class="cmssi-10x-x-109">integrand</span><span class="cmss-10x-x-109">. How do we calculate the integral itself? The hard way is to define a sequence of partitions </span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">n</span></sub> <span class="cmss-10x-x-109">and show that</span></p>
<div class="math-display">
<img src="../media/file1345.png" class="math-display" alt=" lim L[f,Xn ] = lim U[f,Xn ], n→ ∞ n→ ∞ "/>
</div>
<p><span class="cmss-10x-x-109">so this</span> <span id="dx1-234004"></span><span class="cmss-10x-x-109">number is necessarily </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx</span><span class="cmss-10x-x-109">. We’ll see the easy</span> <span id="dx1-234005"></span><span class="cmss-10x-x-109">way soon, but let’s see an example demonstrating this process.</span></p>
<p><span class="cmss-10x-x-109">Let’s calculate </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmr-8">0</span></sub><sup><span class="cmr-8">1</span></sup><span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup><span class="cmmi-10x-x-109">dx</span><span class="cmss-10x-x-109">!</span></p>
<p><span class="cmss-10x-x-109">The simplest is to use the uniform partition </span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">n</span></sub> = <span class="cmmi-10x-x-109">i∕n</span><sub><span class="cmmi-8">i</span><span class="cmr-8">=0</span></sub><sup><span class="cmmi-8">n</span></sup><span class="cmss-10x-x-109">, obtaining</span></p>
<div class="math-display">
<img src="../media/file1346.png" class="math-display" alt=" ∑n i − 1 21 L[x2,Xn ] = (-----) -- i=1 n n 1 ∑n = -3- (i− 1)2. n i=1 "/>
</div>
<p><span class="cmss-10x-x-109">Since </span><span class="cmex-10x-x-109">∑</span> <sub><span class="cmmi-8">k</span><span class="cmr-8">=1</span></sub><sup><span class="cmmi-8">n</span></sup><span class="cmmi-10x-x-109">k</span><sup><span class="cmr-8">2</span></sup> = <img src="../media/file1347.png" width="85" data-align="middle" alt="n(n+1)6(2n+1)"/> <span class="cmss-10x-x-109">(as it can be shown by induction), it is easy to see that</span></p>
<div class="math-display">
<img src="../media/file1348.png" class="math-display" alt=" 2 1 nli→m∞ L[x ,Xn ] = 3. "/>
</div>
<p><span class="cmss-10x-x-109">With a similar argument, you can check that</span> lim<sub><span class="cmmi-8">n</span><span class="cmsy-8">→∞</span></sub><span class="cmmi-10x-x-109">U</span>[<span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup><span class="cmmi-10x-x-109">,X</span><sub><span class="cmmi-8">n</span></sub>] = <img src="../media/file1349.png" class="math" data-align="middle" alt="1 3"/> <span class="cmss-10x-x-109">as well, thus, </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmr-8">0</span></sub><sup><span class="cmr-8">1</span></sup><span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup><span class="cmmi-10x-x-109">dx </span><span class="cmss-10x-x-109">exists and</span></p>
<img src="../media/file1350.png" width="150" class="math-display" alt="∫ 1 1 x2dx = -. 0 3 "/>
<p><span class="cmss-10x-x-109">Although this method works for simple cases such as </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>) = <span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup><span class="cmss-10x-x-109">, it breaks down for more complex functions, as calculating limits of upper and lower sums can be difficult. In addition, selecting the right partition is also a challenge. For instance, can you calculate </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmr-8">0</span></sub><sup><span class="cmmi-8">π</span></sup> sin(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx </span><span class="cmss-10x-x-109">by the definition?</span></p>
<p><span class="cmss-10x-x-109">Because we are lazy (just like any good mathematician), we want to find a general method to calculate integrals. Lower and upper sums are needed to make the notion of an integral mathematically precise. Combined with the squeeze principle (</span><span class="cmssi-10x-x-109">Corollary </span><a href="ch018.xhtml#x1-167012r3"><span class="cmssi-10x-x-109">3</span></a><span class="cmss-10x-x-109">), they are used to provide a definition.</span></p>
<p><span class="cmss-10x-x-109">However, other tools become available once we know that a function is integrable. Such as the general approximating sum, as we are about to see next.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-234006r91"></span> <span class="cmbx-10x-x-109">Theorem 91.</span> </span> <span class="cmti-10x-x-109">Let </span><img src="../media/file1351.png" class="math" alt="f : ℝ → ℝ "/> <span class="cmti-10x-x-109">be an arbitrary bounded function, and let</span> <img src="../media/file1352.png" class="math" alt="Xn = {x0,n,...,xn,n} "/> <span class="cmti-10x-x-109">be a sequence of partitions on </span><img src="../media/file1353.png" width="25" alt="[a,b] "/> <span class="cmti-10x-x-109">such that</span> <img src="../media/file1354.png" width="55" alt="|Xn | → 0 "/><span class="cmti-10x-x-109">. Then </span><img src="../media/file1355.png" class="math" alt="f "/> <span class="cmti-10x-x-109">is integrable if and only if the limit</span></p>
<div class="math-display">
<img src="../media/file1356.png" class="math-display" alt=" ∑n lim f(ξi)(xi,n − xi− 1,n) n→∞ i=1 "/>
</div>
<p><span class="cmti-10x-x-109">exists and in this case,</span></p>
<div class="math-display">
<img src="../media/file1357.png" class="math-display" alt=" ∑n ∫ b nl→im∞ f (ξi)(xi,n − xi−1,n) = f(x)dx i=1 a "/>
</div>
<p><span class="cmti-10x-x-109">holds, where </span><span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">i</span></sub> <span class="cmsy-10x-x-109">∈ </span>[<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span><span class="cmmi-8">,n</span></sub><span class="cmmi-10x-x-109">,x</span><sub><span class="cmmi-8">i,n</span></sub>]<span class="cmti-10x-x-109">.</span></p>
</div>
<p><span class="cmss-10x-x-109">(Note that </span><span class="cmmi-10x-x-109">jX</span><sub><span class="cmmi-8">n</span></sub><span class="cmmi-10x-x-109">j </span><span class="cmsy-10x-x-109">→ </span>0 <span class="cmss-10x-x-109">means that the length of the largest subinterval of </span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">n</span></sub> <span class="cmss-10x-x-109">gets extremely small. In other words, the resolution of </span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">n</span></sub> <span class="cmss-10x-x-109">gets extremely large.)</span></p>
<p><span class="cmss-10x-x-109">We will</span> <span id="dx1-234007"></span><span class="cmss-10x-x-109">not prove the above theorem, as</span> <span id="dx1-234008"></span><span class="cmss-10x-x-109">the proof is technical and doesn’t provide any valuable insight. However, the point is clear: local infima and suprema in lower and upper sums can be replaced with any local value.</span></p>
<p><span class="cmss-10x-x-109">For simplicity, we’ll denote this sum by</span></p>
<div class="math-display" >
  <span>
    S[f, X, \xi_X] = \sum_{i=1}^n f(\xi_i)(x_i - x_{i-1})
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.7)</span>
</div>

<p><span class="cmss-10x-x-109">for any </span><span class="cmmi-10x-x-109">X </span>= <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">,…,x</span><sub><span class="cmmi-8">n</span></sub><span class="cmsy-10x-x-109">} </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">X</span></sub> = <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">ξ</span><sub><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">,…,ξ</span><sub><span class="cmmi-8">n</span></sub><span class="cmsy-10x-x-109">} </span><span class="cmss-10x-x-109">with </span><span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">i</span></sub> <span class="cmsy-10x-x-109">∈ </span>[<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">,x</span><sub><span class="cmmi-8">i</span></sub>]<span class="cmss-10x-x-109">.</span></p>
</section>
<section id="integration-as-the-inverse-of-differentiation" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_208"><span class="titlemark"><span class="cmss-10x-x-109">14.1.3 </span></span> <span id="x1-23500016.1.3"></span><span class="cmss-10x-x-109">Integration as the inverse of differentiation</span></h3>
<p><span class="cmss-10x-x-109">Now that we understand</span> <span id="dx1-235001"></span><span class="cmss-10x-x-109">the mathematical definition of the integral, it</span><span id="dx1-235002"></span> <span class="cmss-10x-x-109">is time to find some tools that enable its use in practice. The most important result is the Newton-Leibniz formula, named after Isaac Newton and Gottfried Wilhelm Leibniz, the</span> <span id="dx1-235003"></span><span class="cmss-10x-x-109">inventors of calculus. (Fun fact: these men discovered calculus independently and were mortal enemies throughout their lives.)</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-235004r92"></span> <span class="cmbx-10x-x-109">Theorem 92.</span> </span><span class="cmbxti-10x-x-109">(The fundamental theorem of calculus, a.k.a. the Newton-Leibniz formula)</span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">a function that is integrable on</span> [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmti-10x-x-109">and suppose that there is an </span><span class="cmmi-10x-x-109">F </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">such that </span><span class="cmmi-10x-x-109">F</span><sup><span class="cmsy-8">′</span></sup>(<span class="cmmi-10x-x-109">x</span>) = <span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmti-10x-x-109">. Then</span></p>
<div class="math-display" >
  <span>
    ∫ₐᵇ f(x) dx = F(b) − F(a)
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.8)</span>
</div>

<p><span class="cmti-10x-x-109">holds.</span></p>
</div>
<p><span class="cmss-10x-x-109">In other words, by defining </span><span class="cmmi-10x-x-109">x</span>→<span class="cmmi-10x-x-109">F</span>(<span class="cmmi-10x-x-109">a</span>) + <span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">x</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx</span><span class="cmss-10x-x-109">, we can effectively reconstruct a function from its derivative.</span></p>
<div id="tcolobox-273" class="tcolorbox proofbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-content">
<p><span class="cmssi-10x-x-109">Proof. </span><span class="cmss-10x-x-109">Let </span><img src="../media/file1359.png" class="math" alt="a = x0 &lt;x1 &lt;⋅⋅⋅ &lt;xn = b "/> <span class="cmss-10x-x-109">be an arbitrary partition of</span> <img src="../media/file1360.png" class="math" alt="[a,b] "/><span class="cmss-10x-x-109">. According to Lagrange’s mean value theorem (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch021.xhtml#x1-215010r89"><span class="cmssi-10x-x-109">89</span></a><span class="cmss-10x-x-109">), there exists a </span><img src="../media/file1361.png" class="math" alt="ξi ∈ (xi−1,xi) "/> <span class="cmss-10x-x-109">for all </span><img src="../media/file1362.png" class="math" alt="i = 1,...,n "/> <span class="cmss-10x-x-109">such that</span></p>
<div class="math-display">
<img src="../media/file1363.png" class="math-display" alt=" ′ F(xi)− F (xi−1) = F (ξi)(xi − xi−1) = f (ξ )(x − x ). i i i−1 "/>
</div>
<p><span class="cmss-10x-x-109">Thus, we can sum these numbers up, eliminating all but the first and last elements:</span></p>
<div class="math-display">
<img src="../media/file1364.png" class="math-display" alt="∑n ∑n f(ξi)(xi − xi−1) = F(xi)− F (xi− 1) i=1 i=1 = F (b)− F (a ). "/>
</div>
<p><span class="cmss-10x-x-109">On the other hand, due to the properties of lower and upper sums, we have</span></p>
<div class="math-display">
<img src="../media/file1365.png" class="math-display" alt=" ∑n L[f,X ] ≤ f(ξ)(x − x ) ≤ U[f,X ] i=1 i i i−1 "/>
</div>
<p><span class="cmss-10x-x-109">Since </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">is integrable, the squeeze principle (</span><span class="cmssi-10x-x-109">Corollary </span><a href="ch018.xhtml#x1-167012r3"><span class="cmssi-10x-x-109">3</span></a><span class="cmss-10x-x-109">) and </span><span class="cmssi-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-234006r91"><span class="cmssi-10x-x-109">91</span></a> <span class="cmss-10x-x-109">imply that</span></p>
<div class="math-display">
<img src="../media/file1366.png" class="math-display" alt="∫ b ∑n f (x )dx = f(ξi)(xi − xi− 1) = F (b) − F(a) a i=1 "/>
</div>
<p><span class="cmss-10x-x-109">must hold. This is what we</span> <span id="dx1-235005"></span><span class="cmss-10x-x-109">had to show.</span></p>
</div>
</div>
<div class="newtheorem">
<p><span class="head"> <span id="x1-235006r10"></span> <span class="cmbx-10x-x-109">Remark 10.</span> </span><span class="cmbx-10x-x-109">(Increments of functions)</span></p>
<p>For simplicity, the increments of a function <span class="cmmi-10x-x-109">F </span>on the interval [<span class="cmmi-10x-x-109">a,b</span>] is also denoted by</p>
<div class="math-display">
<img src="../media/file1367.png" class="math-display" alt=" x=b [F(x)]x=a := F (b)− F (a ). "/>
</div>
<p>Thus, according to the fundamental theorem of calculus (<span class="cmti-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-235004r92"><span class="cmti-10x-x-109">92</span></a>),</p>
<div class="math-display">
<img src="../media/file1368.png" class="math-display" alt="∫ b f(x)dx = [F (x)]x=x=ba a "/>
</div>
<p>holds if <span class="cmmi-10x-x-109">F</span><sup><span class="cmsy-8">′</span></sup>(<span class="cmmi-10x-x-109">x</span>) = <span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>).</p>
</div>
<p><span class="cmss-10x-x-109">Note that integration is insensitive towards changing the values of </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>) <span class="cmss-10x-x-109">at countably many points. To be more precise, suppose that </span><span class="cmmi-10x-x-109">f </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmss-10x-x-109">is a function that is integrable on</span> [ <span class="cmsy-10x-x-109">− </span>1<span class="cmmi-10x-x-109">,</span>1]<span class="cmss-10x-x-109">. Let’s change its value at a single point and define</span></p>
<div class="math-display">
<img src="../media/file1369.png" class="math-display" alt=" ( |{ f(0)+ 1 if x = 0 f∗(x) = |( f(x) otherwise. "/>
</div>
<p><span class="cmss-10x-x-109">If a partition is given by </span><span class="cmsy-10x-x-109">−</span>1 = <span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">…/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">k</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub> <span class="cmsy-10x-x-109">≤ </span>0<span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">k</span></sub><span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">…/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">n</span></sub> = 1<span class="cmss-10x-x-109">, then</span> </span></span></span></span></span></p>

<img src="../media/file1370.png" class="math-display" alt="|L[f,X] − L[f∗,X ]| = | inf f (x)− inf f∗(x)|(xk − xk− 1) x∈[xk−1,xk] x∈[xk−1,xk] ◟------------=◝:◜m--------------◞ k " width="450"/>

<p><span class="cmss-10x-x-109">and</span></p>

<img src="../media/file1371.png" class="math-display" alt=" ∗ ∗ |U [f,X] − U[f ,X ]| = |x∈s[xukp−1,xk]f(x)− x∈[sxuk−p1,xk]f (x )|(xk − xk −1) ◟-------------◝◜--------------◞ =:Mk " width="450"/>
<p><span class="cmss-10x-x-109">holds. We can select</span> <span id="dx1-235007"></span><span class="cmss-10x-x-109">the partition such that </span><img src="../media/file1372.png" class="math" alt="xk − xk−1 &lt;𝜀 "/> <span class="cmss-10x-x-109">for some arbitrary</span> <img src="../media/file1373.png" class="math" alt="𝜀 &gt;0 "/><span class="cmss-10x-x-109">, thus,</span></p>
<div class="math-display">
<img src="../media/file1374.png" class="math-display" alt="|L[f,X ]− L[f∗,X ]| and |U [f,X ]− U[f∗,X ]| "/>
</div>
<p><span class="cmss-10x-x-109">can be made as small as needed. This implies that</span></p>
<div class="math-display">
<img src="../media/file1375.png" class="math-display" alt="∫ b ∫ b f(x)dx = f∗(x)dx. a a "/>
</div>
<p><span class="cmss-10x-x-109">Hence, saying that integration is the inverse of differentiation is mathematically a bit imprecise. Given a differentiable function </span><span class="cmmi-10x-x-109">F</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmss-10x-x-109">, its derivative is unique, but there are infinitely many functions whose integral </span><span class="cmmi-10x-x-109">F</span>(<span class="cmmi-10x-x-109">a</span>) + <span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">x</span></sup><span class="cmmi-10x-x-109">g</span>(<span class="cmmi-10x-x-109">y</span>)<span class="cmmi-10x-x-109">dy </span><span class="cmss-10x-x-109">reconstructs </span><span class="cmmi-10x-x-109">F</span><span class="cmss-10x-x-109">.</span></p>
<p><span class="cmss-10x-x-109">The fundamental theorem of calculus allows us to formulate Lagrange’s mean value theorem (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch021.xhtml#x1-215010r89"><span class="cmssi-10x-x-109">89</span></a><span class="cmss-10x-x-109">) in terms of integrals.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-235008r93"></span> <span class="cmbx-10x-x-109">Theorem 93.</span> </span><span class="cmbxti-10x-x-109">(The mean value theorem for definite integrals)</span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">a function that is continuous on</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmti-10x-x-109">. Then there exists an </span><span class="cmmi-10x-x-109">ξ </span><span class="cmsy-10x-x-109">∈ </span>[<span class="cmmi-10x-x-109">a,b</span>] <span class="cmti-10x-x-109">such that</span></p>
<div class="math-display">
<img src="../media/file1376.png" class="math-display" alt="∫ b f(x)dx = (b− a)f(ξ). a "/>
</div>
</div>
<div id="tcolobox-274" class="tcolorbox proofbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-content">
<p><span class="cmssi-10x-x-109">Proof. </span><span class="cmss-10x-x-109">According to the fundamental theorem of calculus (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-235004r92"><span class="cmssi-10x-x-109">92</span></a><span class="cmss-10x-x-109">), the function</span></p>
<div class="math-display">
<img src="../media/file1377.png" class="math-display" alt=" ∫ t F (t) = a f(x)dx "/>
</div>
<p><span class="cmss-10x-x-109">is differentiable on </span>[<span class="cmmi-10x-x-109">a,b</span>] <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">F</span><sup><span class="cmsy-8">′</span></sup>(<span class="cmmi-10x-x-109">t</span>) = <span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">t</span>)<span class="cmss-10x-x-109">.</span></p>
<p><span class="cmss-10x-x-109">Thus, Lagrange’s mean value theorem (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch021.xhtml#x1-215010r89"><span class="cmssi-10x-x-109">89</span></a><span class="cmss-10x-x-109">) gives that</span></p>
<div class="math-display">
<img src="../media/file1378.png" class="math-display" alt="F-(b)−-F-(a-) b− a = f (ξ) "/>
</div>
<p><span class="cmss-10x-x-109">for some </span><span class="cmmi-10x-x-109">ξ </span><span class="cmsy-10x-x-109">∈ </span>(<span class="cmmi-10x-x-109">a,b</span>)<span class="cmss-10x-x-109">, from which</span></p>
<div class="math-display">
<img src="../media/file1379.png" class="math-display" alt="∫ b f(x)dx = F(b)− F (a) a = (b− a)f(ξ) "/>
</div>
<p><span class="cmss-10x-x-109">follows. This is what we had to show.</span></p>
</div>
</div>
<p><span class="cmss-10x-x-109">After all this theory, you might ask: what does integration have to do</span><span id="dx1-235009"></span> <span class="cmss-10x-x-109">with machine learning? Without being mathematically rigorous, here is a (very) brief overview of what’s to come.</span></p>
<p><span class="cmss-10x-x-109">First, you can think about integration as a continuous generalization of the arithmetic mean. As you can see, for equidistant partitions, an approximating sum</span></p>
<div class="math-display">
<img src="../media/file1380.png" class="math-display" alt=" ∑n S[f,X,ξ] = 1- f(ξi) n i=1 "/>
</div>
<p><span class="cmss-10x-x-109">is exactly the average of </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">ξ</span><sub><span class="cmr-8">1</span></sub>)<span class="cmmi-10x-x-109">,…,f</span>(<span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">n</span></sub>)<span class="cmss-10x-x-109">. In machine learning, averages are frequently used to express various quantities, like the mean-squared error. Think about it: loss functions are often averages of certain individual losses. On a fine enough scale, averages become integrals.</span></p>
<p><span class="cmss-10x-x-109">Along with linear algebra and calculus, the central pillar of machine learning is </span><span class="cmssi-10x-x-109">probability theory and statistics</span><span class="cmss-10x-x-109">, which gives us a way to model the world based on our observations. Probability and statistics are the logic of science and decision-making. There, integration is used to express probabilities, expected value, information, and much more. Without a rigorous theory of integration, we cannot build probabilistic models beyond a certain point.</span></p>
</section>
</section>
<section id="integration-in-practice" class="level3 sectionHead">
<h2 class="sectionHead" id="sigil_toc_id_209"><span class="titlemark"><span class="cmss-10x-x-109">14.2 </span></span> <span id="x1-23600016.2"></span><span class="cmss-10x-x-109">Integration in practice</span></h2>
<p><span class="cmss-10x-x-109">Even though</span> <span id="dx1-236001"></span><span class="cmss-10x-x-109">we understand what an integral is, we are far from computing them in practice. As opposed to differentiation, analytically evaluating integrals can be </span><span class="cmssi-10x-x-109">really </span><span class="cmss-10x-x-109">difficult and sometimes downright impossible. The formula (</span><a href="ch022.xhtml#x1-235004r92"><span class="cmss-10x-x-109">92</span></a><span class="cmss-10x-x-109">) suggests that the key is to find the function whose derivative is the integrand, called the antiderivative or primitive function. This is harder than you think. Nevertheless, there are several tools for this, and we are going to devote this section to studying the most important ones.</span></p>
<p><span class="cmss-10x-x-109">Often, the key is finding the antiderivative, so we introduce the notation</span></p>
<div class="math-display">
<img src="../media/file1381.png" class="math-display" alt=" ∫ F(x) = f (x)dx, "/>
</div>
<p><span class="cmss-10x-x-109">for the functions where </span><span class="cmmi-10x-x-109">F</span><sup><span class="cmsy-8">′</span></sup> = <span class="cmmi-10x-x-109">f</span><span class="cmss-10x-x-109">. (Sometimes we abbreviate this to </span><span class="cmmi-10x-x-109">F </span>= <span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">fdx</span><span class="cmss-10x-x-109">.) Note that since </span>(<span class="cmmi-10x-x-109">F </span>+ <span class="cmss-10x-x-109">some constant</span>)<sup><span class="cmsy-8">′</span></sup> = <span class="cmmi-10x-x-109">F</span><sup><span class="cmsy-8">′</span></sup><span class="cmss-10x-x-109">, the antiderivative </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx </span><span class="cmss-10x-x-109">is not uniquely determined. However, this is not an issue for us, as the Newton-Leibniz formula states that</span></p>
<div class="math-display">
<img src="../media/file1382.png" class="math-display" alt="∫ b f (x )dx = F (b)− F (a). a "/>
</div>
<p><span class="cmss-10x-x-109">Thus, any</span> <span id="dx1-236002"></span><span class="cmss-10x-x-109">additional constants would be eliminated.</span></p>
<p><span class="cmss-10x-x-109">With this under our belt, we are ready to dig deep into evaluating integrals in practice.</span></p>
<section id="integrals-and-operations" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_210"><span class="titlemark"><span class="cmss-10x-x-109">14.2.1 </span></span> <span id="x1-23700016.2.1"></span><span class="cmss-10x-x-109">Integrals and operations</span></h3>
<p><span class="cmss-10x-x-109">As we have</span> <span id="dx1-237001"></span><span class="cmss-10x-x-109">seen this several times (for instance, when discussing the rules of differentiation in </span><span class="cmssi-10x-x-109">Theorem </span><a href="ch020.xhtml#x1-202002r80"><span class="cmssi-10x-x-109">80</span></a><span class="cmss-10x-x-109">), the relations of an operation with addition, multiplication, and possibly others are extremely useful for gaining insight and developing practical tools.</span></p>
<p><span class="cmss-10x-x-109">This is the same for integration as well. Similar to before, the linearity of the integral is our main tool to evaluate it.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-237002r94"></span> <span class="cmbx-10x-x-109">Theorem 94.</span> </span><span class="cmbxti-10x-x-109">(Linearity of the Riemann integral)</span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f,g </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">be two functions that are integrable on</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmti-10x-x-109">. Then</span></p>
<p><span class="cmti-10x-x-109">(a) </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="big">(</span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>) + <span class="cmmi-10x-x-109">g</span>(<span class="cmmi-10x-x-109">x</span>)<span class="big">)</span><span class="cmmi-10x-x-109">dx </span>= <span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx </span>+ <span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">g</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx</span><span class="cmti-10x-x-109">,</span></p>
<p><span class="cmti-10x-x-109">(b) </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">cf</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx </span>= <span class="cmmi-10x-x-109">c</span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx</span><span class="cmti-10x-x-109">.</span></p>
</div>
<div id="tcolobox-275" class="tcolorbox proofbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-content">
<p><span class="cmssi-10x-x-109">Proof. (a) </span><span class="cmss-10x-x-109">If </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">g </span><span class="cmss-10x-x-109">are integrable, then for any </span><span class="cmmi-10x-x-109">𝜀 &gt;</span>0<span class="cmss-10x-x-109">, there are partitions </span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">f</span></sub><span class="cmmi-10x-x-109">,X</span><sub><span class="cmmi-8">g</span></sub> <span class="cmss-10x-x-109">such that</span></p>
<img src="../media/file1385.png" class="math-display" alt="∫ ∫ b b a f(x)dx− 𝜀 ≤ L [f,Xf ] ≤ U [f,Xf] ≤ a f(x)dx + 𝜀 " width="450"/>

<p><span class="cmss-10x-x-109">and</span></p>

<img src="../media/file1386.png" class="math-display" alt="∫ b ∫ b g(x)dx− 𝜀 ≤ L [g,Xg ] ≤ U [g,Xg ] ≤ g(x )dx + 𝜀, a a " width="450"/>

<p><span class="cmss-10x-x-109">where the lower and upper sums are defined by (</span><a href="#"><span class="cmss-10x-x-109">14.2</span></a><span class="cmss-10x-x-109">) and (</span><a href="#"><span class="cmss-10x-x-109">14.3</span></a><span class="cmss-10x-x-109">). So, for the mutual refinement </span><span class="cmmi-10x-x-109">X </span>= <span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">f</span></sub> <span class="cmsy-10x-x-109">∪</span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">g</span></sub><span class="cmss-10x-x-109">, we have</span></p>
<div class="math-dislay">
<img src="../media/file1387.png" width="150" class="math-display" alt="L[f,Xf ] ≤ L [f,X ], L [g,Xg ] ≤ L [g,X ], U[f,X ] ≤ U [f,Xf ], U[g,X ] ≤ U [g,X ] g "/>
</div>
<p><span class="cmss-10x-x-109">due to the </span><span class="cmssi-10x-x-109">Proposition </span><a href="ch022.xhtml#x1-233014r4"><span class="cmssi-10x-x-109">4</span></a><span class="cmss-10x-x-109">. Thus,</span></p>

<img src="../media/file1388.png" width="450" class="math-display" alt="∫ ∫ b b f(x)dx+ g(x)dx− 2𝜀 ≤ L [f,Xf ]+ L [g,Xg ] a a ≤ L [f,X ]+ L [g,X ] ≤ S [f,X, ξX]+ S[g,X,ξX ] ≤ U [f, X]+ U[g,X ] ≤ U [f, Xf]+ U [g,Xg] ∫ ∫ b b ≤ a f (x)dx+ a g(x )dx + 2𝜀, "/>

<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">S </span><span class="cmss-10x-x-109">is defined by (</span><a href="#"><span class="cmss-10x-x-109">14.7</span></a><span class="cmss-10x-x-109">). From this definition, it can also be seen that</span></p>
<img src="../media/file1389.png" class="math-display" alt="S[f + g,X, ξX ] = S[f,X, ξX]+ S [g,X, ξX]. " width="450"/>

<p><span class="cmss-10x-x-109">Thus,</span></p>
<img src="../media/file1390.png" width="450" class="math-display" alt=" "/>

<p><span class="cmss-10x-x-109">implying that</span></p>
<div class="math-display">
<img src="../media/file1391.png" class="math-display" alt=" "/>
</div>
<p><span class="cmssi-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-234006r91"><span class="cmssi-10x-x-109">91</span></a> <span class="cmss-10x-x-109">regarding the approximating sum </span><span class="cmmi-10x-x-109">S </span><span class="cmss-10x-x-109">implies that </span><span class="cmmi-10x-x-109">f </span>+ <span class="cmmi-10x-x-109">g </span><span class="cmss-10x-x-109">is integrable on </span>[<span class="cmmi-10x-x-109">a,b</span>] <span class="cmss-10x-x-109">and</span></p>
<div class="math-display">
<img src="../media/file1392.png" class="math-display" alt=" "/>
</div>
<p><span class="cmssi-10x-x-109">(b) </span><span class="cmss-10x-x-109">This follows from the fact that </span><span class="cmmi-10x-x-109">S</span>[<span class="cmmi-10x-x-109">cf,X,ξ</span><sub><span class="cmmi-8">X</span></sub>] = <span class="cmmi-10x-x-109">cS</span>[<span class="cmmi-10x-x-109">f,X,ξ</span><sub><span class="cmmi-8">X</span></sub>]<span class="cmss-10x-x-109">.</span></p>
</div>
</div>
</section>
<section id="integration-by-parts" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_211"><span class="titlemark"><span class="cmss-10x-x-109">14.2.2 </span></span> <span id="x1-23800016.2.2"></span><span class="cmss-10x-x-109">Integration by parts</span></h3>
<p><span class="cmss-10x-x-109">As we have learned</span> <span id="dx1-238001"></span><span class="cmss-10x-x-109">when studying the rules of differentiation (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch020.xhtml#x1-202002r80"><span class="cmssi-10x-x-109">80</span></a><span class="cmss-10x-x-109">), for an arbitrary </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">g</span><span class="cmss-10x-x-109">, we have</span></p>
<div class="math-display">
<img src="../media/file1393.png" class="math-display" alt="(fg)′ = f ′g + fg′. "/>
</div>
<p><span class="cmss-10x-x-109">Applying this logic to the antiderivatives,</span></p>
<div class="math-display">
<img src="../media/file1394.png" class="math-display" alt=" ∫ f g = (f ′g + fg′)dx "/>
</div>
<p><span class="cmss-10x-x-109">holds. Rearranging the equation a bit, we obtain the formula of </span><span class="cmssi-10x-x-109">integration by parts</span><span class="cmss-10x-x-109">:</span></p>
<div class="math-display" >
  <span>
    ∫ f′g dx = fg − ∫ fg′ dx.
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">14.9</span>
</div>

<p><span class="cmss-10x-x-109">This is summed up in the following theorem.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-238002r95"></span> <span class="cmbx-10x-x-109">Theorem 95.</span> </span><span class="cmbxti-10x-x-109">(Integration by parts)</span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f,g </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">be two functions. If both are differentiable on the interval</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmti-10x-x-109">, then</span></p>
<div class="math-dislay">
<img src="../media/file1395.png" width="450" class="math-display" alt="∫ b ∫ b f′(x)g(x)dx = [f(x)g(x)]x=b − f(x)g′(x)dx a x=a a "/>
</div>
<p><span class="cmti-10x-x-109">holds.</span></p>
</div>
<p><span class="cmss-10x-x-109">How is this useful for us? Consider a situation where finding the antiderivative of </span><span class="cmmi-10x-x-109">f </span><span class="cmss-10x-x-109">and the derivative of </span><span class="cmmi-10x-x-109">g </span><span class="cmss-10x-x-109">is easy, but the antiderivative of the product </span><span class="cmmi-10x-x-109">fg </span><span class="cmss-10x-x-109">is hard. For example, can you quickly calculate the following?</span></p>
<img src="../media/file1396.png" width="150" class="math-display" alt="∫ x log xdx "/>

<p><span class="cmss-10x-x-109">Applying (</span><a href="ch022.xhtml#integration-by-parts"><span class="cmss-10x-x-109">14.9</span></a><span class="cmss-10x-x-109">) with the roles </span><span class="cmmi-10x-x-109">f</span><sup><span class="cmsy-8">′</span></sup>(<span class="cmmi-10x-x-109">x</span>) = <span class="cmmi-10x-x-109">x </span><span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">g</span>(<span class="cmmi-10x-x-109">x</span>) = log <span class="cmmi-10x-x-109">x </span><span class="cmss-10x-x-109">immediately yields</span></p>
<div class="math-display">
<img src="../media/file1397.png" class="math-display" alt="∫ ∫ 1-2 1- x log x = 2x log x− 2xdx 1 1 = -x2log |x|− -x2 + C, 2 4 "/>
</div>
<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">C </span><span class="cmsy-10x-x-109">∈</span><span class="msbm-10x-x-109">ℝ </span><span class="cmss-10x-x-109">is an arbitrary constant.</span></p>
</section>
<section id="integration-by-substitution" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_212"><span class="titlemark"><span class="cmss-10x-x-109">14.2.3 </span></span> <span id="x1-23900016.2.3"></span><span class="cmss-10x-x-109">Integration by substitution</span></h3>
<p><span class="cmss-10x-x-109">As the integration</span> <span id="dx1-239001"></span><span class="cmss-10x-x-109">by parts formula is the “opposite” of the differentiation rule for products, there is an analogue for the chain formula as well. Recall that for two differentiable functions, we had</span></p>
<div class="math-display">
<img src="../media/file1398.png" class="math-display" alt="(f ∘ g)′(x) = f′(g(x ))g′(x). "/>
</div>
<p><span class="cmss-10x-x-109">Translating this to the language of integrals, we obtain the following result.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-239002r96"></span> <span class="cmbx-10x-x-109">Theorem 96.</span> </span><span class="cmbxti-10x-x-109">(Integration by substitution)</span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f,g </span>: <span class="msbm-10x-x-109">ℝ </span><span class="cmsy-10x-x-109">→ </span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">be integrable functions on</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmti-10x-x-109">. Suppose that </span><span class="cmmi-10x-x-109">f </span><span class="cmti-10x-x-109">is continuous and </span><span class="cmmi-10x-x-109">g </span><span class="cmti-10x-x-109">is differentiable. Then</span></p>
<div class="math-display">
<img src="../media/file1399.png" class="math-display" alt="∫ b ∫ g(b) f(g(y))g′(y)dy = f(x)dx a g(a) "/>
</div>
<p><span class="cmti-10x-x-109">holds.</span></p>
</div>
<p><span class="cmss-10x-x-109">This is called </span><span class="cmssi-10x-x-109">integration by substitution</span><span class="cmss-10x-x-109">. To give you an example of its use, consider</span></p>

<img src="../media/file1400.png" width="150" class="math-display" alt="∫ 2 x sin(x )dx. "/>

<p><span class="cmss-10x-x-109">With the roles </span><span class="cmmi-10x-x-109">y</span>(<span class="cmmi-10x-x-109">x</span>) = <span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup><span class="cmss-10x-x-109">, we have</span></p>
<div class="math-display">
<img src="../media/file1401.png" class="math-display" alt="∫ 1∫ xsin(x2 )dx = -- sin ydy 2 = − 1-cosy + C 2 = − 1-cos(x2)+ C, 2 "/>
</div>
<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">C </span><span class="cmsy-10x-x-109">∈</span><span class="msbm-10x-x-109">ℝ </span><span class="cmss-10x-x-109">is an arbitrary constant.</span></p>
<p><span class="cmss-10x-x-109">Integration by parts and substitution are our main weapons for calculating integrals on paper. Most of the integrals one might encounter can be solved with the creative (and possibly iterated) application of these two rules. The recipe is simple: find the antiderivative, then use the Newton-Leibniz formula (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-235004r92"><span class="cmssi-10x-x-109">92</span></a><span class="cmss-10x-x-109">) to compute the value of the integral.</span></p>
<p><span class="cmss-10x-x-109">However, there is a serious issue: antiderivatives can be extremely hard to find, maybe even impossible. This makes integrals difficult to compute symbolically. For instance, consider</span></p>
<img src="../media/file1402.png" width="150" class="math-display" alt="∫ −x2 e dx, "/>

<p><span class="cmss-10x-x-109">where the function </span><span class="cmmi-10x-x-109">e</span><sup><span class="cmsy-8">−</span><span class="cmmi-8">x</span><sup><span class="cmr-6">2</span></sup></sup> <span class="cmss-10x-x-109">describes the well-known Gaussian bell curve. As surprising as it is, </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">e</span><sup><span class="cmsy-8">−</span><span class="cmmi-8">x</span><sup><span class="cmr-6">2</span></sup></sup> <span class="cmmi-10x-x-109">dx </span><span class="cmss-10x-x-109">cannot be described with a closed formula! (That is, one that uses a finite number of operations and only elementary functions.) It’s not that mathematicians were not clever enough to find a</span> <span id="dx1-239003"></span><span class="cmss-10x-x-109">closed formula for the antiderivative; this doesn’t exist.</span></p>
<p><span class="cmss-10x-x-109">Thus, computing integrals is much simpler to do numerically. This is in stark contrast with differentiation, which is easy to do symbolically but hard numerically.</span></p>
</section>
<section id="numerical-integration" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_213"><span class="titlemark"><span class="cmss-10x-x-109">14.2.4 </span></span> <span id="x1-24000016.2.4"></span><span class="cmss-10x-x-109">Numerical integration</span></h3>
<p><span class="cmss-10x-x-109">Instead of using</span> <span id="dx1-240001"></span><span class="cmss-10x-x-109">symbolic computation to</span> <span id="dx1-240002"></span><span class="cmss-10x-x-109">get the exact value of an integral, we will resolve to approximation once again. Previously, </span><span class="cmssi-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-234006r91"><span class="cmssi-10x-x-109">91</span></a> <span class="cmss-10x-x-109">showed us that an integral is the limit of the Riemann-sums:</span></p>
<div class="math-display" >
  <span>
    ∫<sub>a</sub><sup>b</sup> f(x) dx = lim<sub>n→∞</sub> ∑<sub>i=1</sub><sup>n</sup> f(ξ<sub>i</sub>) (x<sub>i,n</sub> − x<sub>i−1,n</sub>),
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.10)</span>
</div>

<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">X</span><sub><span class="cmmi-8">n</span></sub> = <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span><span class="cmmi-8">,n</span></sub><span class="cmmi-10x-x-109">,…,x</span><sub><span class="cmmi-8">n,n</span></sub><span class="cmsy-10x-x-109">} </span><span class="cmss-10x-x-109">is a partition of</span> [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">i</span></sub> <span class="cmsy-10x-x-109">∈ </span>[<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span><span class="cmmi-8">,n</span></sub><span class="cmmi-10x-x-109">,x</span><sub><span class="cmmi-8">i,n</span></sub>] <span class="cmss-10x-x-109">are arbitrary intermediate values.</span></p>
<p><span class="cmss-10x-x-109">In other words, if </span><span class="cmmi-10x-x-109">n </span><span class="cmss-10x-x-109">is large enough, the sum </span><span class="cmex-10x-x-109">∑</span> <sub><span class="cmmi-8">i</span><span class="cmr-8">=1</span></sub><sup><span class="cmmi-8">n</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">i</span></sub>)(<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i,n</span></sub> <span class="cmsy-10x-x-109">−</span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span><span class="cmmi-8">,n</span></sub>) <span class="cmss-10x-x-109">is close to </span><span class="cmex-10x-x-109">∫</span> <sub><span class="cmmi-8">a</span></sub><sup><span class="cmmi-8">b</span></sup><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx</span><span class="cmss-10x-x-109">. There are two crucial issues: first, how to select the partition and the intermediate values; second, how fast is the convergence?</span></p>
<p><span class="cmss-10x-x-109">If we want to make (</span><a href="ch022.xhtml#numerical-integration"><span class="cmss-10x-x-109">14.11</span></a><span class="cmss-10x-x-109">) useful, we have to devise a concrete method that prescribes the </span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span></sub><span class="cmss-10x-x-109">-s, </span><span class="cmmi-10x-x-109">ξ</span><sub><span class="cmmi-8">i</span></sub><span class="cmss-10x-x-109">-s, and tells us how large of an </span><span class="cmmi-10x-x-109">n </span><span class="cmss-10x-x-109">we should select. This is an extremely rich subject that has been the focus of studies ever since the introduction of integration. So, there is a lot to talk about here. To keep things simple, let’s just focus on the essentials.</span></p>
<p><span class="cmss-10x-x-109">The most straightforward method is to select a uniform partition, then approximate the area under the function curve with a sequence of trapezoids.</span></p>
<p><span class="cmss-10x-x-109">That is, let </span><span class="cmmi-10x-x-109">X </span>= <span class="cmsy-10x-x-109">{</span><span class="cmmi-10x-x-109">a,a </span>+ <img src="../media/file1403.png" width="25" data-align="middle" alt="b−a n"/><span class="cmmi-10x-x-109">,a </span>+ 2<img src="../media/file1404.png" width="25" data-align="middle" alt="b−a n"/><span class="cmmi-10x-x-109">,…,b</span><span class="cmsy-10x-x-109">} </span><span class="cmss-10x-x-109">be an equidistant partition, which we’ll use to estimate the integral via calculating the areas determined by the trapezoids given by the partition and the graph, as illustrated in </span><span class="cmssi-10x-x-109">Figure </span><a href="#"><span class="cmssi-10x-x-109">14.7</span></a><span class="cmss-10x-x-109">.</span></p>
<div class="minipage">
<p><img src="../media/file1405.png" width="399" alt="PIC"/> <span id="x1-240003r7"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.7: Approximating the area under a function with successive trapezoids</span> </span>
</div>
<p><span class="cmss-10x-x-109">As the trapezoid’s area is given by </span><span class="cmmi-10x-x-109">h</span><img src="../media/file1406.png" width="25" data-align="middle" alt="a+2b"/><span class="cmss-10x-x-109">, the area under the curve in</span> [<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span><span class="cmsy-8">−</span><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">,x</span><sub><span class="cmmi-8">i</span></sub>] <span class="cmss-10x-x-109">is approximated by</span></p>
<img src="../media/file1407.png" class="math-display" alt=" f (xi) + f(xi− 1) b− a (xi − xi−1)------2-------= -2n-(f(xi)+ f (xi− 1)) " width="450"/>
<p><span class="cmss-10x-x-109">and we</span> <span id="dx1-240004"></span><span class="cmss-10x-x-109">have</span> <span id="dx1-240005"></span><span class="cmss-10x-x-109">the approximation</span></p>
<div style="display: flex; justify-content: space-between; align-items: center; max-width: 600px;" class="equation math-display">
  <div class="math-display">
    <img src="../media/file1408.png" alt="L(U,V ) = {f : U → V | f is linear}" width="450" />
  </div>
  <div style="padding-left: 1em; ">
    <!-- Label goes here, e.g. (4.2) -->(14.11)
  </div>
</div>

<p><span class="cmss-10x-x-109">This is the trapezoidal rule. It might seem complicated, but (</span><a href="ch022.xhtml"><span class="cmss-10x-x-109">14.11</span></a><span class="cmss-10x-x-109">) is just a weighted sum of the </span><span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span></sub>) <span class="cmss-10x-x-109">values.</span></p>
<p><span class="cmss-10x-x-109">Its rate of convergence is quadratic, as stated by the following theorem.</span></p>
<div class="newtheorem">
<p><span class="head"> <span id="x1-240006r97"></span> <span class="cmbx-10x-x-109">Theorem 97.</span> </span><span class="cmbxti-10x-x-109">(Trapezoidal rule)</span></p>
<p><span class="cmti-10x-x-109">Let </span><span class="cmmi-10x-x-109">f </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmti-10x-x-109">be a twicely differentiable function, and let</span></p>
<div class="math-display">
<img src="../media/file1409.png" class="math-display" alt=" n I := 1-∑ f(xi−-1)+-f(xi)- n n 2 i=1 "/>
</div>
<p><span class="cmti-10x-x-109">be the approximation given by the trapezoidal rule. Then</span></p>
<div class="math-display">
<img src="../media/file1410.png" class="math-display" alt=" ∫ b 3 | f (x )dx − In| = O((b-−-a)-). a n2 "/>
</div>
</div>
<p><span class="cmss-10x-x-109">There are</span> <span id="dx1-240007"></span><span class="cmss-10x-x-109">other methods, for instance, Simpson’s rule approximates the function</span> <span id="dx1-240008"></span><span class="cmss-10x-x-109">with a</span> <span id="dx1-240009"></span><span class="cmss-10x-x-109">piecewise quadratic one. (Instead of a piecewise linear one, like the trapezoidal rule.) Since the approximation is more accurate, the convergence is also faster: Simpson’s rule converges at a </span><span class="cmmi-10x-x-109">O</span>(<span class="cmmi-10x-x-109">n</span><sup><span class="cmsy-8">−</span><span class="cmr-8">4</span></sup>) <span class="cmss-10x-x-109">rate. Without going into details, it is given by</span></p>
<div class="math-display" >
  <span>
    S<sub>n</sub> = <img src="../media/file1411.png" class="frac" data-align="middle" alt="b − a ----- 3n"/>
    ∑<sub>i=1</sub><sup>⌊n/2⌋</sup> (
    f(x<sub>2i−2</sub>) + 4f(x<sub>2i−1</sub>) + f(x<sub>2i</sub>)
    ),
  </span>
  <span class="math-label" style="float: right; margin-left: 1em;">(14.12)</span>
</div>

<p><span class="cmss-10x-x-109">with error</span></p>
<div class="math-display">
<img src="../media/file1414.png" class="math-display" alt=" ∫ b 5 | f(x)dx − S | = O((b-−-a)-), a n n4 "/>
</div>
<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span></sub> <span class="cmss-10x-x-109">is again the equidistant partition </span><span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">i</span></sub> = <span class="cmmi-10x-x-109">a </span>+ <span class="cmmi-10x-x-109">i</span><img src="../media/file1415.png" width="25" data-align="middle" alt="b−na"/><span class="cmss-10x-x-109">.</span></p>
<p><span class="cmss-10x-x-109">The formula (</span><a href="#"><span class="cmss-10x-x-109">14.12</span></a><span class="cmss-10x-x-109">) can be difficult to unpack, but the essence remains the same: we compute the function’s values at given points, then take their weighted sum.</span></p>
</section>
<section id="implementing-the-trapezoidal-rule" class="level4 subsectionHead">
<h3 class="subsectionHead" id="sigil_toc_id_214"><span class="titlemark"><span class="cmss-10x-x-109">14.2.5 </span></span> <span id="x1-24100016.2.5"></span><span class="cmss-10x-x-109">Implementing the trapezoidal rule</span></h3>
<p><span class="cmss-10x-x-109">To show you how</span> <span id="dx1-241001"></span><span class="cmss-10x-x-109">straightforward</span> <span id="dx1-241002"></span><span class="cmss-10x-x-109">the trapezoidal rule is, let’s implement it in practice! To keep it simple, we are implementing this as a function that takes another function as its input.</span></p>
<div id="tcolobox-276" class="tcolorbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-contnt">
<pre class="lstinputlisting"><code>def trapezoidal_rule(f, a, b, n): 
    # Define the partition of the interval [a, b] 
    partition = [a + i*(b - a)/n for i in range(n+1)] 
 
    # Evaluate the function at each partition point 
    vals = [f(x) for x in partition] 
 
    # Apply the trapezoidal rule 
    I_n = (b - a) / (2 * n) * (vals[0] + vals[-1]) + (b - a) / n * sum(vals[1:-1]) 
 
    return I_n</code></pre>
</div>
</div>
<p><span class="cmss-10x-x-109">This can be made even simpler with NumPy, but I’ll leave this to you as an exercise. Let’s test it on an example instead!</span></p>
<p><span class="cmss-10x-x-109">With the use of the Newton-Leibniz formula (</span><span class="cmssi-10x-x-109">Theorem </span><a href="ch022.xhtml#x1-235004r92"><span class="cmssi-10x-x-109">92</span></a><span class="cmss-10x-x-109">), you can verify that</span></p>
<div class="math-disply">
<img src="../media/file1416.png" width="150" class="math-display" alt="∫ 1 x2dx = 1. 0 3 "/>
</div>
<p><span class="cmss-10x-x-109">(We even computed this with our bare hands, using lower and upper sums.) After</span> <span id="dx1-241016"></span><span class="cmss-10x-x-109">plugging</span> <span id="dx1-241017"></span><span class="cmss-10x-x-109">the function </span><span class="cmtt-10x-x-109">lambda x: x**2 </span><span class="cmss-10x-x-109">into </span><span class="cmtt-10x-x-109">trapezoidal_rule</span><span class="cmss-10x-x-109">, we can see that this method is indeed correct.</span></p>
<div id="tcolobox-277" class="tcolorbox">
<div class="tcolorbox-title">

</div>
<div class="tcolorbox-contnt">
<pre class="lstinputlisting"><code>import matplotlib.pyplot as plt 
 
with plt.style.context("/span&gt;seaborn-v0_8": 
    plt.figure() 
    ns = range(1, 25, 1) 
    Is = [trapezoidal_rule(lambda x: x**2, 0, 1, n) for n in ns] 
    plt.axhline(y=1/3, color=’r’, label="/span&gt;the true integral 
    plt.scatter(ns, Is, label="/span&gt;trapezoidal_rule(f, a, b, n) 
    plt.ylim([0.3, 0.52]) 
    plt.title("/span&gt;the trapezoidal rule 
    plt.show()</code></pre>
</div>
</div>
<div class="minipage">
<p><img src="../media/file1417.png" width="427" alt="PIC"/> <span id="x1-241029r8"></span></p>
<span class="id"><span class="cmss-10x-x-109">Figure 14.8: The trapezoidal rule</span> </span>
</div>
</section>
</section>
<section id="summary13" class="level3 sectionHead">
<h2 class="sectionHead" id="sigil_toc_id_215"><span class="titlemark"><span class="cmss-10x-x-109">14.3 </span></span> <span id="x1-24200016.3"></span><span class="cmss-10x-x-109">Summary</span></h2>
<p><span class="cmss-10x-x-109">In this chapter, we have learned about integration, one of the technically most challenging subjects so far. Intuitively, the integral of a function describes the signed area under its graph, but mathematically, it is given by the limit</span></p>
<div class="math-display">
<img src="../media/file1418.png" class="math-display" alt="∫ b ∑n f(x)dx = lim (xi − xi− 1)f (xi), a n→∞ k=1 "/>
</div>
<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">a </span>= <span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">0</span></sub><span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmr-8">1</span></sub><span class="cmmi-10x-x-109">/span&gt;<span class="cmmi-10x-x-109">…/span&gt;<span class="cmmi-10x-x-109">x</span><sub><span class="cmmi-8">n</span></sub> = <span class="cmmi-10x-x-109">b </span><span class="cmss-10x-x-109">is a partition of the interval</span> [<span class="cmmi-10x-x-109">a,b</span>]<span class="cmss-10x-x-109">. Of course, we don’t often calculate integrals by the definition; we have the Newton-Leibniz formula for that:</span> </span></span></span></p>
<div class="math-display">
<img src="../media/file1419.png" class="math-display" alt="∫ b f (x )dx = F (b)− F (a), a "/>
</div>
<p><span class="cmss-10x-x-109">where </span><span class="cmmi-10x-x-109">F </span><span class="cmss-10x-x-109">is the so-called </span><span class="cmssi-10x-x-109">antiderivative</span><span class="cmss-10x-x-109">, satisfying </span><span class="cmmi-10x-x-109">F</span><sup><span class="cmsy-8">′</span></sup>(<span class="cmmi-10x-x-109">x</span>) = <span class="cmmi-10x-x-109">f</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmss-10x-x-109">. This is why integration is thought of as the inverse of differentiation.</span></p>
<p><span class="cmss-10x-x-109">As one of my professors used to say, symbolic differentiation is easy, numeric differentiation is hard. It’s the opposite for integrals: symbolic integration is hard, and numeric integration is easy. We’ve learned a couple of tricks to pin down the symbolic part, namely the integration by parts formula</span></p>
<div class="math-display">
<img src="../media/file1420.png" class="math-display" alt="∫ ∫ b ′ x=b b ′ a f(x)g(x)dx = [f(x)g(x)]x=a − a f(x)g (x)dx "/>
</div>
<p><span class="cmss-10x-x-109">and the integration by substitution formula</span></p>
<div class="math-display">
<img src="../media/file1421.png" class="math-display" alt="∫ b ∫ g(b) f(g(y))g′(y)dy = f(x)dx. a g(a) "/>
</div>
<p><span class="cmss-10x-x-109">When symbolic integration is hard (and it’s almost always hard), we can resort to numerical methods, such as the Simpson’s rule, given by</span></p>
<div class="math-display">
<img src="../media/file1422.png" class="math-display" alt="∫ b b − a⌊n∑∕2⌋ f(x)dx ∼ ----- (f(x2i−2) + 4f(x2i− i) + f(x2i)). a 3n i=1 "/>
</div>
<p><span class="cmss-10x-x-109">Although integration is quite technical and complicated, its proper exposition is extremely important if you want to understand mathematics. The idea of approximating complex shapes with a sequence of rectangles (as shown in </span><span class="cmssi-10x-x-109">Figure </span><a href="#"><span class="cmssi-10x-x-109">14.3</span></a><span class="cmss-10x-x-109">) is the foundation of measure theory, which, in turn, is the foundation of probability theory. (Hell, the idea of approximating complex objects with simpler ones is </span><span class="cmssi-10x-x-109">the foundation of mathematics</span><span class="cmss-10x-x-109">.)</span></p>
<p><span class="cmss-10x-x-109">By now, we have mastered differentiation and integration for single-variable functions. However, univariate functions are rare in practice: in machine learning, we often deal with millions or billions of variables. To handle them in practice, we’ll generalize all we’ve learned to higher dimensions. This is the subject of </span><span class="cmssi-10x-x-109">multivariable </span><span class="cmss-10x-x-109">calculus, our next big milestone. Let’s get to it!</span></p>
</section>
<section id="problems13" class="level3 sectionHead">
<h2 class="sectionHead" id="sigil_toc_id_216"><span class="titlemark"><span class="cmss-10x-x-109">14.4 </span></span> <span id="x1-24300016.4"></span><span class="cmss-10x-x-109">Problems</span></h2>
<p><span class="cmssbx-10x-x-109">Problem 1. </span><span class="cmss-10x-x-109">Use integration by parts to find the following antiderivates.</span></p>
<p><span class="cmssi-10x-x-109">(a) </span><span class="cmex-10x-x-109">∫</span> sin(<span class="cmmi-10x-x-109">x</span>)cos(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">dx </span><span class="cmssi-10x-x-109">(b) </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">xe</span><sup><span class="cmmi-8">x</span></sup><span class="cmmi-10x-x-109">dx </span><span class="cmssi-10x-x-109">(c) </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup><span class="cmmi-10x-x-109">e</span><sup><span class="cmmi-8">x</span></sup><span class="cmmi-10x-x-109">dx </span><span class="cmssi-10x-x-109">(d) </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">e</span><sup><span class="cmmi-8">x</span></sup> sin<span class="cmmi-10x-x-109">xdx</span></p>
<p><span class="cmssbx-10x-x-109">Problem 2. </span><span class="cmss-10x-x-109">Use integration by substitution to find the following antiderivatives.</span></p>
<p><span class="cmssi-10x-x-109">(a) </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">x</span>cos(<span class="cmmi-10x-x-109">x</span><sup><span class="cmr-8">2</span></sup>)<span class="cmmi-10x-x-109">dx </span><span class="cmssi-10x-x-109">(b) </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">sin</span>(<span class="cmmi-10x-x-109">x</span>)<span class="cmmi-10x-x-109">e</span><sup><span class="cmsy-8">{</span><span class="cmss-8">-x</span></sup>2<span class="cmsy-10x-x-109">}</span><span class="cmmi-10x-x-109">dx </span><span class="cmssi-10x-x-109">(c) </span><span class="cmex-10x-x-109">∫</span> <img src="../media/file1423.png" class="frac" data-align="middle" alt="sinx cosx-"/> <span class="cmssi-10x-x-109">(d) </span><span class="cmex-10x-x-109">∫ </span><span class="cmmi-10x-x-109">x</span><img src="../media/file1424.png" class="sqrt" alt="√x2-+-1"/><span class="cmmi-10x-x-109">dx</span></p>
<p><span class="cmssbx-10x-x-109">Problem 3. </span><span class="cmss-10x-x-109">Let </span><span class="cmmi-10x-x-109">f </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmss-10x-x-109">be an integrable function. Show that</span></p>
<div class="math-display">
<img src="../media/file1425.png" class="math-display" alt="∫ b ∫ b | f(x)dx| ≤ |f(x)|dx. a a "/>
</div>
<p><span class="cmssbx-10x-x-109">Problem 4. </span><span class="cmss-10x-x-109">Let </span><span class="cmmi-10x-x-109">f,g </span>: [<span class="cmmi-10x-x-109">a,b</span>] <span class="cmsy-10x-x-109">→</span><span class="msbm-10x-x-109">ℝ </span><span class="cmss-10x-x-109">be two integrable functions such that </span><span class="cmmi-10x-x-109">jfj</span><sup><span class="cmr-8">2</span></sup> <span class="cmss-10x-x-109">and </span><span class="cmmi-10x-x-109">jgj</span><sup><span class="cmr-8">2</span></sup> <span class="cmss-10x-x-109">are integrable as well. Show that</span></p>
<div class="math-display">
<img src="../media/file1426.png" class="math-display" alt=" ∫ ∫ ∫ b 2 b 2 b 2 | a f(x)g(x)dx| ≤ a |f(x)| dx a |g(x)| dx. "/>
</div>
<p><span class="cmssi-10x-x-109">Hint: </span><span class="cmss-10x-x-109">revisit </span><span class="cmssi-10x-x-109">Chapter 2 </span><span class="cmss-10x-x-109">about normed spaces, and find an inequality that feels similar to this one.</span></p>
<p><span class="cmssbx-10x-x-109">Problem 5. </span><span class="cmss-10x-x-109">The famous Dirichlet function is defined by</span></p>
<div class="math-display">
<img src="../media/file1427.png" class="math-display" alt=" ( |{ 1 if x ∈ ℚ, D (x) = |( 0 otherwise. "/>
</div>
<p><span class="cmss-10x-x-109">Is </span><span class="cmmi-10x-x-109">D</span>(<span class="cmmi-10x-x-109">x</span>) <span class="cmss-10x-x-109">integrable?</span></p>
</section>
<section id="join-our-community-on-discord14" class="level3 likesectionHead">
<h2 class="likesectionHead" id="sigil_toc_id_217"><span id="x1-244000"></span><span class="cmss-10x-x-109">Join our community on Discord</span></h2>
<p><span class="cmss-10x-x-109">Read this book alongside other users, Machine Learning experts, and the author himself. Ask questions, provide solutions to other readers, chat with the author via Ask Me Anything sessions, and much more. Scan the QR code or visit the link to join the community.</span> <a href="https://packt.link/math" class="url"><span class="cmtt-10x-x-109">https://packt.link/math</span></a></p>
<p><img src="../media/file1.png" width="85" alt="PIC"/></p>
</section>
</section>
</body>
</html>