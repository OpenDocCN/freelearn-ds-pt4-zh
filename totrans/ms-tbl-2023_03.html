<html><head></head><body>
<section epub:type="chapter">&#13;
<section id="ch03lvl1sec12">&#13;
<div class="epub-source">&#13;
<h1 class="chapterTitle">Using Tableau Prep Builder</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">Tableau Prep Builder was <a/>introduced with version 2018.1 of Tableau Desktop, but what can we use Tableau Prep Builder (henceforth referred to in this chapter as <em class="italic">Prep</em>) for? The core purpose of the tool is data preparation. The good news is, Prep is fully compatible with Tableau Desktop, and also with Tableau Server. That means you can execute jobs in Prep to clean your data with the click of a button. Additionally, Prep is as visual as its big brother, Tableau Desktop, meaning that you can see every step of data preparation in a fully visual format.</p>&#13;
    <p class="normal">Therefore, let’s dive into <a/>the <strong class="keyWord">Graphical User Interface</strong> (<strong class="keyWord">GUI</strong>) and be amazed by another high-end product, which will allow you to get initial data insights, enabling you to decide faster whether your dataset is worth analysis. Prep will pave the way for an even smoother Tableau Desktop experience.</p>&#13;
    <p class="normal">In this chapter, the following topics will be discussed:</p>&#13;
    <ul><li class="bulletList">Connecting to data</li>&#13;
      <li class="bulletList">The Prep GUI</li>&#13;
      <li class="bulletList">Data quality</li>&#13;
      <li class="bulletList">Additional options with Prep</li>&#13;
      <li class="bulletList">Exporting data</li>&#13;
    </ul><p class="normal">In order to get started, we need to load data. How to do so in Prep will be described in the following section.</p>&#13;
    </div>&#13;
</div>&#13;
</section>&#13;
<section id="ch03lvl1sec13">&#13;
<div class="epub-source">&#13;
<h1 class="heading-1">Connecting to data</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">If you are <a/>familiar with Tableau Desktop, Prep will be an easy game for you. The handling and interfaces are very similar, and connecting to <a/>data, if the connector is available in Prep, works the same whether it’s a text file, a database, or an extract. At first sight, you might not even notice a difference between Prep and the Tableau Desktop GUIs, which provides the handy advantage that you can start prepping right away.</p>&#13;
    <p class="normal">To get started, begin by opening Prep and click on <strong class="keyWord">+</strong> to open a file. The following screen will appear:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_01.png" alt=""/></figure><p class="packt_figref">Figure 3.1: Connecting to data</p>&#13;
    <p class="normal">From the preceding screenshot, we can see that you can choose the type of data you want to connect to in the search bar. Just as in Tableau, the repertoire of Prep includes multiple databases.</p>&#13;
    <p class="normal">Now let’s connect to a dataset with a practical exercise. For this exercise, we need the following dataset: <a href="https://www.kaggle.com/airbnb/boston" target="_blank"><span class="url">https://www.kaggle.com/airbnb/boston</span></a>. Please download <code class="inlineCode">calendar.csv</code>, <code class="inlineCode">listings.csv</code>, and <code class="inlineCode">reviews.csv</code>. Alternatively, download them from the repository associated with this chapter on Tableau Public: <a href="https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/tree/main/Chapter03" target="_blank"><span class="url">https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/tree/main/Chapter03</span></a>.</p>&#13;
    <p class="normal">First, we are going to start with the <code class="inlineCode">calendar.csv</code> file. Add it to the empty Prep canvas by making a connection with a text file, followed by the selection of your <code class="inlineCode">.csv</code> file. You will now see the following screen:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_02.png" alt="A screenshot of a cell phone  Description automatically generated"/></figure><p class="packt_figref">Figure 3.2: Input data</p>&#13;
    <p class="normal">Congratulations—you’ve<a/> just made your first Prep connection. Here, you <a/>can manipulate and visualize your connected dataset as required!</p>&#13;
    <p class="normal">In the following section, I will describe the GUI in more detail.</p>&#13;
    </div>&#13;
</div>&#13;
</section>&#13;
<section id="ch03lvl1sec14">&#13;
<div class="epub-source">&#13;
<h1 class="heading-1">The Prep GUI</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">User experience<a/> is an important topic, not only when you build a dashboard but also when you use other aspects of Tableau. One of the biggest selling points of Tableau is and has always been the ease of using the GUI, and it is only one of the reasons Tableau is a much-loved tool by its customers.</p>&#13;
    <p class="normal">The Prep GUI has two important canvases to look at. Right after you have connected data to Prep, the workspace will split into several parts:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_03.png" alt="Graphical user interface, text, application  Description automatically generated"/></figure><p class="packt_figref">Figure 3.3: Prep workspace sections</p>&#13;
    <p class="normal">Let’s look<a/> at what we can see from the preceding screenshot:</p>&#13;
    <p class="normal"><strong class="screenText">A</strong>: The connection pane, showing you the input files available at the location selected.</p>&#13;
    <p class="normal"><strong class="screenText">B</strong>: The flow pane, which shows your current Prep flow. This always starts with an input step.</p>&#13;
    <p class="normal"><strong class="screenText">C</strong>: The input pane settings, which give you several options to configure your input.</p>&#13;
    <p class="normal"><strong class="screenText">D</strong>: The input pane samples, showing the fields you moved to the connection pane, including sample values.</p>&#13;
    <p class="normal">In the input pane (<strong class="screenText">C</strong>), you can use the wildcard union (multiple files) function to add multiple files from the same directory. Also, you can limit the sample set that Prep will print in order to increase performance. In the input pane samples (<strong class="screenText">D</strong>), you can select and deselect the fields you want to import and change their data types. The data type options are, for example, strings, dates, or numbers.</p>&#13;
    <p class="normal">The second GUI is the profile pane. Once you’ve selected the input data needed, click on the <strong class="keyWord">+</strong> in the flow pane and select <strong class="screenText">Add: Clean Step</strong>. Now the profile pane will appear with the data grid:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_04.png" alt=""/></figure><p class="packt_figref">Figure 3.4: Cleaning data</p>&#13;
    <p class="normal">In the <a/>preceding screenshot, the profile pane shows every column from the data source in two sections. The upper sections show aggregates. For example, column 2, <strong class="keyWord">date</strong>, shows the number of rows per date in a small histogram. The columns can all be sorted by clicking on the sort icon (a mini bar chart that appears when your mouse is hovering over a column) next to the column name and by selecting one item. Let’s take, for example, <strong class="keyWord">True</strong>, in <strong class="keyWord">available</strong> (column 3). All related features will be highlighted:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_05.png" alt=""/></figure><p class="packt_figref">Figure 3.5: Visual filtering</p>&#13;
    <p class="normal">This gives you the chance to get some insights into the data before we even start to clean it up. In the following screenshot, each row is shown as it is in the data source in the lower part of the profile pane:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_06.png" alt=""/></figure><p class="packt_figref">Figure 3.6: Data overview</p>&#13;
    <p class="normal">So far we <a/>have seen that, after loading data in Prep, visual filters can be applied by clicking on a field or bar in one of the columns. The lower pane will always show the data source of the selection made at the row level. Next, we will continue by adding more data sources.</p>&#13;
    <h2 class="heading-2">Getting to know Prep</h2>&#13;
    <p class="normal">Let’s start <a/>with a practical example:</p>&#13;
    <p class="normal">Next to the <code class="inlineCode">calendar.csv</code> file, connect to the following files:</p>&#13;
    <ul><li class="bulletList"><code class="inlineCode">listings.csv</code></li>&#13;
      <li class="bulletList"><code class="inlineCode">reviews.csv</code></li>&#13;
    </ul><p class="normal">Now, drag them onto the flow pane:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_07.png" alt=""/></figure><p class="packt_figref">Figure 3.7: Multiple tables input</p>&#13;
    <p class="normal">Can you answer the following questions?</p>&#13;
    <ul><li class="bulletList">How many listings use the word “beach” in their description?</li>&#13;
      <li class="bulletList">What is the percentage of condominiums that are marked with “exact location”?</li>&#13;
      <li class="bulletList">On which day were the most reviews entered?</li>&#13;
    </ul><p class="normal">Without a<a/> tool like Prep, it is much more difficult to find the solution to these types of questions. Prep makes our data analytics journey much faster and easier and that is exactly the reason why I encourage you to spend the additional time and learn Prep as well as Tableau Desktop!</p>&#13;
    <div class="note">&#13;
      <p class="normal">Solutions can be found in the workbook associated with this chapter at the following link: <a href="https://public.tableau.com/profile/marleen.meier" target="_blank"><span class="url">https://public.tableau.com/profile/marleen.meier</span></a>.</p>&#13;
    </div>&#13;
    <p class="normal">Here you see, as an example, I used the <strong class="keyWord">sort</strong> function on <strong class="keyWord">date</strong> in order to answer the third question: <em class="italic">On which day were the most reviews entered?</em></p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_08.png" alt=""/></figure><p class="packt_figref">Figure 3.8: Sorting by date</p>&#13;
    <p class="normal">As you can see, sorting<a/> this field ordered the dates by the number of entries, thus making it very simple to answer the question, <em class="italic">on which day were the most reviews entered?</em> After the first few clicks, it already starts to feel natural, doesn’t it?</p>&#13;
    <p class="normal">All the changes you made to the dataset can be traced back on the left side of the profile pane. But don’t forget to add a proper name to each step: this will make it much easier for others, and yourself, to understand your process.</p>&#13;
    <p class="normal">So, let’s continue on to the data quality features of Prep.</p>&#13;
    </div>&#13;
</div>&#13;
</section>&#13;
<section id="ch03lvl1sec15">&#13;
<div class="epub-source">&#13;
<h1 class="heading-1">Data quality</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">Prep<a/> comes with lots of different features. Sometimes, you<a/> might use many different tools to prepare your dataset in order to get it in the shape you desire. Other times, you might just run an aggregation (one feature) and be done. It really depends on the dataset itself and the expected output. The fact is, the closer your Prep output data is to what you need for your Tableau Desktop visualization, the more efficiently VizQL will run on Tableau Desktop. Fewer queries in Tableau Desktop means faster generation of dashboards.</p>&#13;
    <p class="normal">To me, the <a/>best part about Prep is that it can handle a huge <a/>amount of data. Sometimes, I even use it for datasets I don’t want to visualize in Tableau Desktop, just to get a quick overview of, for example, how many rows contain a specific word, how many columns are needed, what happens to the date range if I filter a particular value, and so on! Within a few minutes, I have insights that would have taken me much more time to get with database queries or Excel functions. I hope that by the end of this chapter, you will be able to cut your time spent data prepping in half (at least). We will divide the prepping features into five subcategories: cleaning, unions and joins, aggregating, pivoting, and scripting. Let’s start with cleaning data!</p>&#13;
    <h2 class="heading-2">Cleaning data</h2>&#13;
    <p class="normal">We have<a/> seen the following canvas before in the <em class="italic">The Prep GUI</em> section. To create the cleaning step, the user can simply click on <strong class="keyWord">+</strong> next to the input and select <strong class="keyWord">Add: Clean Step</strong>. During the cleaning step, multiple operations can be performed, such as filtering or creating a calculated field. Also note the recommendations Prep gives you:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_09.png" alt=""/></figure><p class="packt_figref">Figure 3.9: Recommendations</p>&#13;
    <p class="normal">Prep analyzes the column content and proposes changes that might fit the data. The column <strong class="screenText">listing_url</strong>, for example, is being recognized as a web page and therefore Prep recommends you change it to the data role URL. The second, third, and several more recommendations after <strong class="screenText">listing_url</strong> are to remove certain columns. This is probably the case because the column does not contain any data or contains only a small amount of data. The list goes on.</p>&#13;
    <p class="normal">This feature<a/> can be very useful, especially for unfamiliar datasets. My way of working would be to look at the recommendations, check whether they make sense, and execute the change—or not. Don’t blindly trust these recommendations, but they can point out data flaws you might have missed otherwise.</p>&#13;
    <p class="normal">Data is often messy, involving null values, typos from manual entries, different formatting, changes in another system, and so on. As a consequence, you will have to sort out the mess before you can get reliable results from an analysis or a dashboard. This section will show you how to clean data at the column level.</p>&#13;
    <p class="normal">Once a value is selected within your clean step, you have the option to <strong class="screenText">Keep Only</strong>, <strong class="screenText">Exclude</strong>, <strong class="screenText">Edit Value</strong>, or <strong class="screenText">Replace with Null</strong>:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_10.png" alt=""/></figure><p class="packt_figref">Figure 3.10: Quick access</p>&#13;
    <p class="normal">None of these changes will change the data source itself. Prep is like an in-between step, or a filter between the original data source and your Tableau Desktop. Excluding a value, using the option you can see in Figure 3.10, will only remove it from Prep. However, if used later on as input for Tableau Desktop, there won’t be an option to add that specific value back in. This option will remain in Prep only.</p>&#13;
    <p class="normal">Another slightly hidden option is to click on the ellipses (<strong class="screenText">...</strong>) next to the column headers (as shown in <em class="italic">Figure 3.11</em>) and select <strong class="screenText">Clean</strong>:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_11.png" alt=""/></figure><p class="packt_figref">Figure 3.11: More options</p>&#13;
    <p class="normal">This <strong class="keyWord">Clean</strong> functionality <a/>operates based on the data type <a/>of the column. In the preceding screenshot, the data type is a string (indicated by the <strong class="keyWord">Abc</strong> icon). For other data types, the option will be grayed out since <strong class="keyWord">Clean</strong> is only available for strings. The option allows you to make use of eight more cleaning features:</p>&#13;
    <ul><li class="bulletList">Make Uppercase</li>&#13;
      <li class="bulletList">Make Lowercase</li>&#13;
      <li class="bulletList">Remove Letters</li>&#13;
      <li class="bulletList">Remove Numbers</li>&#13;
      <li class="bulletList">Remove Punctuation</li>&#13;
      <li class="bulletList">Trim Spaces</li>&#13;
      <li class="bulletList">Remove Extra Spaces</li>&#13;
      <li class="bulletList">Remove All Spaces</li>&#13;
    </ul><p class="normal">The data type can be changed just above each column header; you will find a symbol above the column name, which can be changed by clicking on it, just like in Tableau Desktop:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_12.png" alt=""/></figure><p class="packt_figref">Figure 3.12: Changing Data Type</p>&#13;
    <p class="normal">This comes in<a/> handy in case Prep misinterprets the data type of a column. A wrongly assigned data type can have an effect on the calculation you perform on it and how Tableau Desktop would visualize the column.</p>&#13;
    <p class="normal">In the upcoming section, we will practice combining multiple datasets. You might want to combine, for example, order data with shipment data (using a join) or append 2020 sales data to your 2019 sales dataset (using a union). To find out how, read on!</p>&#13;
    <h2 class="heading-2">Unions and joins</h2>&#13;
    <p class="normal">We will now <a/>join the three datasets, so that we may analyze and visualize them together. The nature of the three datasets (<code class="inlineCode">listings.csv</code>, <code class="inlineCode">reviews.csv</code>, and <code class="inlineCode">calendar.csv</code>) requires a join but not a union. However, I will still walk you through the steps of a union in order for you to know when you need it!</p>&#13;
    <h3 class="heading-3">Adding unions</h3>&#13;
    <p class="normal">A union in Tableau is <a/>the appending of data to an existing dataset. Imagine you have two Excel files. Both have the exact same header, but one contains data from 2019, and the other data from 2020. If you union the 2020 data to the 2019 data, you <a/>append the rows of the 2020 files to add them underneath the rows of the 2019 files. To perform a union, both datasets need to have almost the same layout/header. Why almost? You will see in the following exercise:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">To begin this exercise, your Prep flow pane should look like this:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_13.png" alt=""/></figure><p class="packt_figref">Figure 3.13: Flow pane</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="2">Add a<a/> clean step by clicking <strong class="keyWord">+</strong> next to the <strong class="screenText">listings</strong> dataset.&#13;
    <p class="normal">You can change the color of each step according to your preferences by right-clicking on a step and selecting <strong class="keyWord">Edit Color</strong>.</p></li>&#13;
    </ol><ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="3">Select the column <strong class="screenText">host_identity_verified</strong> and filter on <strong class="screenText">True</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_14.png" alt=""/></figure><p class="packt_figref">Figure 3.14: Filtering on True</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="4">Now, create a<a/> calculated field, called <code class="inlineCode">DatasetA_ID</code>, containing <a/>just a string, <code class="inlineCode">'A'</code>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_15.png" alt=""/></figure><p class="packt_figref">Figure 3.15: Creating a calculated field</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="5">Create a <a/>second cleaning step from the same<a/> listings data and filter this time on <strong class="screenText">True</strong> in the <strong class="screenText">host_identity_verified</strong> column:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_16.png" alt=""/></figure><p class="packt_figref">Figure 3.16: Filtering on True</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="6">Create a <a/>calculated field, <code class="inlineCode">DatasetB_ID</code>, containing<a/> just a string, <code class="inlineCode">'B'</code>, using the same process shown in <em class="italic">Figure 3.15</em>. Renaming the steps by right-clicking and hitting <strong class="keyWord">Rename</strong> helps to keep track of the applied changes. Your flow should look like the following:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_17.png" alt=""/></figure><p class="packt_figref">Figure 3.17: Visual flow</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="7">You have<a/> now created two datasets that can be combined using a union, without changing the original data. Union the two <a/>by either selecting <strong class="screenText">Union</strong> after clicking on <strong class="keyWord">+</strong> next to <strong class="screenText">Dataset A</strong> or by dragging one step over the other (<strong class="screenText">Dataset B</strong> over <strong class="screenText">Dataset A</strong> or vice versa):</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_18.png" alt=""/></figure><p class="packt_figref">Figure 3.18: Union</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="8">Check whether all fields match by clicking on <strong class="screenText">Union 1</strong> and looking at the input details at the bottom left of the screen:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_19.png" alt=""/></figure><p class="packt_figref">Figure 3.19: Visual check</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="9">In the <a/>preceding screenshot, you can see <a/>that on the left, you have information about the union. From top to bottom: the <strong class="screenText">Inputs</strong> and their respective colors (these are the same as in the flow pane), the <strong class="screenText">Resulting Fields</strong>, showing 2 mismatching fields, and finally, the <strong class="screenText">Mismatched Fields</strong> themselves: <strong class="screenText">DatasetA_ID</strong> and <strong class="screenText">DatasetB_ID</strong>. The colors next to each mismatched field show that our <strong class="screenText">DatasetB_ID</strong> field does not exist in <strong class="screenText">DatasetA</strong>, and the <strong class="screenText">DatasetA_ID</strong> field does not exist in <strong class="screenText">DatasetB</strong>.</li>&#13;
      <li class="numberedList">In this case, we know that those columns can be appended even despite the different naming conventions. A better name for both fields would have been <strong class="screenText">Dataset_ID</strong> (you can go a few steps back and try this out). Prep will not show any mismatches then. But for us here, we can go ahead and drag and drop one field on top of the other to merge them and thereby give Prep the permission to view them as one column:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_20.png" alt=""/></figure><p class="packt_figref">Figure 3.20: Merge</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="11">See how<a/> the <strong class="screenText">Resulting Fields</strong> now show 0 mismatches, and<a/> how both dataset colors are now represented in the bar underneath the column header:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_21.png" alt=""/></figure><p class="packt_figref">Figure 3.21: Color coding</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="12">Rename by selecting and right-clicking the union step from <strong class="keyWord">Union 1</strong> to <strong class="keyWord">listings2</strong>, and add a description by selecting and right-clicking the union step and hitting <strong class="keyWord">Add Description</strong> if you like—all the extra effort you make now will help you later with replication, documentation, and explanation.</li>&#13;
    </ol><p class="normal">Congratulations; your<a/> first union was a success. We first split the <a/>original listings dataset in to two and then combined them again into one. Stacking data with the same layout on top of each other, as we’ve done here, is a typical task for unions.</p>&#13;
    <h3 class="heading-3">Wildcard unions</h3>&#13;
    <p class="normal">Instead of <a/>dragging one data input on top of another, as <a/>we did in the previous section, you can also tell Prep which files to union from a pre-defined directory. Oftentimes, departments have a shared location in which they store, for example, Excel files that are named something such as <strong class="keyWord">Jan2023Revenue</strong>, <strong class="keyWord">Feb2023Revenue</strong>, <strong class="keyWord">Mar2023Revenue</strong>, and so on. If you come across such a scenario, you can do the following:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">Connect Prep to any one file that you want to use.</li>&#13;
      <li class="numberedList">Click on the input data icon and select the <strong class="screenText">Tables</strong> tab. You can now see that you can create a union given a certain condition:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_22.png" alt=""/></figure><p class="packt_figref">Figure 3.22: The Tables menu view</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="3">I will <a/>select all matching filenames in that <a/>same directory that start with something (<strong class="screenText">*</strong>) and end with <strong class="screenText">2023Revenue.xlsx</strong>, and as you can see, Jan, Feb, and March will all be included, and you can even filter the input by using the <strong class="keyWord">File</strong> and <strong class="keyWord">Worksheet</strong> filter, and clicking <strong class="keyWord">Apply</strong> when you are done::</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_23.png" alt=""/></figure><p class="packt_figref">Figure 3.23: Filtering the unions</p>&#13;
    <p class="normal">This is the <a/>wildcard <a/>union feature. It is really powerful! Try it out and see for yourself.</p>&#13;
    <h3 class="heading-3">Adding joins</h3>&#13;
    <p class="normal">Now, we <a/>will <a/>continue to work in the same <a/>flow pane and focus on a join. As a quick refresher, a join appends data horizontally. As a rule of thumb, unions increase the number of rows and joins change the number of columns:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">Drag <strong class="screenText">listings2</strong> onto <strong class="keyWord">reviews</strong> until the <strong class="screenText">Join</strong> option appears.</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_24.png" alt=""/></figure><p class="packt_figref">Figure 3.24: Join</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="2">Select <strong class="screenText">listing_id</strong> from <strong class="screenText">reviews</strong> and <strong class="screenText">id</strong> from <strong class="screenText">listings2</strong> for your join. Please note<a/> that you can<a/> change the join type by clicking on the Venn diagram under <strong class="screenText">Join Type</strong>:&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_25.png" alt=""/></figure><p class="packt_figref">Figure 3.25: Visual check join</p>&#13;
    <p class="normal">What<a/> the preceding overview tells us is that all <code class="inlineCode">68,275</code> rows of the <strong class="screenText">reviews</strong> dataset were matched to a row in the <strong class="screenText">listing2</strong> dataset. However, we do have <code class="inlineCode">756</code> mismatches from the <strong class="screenText">listing2</strong> dataset. Our total <strong class="screenText">Join Result</strong> is therefore <code class="inlineCode">68,275</code> rows. But it is likely that not all <a/>listings have reviews and therefore we can safely assume that our join worked as expected.</p></li>&#13;
    </ol><ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="3">Another check could be to change the join to a full outer join and dive deeper into the data later in Tableau Desktop. In order to get to a full outer join, simply click on the outer edge of the two circles:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_26.png" alt=""/></figure><p class="packt_figref">Figure 3.26: Full join</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="4">If you want to <a/>check immediate results, simply <a/>right-click on, for example, the join symbol (represented by the Venn diagram icon, as shown in the following screenshot), and you’ll be able to check the data in Tableau Desktop by selecting <strong class="screenText">Preview in Tableau Desktop</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_27.png" alt=""/></figure><p class="packt_figref">Figure 3.27: Preview</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="5">We can also rename the step; let’s change our join’s name to <code class="inlineCode">lis&amp;rev</code>.</li>&#13;
    </ol><p class="normal">By now, we’ve seen how to clean data, and how to use unions and joins. The union part taught us how to append data vertically or underneath each other. The join <a/>part allowed us to combine data horizontally or next to each other. More specifically, we were able to combine the listings with their respective <a/>reviews. Instead of having two datasets, we have created one that allows us to look up a listing review, and in the same row, view all the data regarding the listing itself, like the type of listing, number of bedrooms, whether it has an ocean view, and so on.</p>&#13;
    <p class="normal">Let’s continue next with the aggregation step.</p>&#13;
    <h2 class="heading-2">Aggregating</h2>&#13;
    <p class="normal">An <a/>aggregation is used<a/> when you want to change the granularity of your data. In our dataset, we have one row per review. However, we want to see if hosts that have been in the Airbnb business in Boston longer have more reviews compared to hosts that started more recently. In order to do so, we need to get an aggregated number of reviews per year that the host started offering listings. The <strong class="screenText">host_since</strong> field will give us helpful information as well as the <strong class="screenText">reviewer_id</strong> field. For the latter, we will count the distinct reviewers that left reviews. Let’s do it!</p>&#13;
    <p class="normal">Our current flow pane looks like this:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_28.png" alt=""/></figure><p class="packt_figref">Figure 3.28: Flow pane</p>&#13;
    <p class="normal">To aggregate the number of reviews, please take the following steps:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">First, click on the <strong class="screenText">+</strong> sign next to <strong class="screenText">lis&amp;rev</strong> and choose <strong class="screenText">Aggregate</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_29.png" alt=""/></figure><figure class="mediaobject">Figure 3.29: Aggregate</figure><ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="2">This will open a window entitled <strong class="screenText">Aggregate 1</strong>. Our goal is to see how many people<a/> reviewed accommodation per year from when the host started offering listings; therefore, take the following actions.<ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">Using the<a/> search field in the <strong class="screenText">Additional Fields</strong> pane, as can be seen on the left in <em class="italic">Figure 3.30</em>, add the <strong class="screenText">host_since</strong> field to <strong class="screenText">Grouped Fields</strong> by dragging and dropping.</li>&#13;
          <li class="numberedList">Add the <strong class="screenText">reviewer_id</strong> to <strong class="screenText">Aggregated Fields</strong>, also by dragging and dropping. Note that the default aggregation is <strong class="screenText">SUM</strong>, as indicated by the arrow on the right:</li>&#13;
        </ol><figure class="mediaobject"><img src="../images/B18435_03_30.png" alt=""/></figure><p class="packt_figref">Figure 3.30: Aggregated fields</p>&#13;
      </li>&#13;
      <li class="numberedList">Change the <strong class="screenText">reviewer_id</strong> aggregation by clicking on <strong class="screenText">SUM</strong> under <strong class="screenText">Aggregated Fields</strong>, and change it to <strong class="screenText">Count Distinct</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_31.png" alt=""/></figure><p class="packt_figref">Figure 3.31: Count Distinct</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="4">This <a/>will change the default aggregation, <strong class="screenText">Sum</strong> (where every review is counted), to <strong class="screenText">Count Distinct</strong>, which counts the distinct reviewer ID aggregation. This<a/> will allow us to focus on how many different reviewers left reviews. This is just an arbitrary choice; feel free to try out the other aggregations and see how the data changes.</li>&#13;
    </ol><p class="normal">Let’s have a look at the Tableau Desktop preview by right-clicking on the <strong class="keyWord">Aggregate</strong> step on our flow pane and selecting <strong class="keyWord">Preview in Tableau Desktop</strong>:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_32.png" alt=""/></figure><p class="packt_figref">Figure 3.32: Host chart</p>&#13;
    <p class="normal">In the preceding<a/> screenshot, we can see the distinct count of reviews per <strong class="screenText">host_since</strong> date. Of course, in this specific example, Tableau Desktop <a/>could also count the reviews per <strong class="screenText">host_since</strong> date if those were the only fields dragged onto the view without the help of Prep. But a benefit of aggregating prior to importing the data into Tableau Desktop is that you have less data to import; hence, it’s possible to achieve better performance. If you want to continue analyzing the dataset in either Prep or Tableau Desktop, you can now ask further questions, such as the following:</p>&#13;
    <ul><li class="bulletList">Which type of accommodation has the highest discount for staying a week rather than a day?</li>&#13;
      <li class="bulletList">Is there a correlation between the size of the accommodation and the monthly price?</li>&#13;
      <li class="bulletList">How many hosts (as a percentage) have more than one listing?</li>&#13;
    </ul><p class="normal">Good luck and happy dashboard building!</p>&#13;
    <p class="normal">We’ll finish<a/> this section here and look back at a graph consisting<a/> of only 9 datapoints, which we created by aggregating the almost 64,000 rows of <strong class="screenText">reviewer_id</strong> data by the year that the host started offering the listing. The graph tells a story; 64,000 individual rows of data don’t. That is why it is so important to always reduce your data, and aggregate it if possible. In the next section, we will talk about another important feature: pivoting.</p>&#13;
    <h2 class="heading-2">Pivoting</h2>&#13;
    <p class="normal">Do you recognize a<a/> situation where you drag and drop your fields onto your Tableau Desktop row and column shelves but somehow the visualization doesn’t do what you want? Chances are that you have to turn your data, or better, pivot it. If <a/>data that you expect to be in one column, spread over multiple rows, appears in multiple columns instead, it’s a case for pivoting. The following example will showcase a need for pivoting.</p>&#13;
    <p class="normal">For our pivot example, we will make use of another dataset. You can find it at <a href="https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter03/Excel_Pivot.xlsx" target="_blank"><span class="url">https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter03/Excel_Pivot.xlsx</span></a>. The dataset is very simple and looks like this:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_33.png" alt=""/></figure><p class="packt_figref">Figure 3.33: Excel input</p>&#13;
    <p class="normal">It has three different colors that were observed on five different days, <em class="italic">x</em> amount of times. This data is a typical example of when pivoting is helpful to tidy up the data because multiple columns have the same purpose—<strong class="screenText">B</strong>, <strong class="screenText">C</strong>, and <strong class="screenText">D</strong> are all observations. If you wanted to visualize this table, it could look like the following:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_34.png" alt="Chart, line chart  Description automatically generated"/></figure><p class="packt_figref">Figure 3.34: Pivot I</p>&#13;
    <p class="normal">But you<a/> might <a/>be wondering, since the color scheme already indicates which color has been observed, wouldn’t it be better to put all three lines in one graph? With separate lines per color, within one line chart? Let’s accomplish this!</p>&#13;
    <p class="normal">Begin by connecting the <code class="inlineCode">PivotDataSet</code> to Prep, then follow these steps to pivot the data:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">From Prep, connect to the Excel file we just created and add <strong class="screenText">PivotDataSet</strong> to the flow pane, click on the <strong class="keyWord">+</strong> next to the input data step, and select <strong class="screenText">Pivot</strong>. A new step called <strong class="screenText">Pivot 1</strong> will appear:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_35.png" alt=""/></figure><p class="packt_figref">Figure 3.35: Adding a Pivot step</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="2">Click on<a/> the <strong class="screenText">Pivot 1</strong> step in the flow pane, and <em class="italic">Figure 3.36</em> will appear at the bottom of your Prep window. Select all three <a/>colors from the <strong class="keyWord">Fields</strong> pane shown in <strong class="keyWord">Step I</strong>, and drag them onto the <strong class="screenText">Pivoted Fields</strong> pane, as shown in <strong class="keyWord">Step II</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_36.png" alt=""/></figure><p class="packt_figref">Figure 3.36: Pivot steps</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="3">Now, have a look at the <strong class="screenText">Pivot Results</strong> pane, as shown in <strong class="keyWord">Step III</strong> of the preceding screenshot, and rename <strong class="screenText">Pivot1 Names</strong> to <strong class="screenText">Colors</strong> and <strong class="screenText">Pivot1 Values</strong> to <strong class="screenText">Observations</strong> by right-clicking and selecting <strong class="keyWord">Rename</strong>. Now click the <strong class="screenText">+</strong> next to <strong class="screenText">Pivot 1</strong>, and voilà, we now have a clean table, called <strong class="screenText">Clean 1</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_37.png" alt=""/></figure><p class="packt_figref">Figure 3.37: Pivot results</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="4">Remember<a/> our problem from the beginning? Our line<a/> chart can now be created in a different way, as shown in <em class="italic">Figure 3.38</em>. Note that <strong class="screenText">Colors</strong> is a dimension now and the <strong class="screenText">Observations</strong> are their own field, compared to before when they were located under the column header of each color:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_38.png" alt="Chart, line chart  Description automatically generated"/></figure><p class="packt_figref">Figure 3.38: Pivoted line chart</p>&#13;
    <div class="note">&#13;
      <p class="normal">This is a simple use case for pivoting, but the technique here can be transferred to any other dataset. Prep has a built-in recommendation feature. Whenever you see a light bulb in the upper-right corner of a column, check it out and see if the recommendation applies to your needs.</p>&#13;
    </div>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_39.png" alt=""/></figure><p class="packt_figref">Figure 3.39: Trim spaces</p>&#13;
    <p class="normal">In this case, Tableau<a/> recommends we remove all leading and trailing spaces, which is exactly what we need! As demonstrated here, it’s always worth checking the recommendations.</p>&#13;
    <p class="normal">Perfect; you <a/>are all set with the main Prep functionality. However, you might be wondering what you are supposed to do if you require any further preparation. No problem; Prep has you covered. Scripting is the newest addition to Prep and the most powerful of all; it is virtually limitless! Continue reading to explore Prep’s scripting feature.</p>&#13;
    <h2 class="heading-2">Scripting</h2>&#13;
    <p class="normal">The<a/> script functionality that we will discuss next is one of the <a/>features more recently added to Tableau. We will discuss it next because a programming language like <code class="inlineCode">Python</code> or <code class="inlineCode">R</code> gives you endless flexibility. If you ever reach the boundaries of Prep’s offerings, you can fall back on scripting and write your own code to do exactly what you want.</p>&#13;
    <p class="normal">In order to make use of it, you have to connect to Python (or R), outside of Tableau first. The following steps are based on the instructions from <a href="https://help.tableau.com/current/prep/en-us/prep_scripts_TabPy.htm" target="_blank"><span class="url">https://help.tableau.com/current/prep/en-us/prep_scripts_TabPy.htm</span></a> for Python or <a href="https://help.tableau.com/current/prep/en-us/prep_scripts._R.htm" target="_blank"><span class="url">https://help.tableau.com/current/prep/en-us/prep_scripts._R.htm</span></a> for R.</p>&#13;
    <p class="normal">For this <a/>exercise, we will be using the Boston Airbnb dataset, more <a/>specifically the <code class="inlineCode">calendar</code> table. Download this dataset from <a href="https://www.kaggle.com/airbnb/boston" target="_blank"><span class="url">https://www.kaggle.com/airbnb/boston</span></a> and connect to the <code class="inlineCode">calendar</code> table in Prep:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_40.png" alt="A screenshot of a cell phone  Description automatically generated"/></figure><p class="packt_figref">Figure 3.40: Calendar dataset</p>&#13;
    <p class="normal">Now, let’s take a step back and connect Python to Prep:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">Download and install <code class="inlineCode">Python</code> from <a href="http://python.org" target="_blank"><span class="url">python.org</span></a> (or download and install <code class="inlineCode">R</code> from <a href="https://www.r-project.org/" target="_blank"><span class="url">https://www.r-project.org/</span></a>).</li>&#13;
      <li class="numberedList">Download and install <code class="inlineCode">TabPy</code> by executing the following command in your terminal or on the command line:&#13;
        <pre class="programlisting code"><code class="hljs-code">pip install tabpy&#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numberedList">Alternatively, if using <code class="inlineCode">R</code>, open <code class="inlineCode">R</code> and execute:&#13;
        <pre class="programlisting code"><code class="hljs-code">install.packages(<span class="hljs-string">"Rserve"</span>, , <span class="hljs-string">"http://rforge.net"</span>)&#13;
</code></pre>&#13;
      </li>&#13;
      <li class="numberedList">Open <code class="inlineCode">TabPy</code> on the command line/terminal by entering the following command:&#13;
        <pre class="programlisting con"><code class="hljs-con">tabpy&#13;
</code></pre>&#13;
      &#13;
    <p class="normal">Or, in the R GUI, type:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con">library(Rserve)&#13;
Rserve()&#13;
</code></pre></li>&#13;
    </ol><ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="5">Back in Prep, click on <strong class="screenText">+</strong> on the<a/> right-hand side of the calendar table and add a <strong class="screenText">Clean Step</strong>.</li>&#13;
      <li class="numberedList">Add a<a/> calculated field called <strong class="screenText">PythonTest</strong> (use <strong class="screenText">RTest</strong><strong class="keyWord"> </strong>instead if you’ve chosen to experiment with <code class="inlineCode">R</code>) with a string value, <code class="inlineCode">"Test"</code>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_41.png" alt=""/></figure><p class="packt_figref">Figure 3.41: PythonTest</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="7">Now, click on <strong class="screenText">+</strong> on the right-hand side of the <strong class="screenText">Clean 1</strong> step and add <strong class="keyWord">Script</strong>.</li>&#13;
      <li class="numberedList">By selecting the <strong class="keyWord">Script</strong> step, the <strong class="keyWord">Settings</strong> pane at the bottom (see <em class="italic">Figure 3.42</em>) will give you an option to connect to <strong class="screenText">Rserve</strong> or <strong class="screenText">TabPy</strong><strong class="keyWord">. Rserve</strong> is the Tableau server for <code class="inlineCode">R</code> and <code class="inlineCode">TabPy</code> is the Tableau server for Python.</li>&#13;
      <li class="numberedList">Choose your connection type by selecting <strong class="screenText">Rserve</strong> or <strong class="screenText">Tableau Python (TabPy) Server</strong>. Then open <strong class="keyWord">Help</strong> | <strong class="keyWord">Settings and Performance</strong> | <strong class="keyWord">Manage Analytics Extension Connection</strong>. In the upcoming window, connect Prep to <code class="inlineCode">TabPy</code> by using <strong class="screenText">localhost</strong> and <strong class="screenText">Port 9004</strong> (if using R, connect to Rserve by selecting it under <strong class="screenText">Connection type</strong> and using <strong class="keyWord">localhost</strong> and <strong class="keyWord">Port 6311</strong> in the same popup), and click <strong class="keyWord">Sign In</strong>:<ul><li class="bulletList">If using an SSL-encrypted Rserve server, <strong class="screenText">Port 4912</strong> is the default port.</li>&#13;
        </ul><figure class="mediaobject"><img src="../images/B18435_03_42.png" alt=""/></figure><p class="packt_figref">Figure 3.42: TabPy Server</p>&#13;
      </li>&#13;
      <li class="numberedList">Next, if <a/>experimenting with Python, create a <code class="inlineCode">.py</code> file <a/>containing the following code and make sure the indentation is exactly the same:&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_43.png" alt=""/></figure><p class="packt_figref">Figure 3.43: The .py file</p>&#13;
    <p class="normal">Alternatively, create a <code class="inlineCode">.R</code> file containing the following code:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Get ChangeString<span class="hljs-operator">&lt;-</span> add_column<span class="hljs-punctuation">(</span>&#13;
.data<span class="hljs-punctuation">,</span> &#13;
.before <span class="hljs-operator">=</span> <span class="hljs-string">'Test'</span>&#13;
.after <span class="hljs-operator">=</span> <span class="hljs-string">'R'</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>&#13;
Return <span class="hljs-punctuation">(</span>data.frame <span class="hljs-punctuation">())</span>&#13;
<span class="hljs-punctuation">}</span>&#13;
</code></pre></li>&#13;
    </ol><ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="11">The <a/>script we just created is written to change an<a/> existing column in Prep and rename every row from <code class="inlineCode">Test</code> to <code class="inlineCode">Python</code> or <code class="inlineCode">R</code>, depending on which language you’ve chosen.</li>&#13;
      <li class="numberedList">We’ll continue with the Python script. Back in Prep, browse for the <code class="inlineCode">.py</code> file we just created and add the function name to the Prep interface. I called the file <code class="inlineCode">PrepTableau.py</code> and the function name is <code class="inlineCode">ChangeString</code>, as defined in the preceding step:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_44.png" alt=""/></figure><p class="packt_figref">Figure 3.44: Adding a function</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="13">Observe that the <strong class="keyWord">PythonTest</strong> column has changed from <strong class="keyWord">Test</strong> to <strong class="keyWord">Python</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_45.png" alt=""/></figure><p class="packt_figref">Figure 3.45: PythonTest</p>&#13;
    <p class="normal">Our little <a/>experiment worked! And even though we used a very<a/> simplistic example, it shows that the scripting feature works, and you can just follow your creativity with what else you might be able to do by using scripting. Examples include everything from calculating an inverse normal distribution to machine learning with sentiment analysis or clustering.</p>&#13;
    <p class="normal">You might have noticed that we did not import <code class="inlineCode">pandas</code> in the script itself, but still used a <code class="inlineCode">pandas</code> DataFrame. This is due to the fact that the <code class="inlineCode">pandas</code> import comes with <code class="inlineCode">TabPy</code>. You can see this in your command line/terminal after opening <code class="inlineCode">TabPy</code>:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_46.png" alt=""/></figure><p class="packt_figref">Figure 3.46: Importing pandas on the command line</p>&#13;
    <p class="normal">If you want to use other libraries in your script, you can install them by using <code class="inlineCode">pip</code> <code class="inlineCode">install</code> on your <a/>command line/terminal. You only have to restart <code class="inlineCode">TabPy</code> afterward and you will be <a/>able to use them too. Remember, always open <code class="inlineCode">TabPy</code> on the terminal/command line first, or else Prep can’t execute the script.</p>&#13;
    <div class="note">&#13;
      <p class="normal">At the time of writing, Prep does not support a script as input yet—you could, however, use a dummy <code class="inlineCode">.csv</code> file as a workaround and add a script to the flow immediately after it.</p>&#13;
    </div>&#13;
    </div>&#13;
</div>&#13;
</section>&#13;
<section id="ch03lvl1sec16">&#13;
<div class="epub-source">&#13;
<h1 class="heading-1">Additional options with Prep</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">This <a/>section will discuss some smaller standalone, very powerful, and new Prep features. Some of you might have been using Prep since the very first release. With each release and each additional user and feedback given, Tableau was able to create a priority list of features that stakeholders—like you and I—really wished to see. The upcoming topics are some of the best examples. None of these features were present in the initial release but have made the product so much better, more valuable, and more complete. You are able now to save part of your flow and reuse it, write back your data to an external database, refresh parts of your dataset, and schedule flows with the Tableau Data Management add-on. Let’s take a closer look and start with the “insert flow” function.</p>&#13;
    <h2 class="heading-2">Insert Flow</h2>&#13;
    <p class="normal">An <a/>option in<a/> Prep is to add an existing flow to your own flow. For example, say someone already worked on the Boston Airbnb dataset and created a flow of the highlighted steps only:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_47.png" alt=""/></figure><p class="packt_figref">Figure 3.47: Save to File</p>&#13;
    <p class="normal">You could save the steps you wish to insert into your flow by right-clicking and selecting <strong class="screenText">Save to File</strong>, as shown in <em class="italic">Figure 3.47</em>. These steps could be inserted back into your flow by right-clicking on the canvas, selecting <strong class="screenText">Insert Flow</strong>, and browsing your <code class="inlineCode">.tfl</code> files for the <a/>previously downloaded file:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_48.png" alt=""/></figure><p class="packt_figref">Figure 3.48: Insert Flow</p>&#13;
    <p class="normal">This <a/>functionality is very convenient to share work and reuse already created steps. Next, we will look into another functionality that will allow you to refresh the data used in your Prep flow: incremental refresh.</p>&#13;
    <h2 class="heading-2">Incremental refresh</h2>&#13;
    <p class="normal">Prep 2020.2 saw<a/> the introduction <a/>of the incremental refresh feature. After completing a flow and adding an output, you can decide whether you want a full or incremental refresh, and which field you want to use as an indicator. Imagine you have a dataset of infections per day of a particular disease. By the end of every day, you want to add the new data, which comes from a health ministry database, to your dataset. So, what are you going to do?</p>&#13;
    <p class="normal">Typically, you would load the whole dataset, all of it, after the newest datapoints were added. But nothing changes about the datapoints older than that day; they will remain the same and you loaded them before already. Therefore, it is a waste of resources to reload the whole dataset. An incremental refresh will only load new datapoints and add them to the existing data, which has been built up over many days. You can imagine how much time and effort this will save. It is a much more sustainable way to keep your data up to date than a full refresh.</p>&#13;
    <p class="normal">We are going to look at an example in the following workflow. It is important that an <strong class="keyWord">Output</strong> step is part of the flow:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_49.png" alt=""/></figure><p class="packt_figref">Figure 3.49: Incremental refresh</p>&#13;
    <p class="normal">To <a/>add the<a/> incremental refresh, take the following steps:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">Click on the data input step and scroll down the <strong class="screenText">Settings</strong> tab until you see the <strong class="screenText">Incremental Refresh</strong> option. Then, check the <strong class="screenText">Enable incremental refresh</strong> box:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_50.png" alt=""/></figure><p class="packt_figref">Figure 3.50: Set up Incremental Refresh</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="2">After<a/> you click on the <strong class="screenText">Enable incremental refresh</strong> box, a dropdown will appear. This dropdown<a/> contains all fields that Prep finds useful as an indicator for a data refresh. Select, for example, the <strong class="screenText">date</strong><strong class="keyWord"> </strong>field<strong class="keyWord">. </strong>It is the perfect field to use since as soon as a new date is added to the original data source, the refresh will start.</li>&#13;
      <li class="numberedList">Prep will also ask you for the output field that will represent the <strong class="screenText">date</strong> column in the output. In our case, it is still <strong class="screenText">date</strong>:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_51.png" alt=""/></figure><p class="packt_figref">Figure 3.51: Select an output field</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="4">After <a/>everything is set up, click <a/>on the <strong class="screenText">Output</strong> step again and note how you can now select the type of refresh, full or incremental, you prefer for this flow by clicking on the drop-down menu on the <strong class="screenText">Run Flow</strong> option:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_52.png" alt=""/></figure><p class="packt_figref">Figure 3.52: Refresh options</p>&#13;
    <p class="normal">You just learned how to set up your data refresh—full as well as incremental. This will help you with the <a/>sustainable usage of compute<a/> resources and to always have your data up to date. Next, we will introduce another Tableau feature worth investigating—Bulk rename.</p>&#13;
    <h2 class="heading-2">Bulk rename</h2>&#13;
    <p class="normal">This <a/>feature is a real time-saver! Simply select as many columns as you want to rename, right-click, and select <strong class="screenText">Rename Fields</strong>. A new view will<a/> open that allows you to add a prefix or suffix to every selected column or you can replace specific text in each of them:</p>&#13;
    <figure class="mediaobject"><img src="../images/B18435_03_53.png" alt=""/></figure><p class="packt_figref">Figure 3.53: Bulk rename in action</p>&#13;
    <p class="normal">You could then also leverage the <strong class="screenText">Find Text</strong> function or automatically rename all new fields that might come in at a later stage, e.g., because IT added an additional column to your dataset.</p>&#13;
    <h2 class="heading-2">Tableau Prep Conductor</h2>&#13;
    <p class="normal">With <strong class="keyWord">Tableau Prep Conductor</strong>, you<a/> can publish your Prep flows to Tableau Server, schedule them to run at a certain time, and always have refreshed data. The conductor is available in the Tableau Data Management add-on and doesn’t ship with<a/> Tableau Desktop or Prep.</p>&#13;
    <div class="note">&#13;
      <p class="normal">For more information, please check <a href="https://www.tableau.com/products/add-ons/data-management" target="_blank"><span class="url">https://www.tableau.com/products/add-ons/data-management</span></a>.</p>&#13;
    </div>&#13;
    </div>&#13;
</div>&#13;
</section>&#13;
<section id="ch03lvl1sec17">&#13;
<div class="epub-source">&#13;
<h1 class="heading-1">Exporting data</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">Last, but <a/>not least, we may want to export our data. We have seen before that a right-click on a symbol in the flow pane offers the possibility to preview the data in Tableau Desktop:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="1">If you want a flow to run according to a schedule or save it to a location, it’s best to use <strong class="screenText">Add</strong> | <strong class="screenText">Output</strong><strong class="keyWord">.</strong></li>&#13;
      <li class="numberedList">After you do this, the following screen will appear:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_54.png" alt=""/></figure><p class="packt_figref">Figure 3.54: Save to file</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;"><li class="numberedList" value="3">The <a/>user now has the option to save the data to a file, and also to save it in Hyper file format as <code class="inlineCode">.hyper</code>, as <code class="inlineCode">.xlsx</code> (new in Tableau 2021.1), or as a <code class="inlineCode">.csv</code> file.</li>&#13;
      <li class="numberedList">Another option is to publish the newly generated data source directly to Tableau Server and make it available to other users. For this option, select <strong class="keyWord">Publish as a data source </strong>instead of<strong class="keyWord"> Save to File </strong>from the dropdown.</li>&#13;
      <li class="numberedList">A third option to save Prep output has been added to Tableau 2020.3: writing the resulting data to an external database. If you want to do so, select the <strong class="keyWord">Database</strong> table option from the dropdown. At the time of writing, seven databases are compatible with the write-back functionality, but more will be added based on user demand:</li>&#13;
    </ol><figure class="mediaobject"><img src="../images/B18435_03_55.png" alt=""/></figure><p class="packt_figref">Figure 3.55: Save to external database</p>&#13;
    <p class="normal">Since the Tableau release 2022.3, you can write back to CRM Analytics too. To do this, you need a Salesforce account and the according license. Therefore, we will not discuss this option further, but if you are a Salesforce Analytics user, check this out!</p>&#13;
    <p class="normal">This section has shown us how to save our work and, even more so, the output of our Prep flows. To me, the ability to save output to an external database is the best new feature, because it is the easiest way to share my output in a structured and organized way with others. So not <a/>only I but also other users can work with the prepped data, saving additional work. The flow can then be reused not only by me but by anyone.</p>&#13;
    </div>&#13;
</div>&#13;
</section>&#13;
<section id="ch03lvl1sec18">&#13;
<div class="epub-source">&#13;
<h1 class="heading-1">Summary</h1>&#13;
<div class="Basic-Text-Frame">&#13;
    <p class="normal">We started this chapter with an introduction to Prep. We looked at the GUI and how we can connect data to it. After that, we did some exercises regarding data preparation. This can be divided into five parts: data cleaning, unions and joins, aggregating, pivoting, and scripting. We also considered several additional options to improve the usefulness of your data, including inserting steps from other flows, and incremental refreshes. To round out this chapter on Prep, we looked at exporting data. Here, we saw that the new dataset can be saved as a file or data extract, written back to an external database, or pushed directly to Tableau Server.</p>&#13;
    <p class="normal">Just like Tableau Desktop, Prep is very much self-explanatory and highly visual. Colors, symbols, and highlights make it easy to get used to this extract, transform, and load tool, which is invaluable for preparing your data before manipulating it on the main Tableau interface!</p>&#13;
    <p class="normal">In the next chapter, we’ll continue our exploration of data in Tableau. We’ll explore how to prepare data for Tableau by looking at joins, blends, and data structures.</p>&#13;
    <h2 class="heading-1">Learn more on Discord</h2>&#13;
    <p class="normal">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</p>&#13;
    <p class="normal"><a href="https://packt.link/tableau" target="_blank"><span class="url">https://packt.link/tableau</span></a></p>&#13;
    <p class="normal"><img src="../images/QR_Code2044012316175764640.png" alt=""/></p>&#13;
  </div>&#13;
&#13;
&#13;
</div>&#13;
</section>&#13;
</section>&#13;
</body></html>