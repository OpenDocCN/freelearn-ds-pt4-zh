["```py\nif (!requireNamespace(\"BiocManager\"))\n    install.packages(\"BiocManager\")\nBiocManager::install()\n```", "```py\nlibrary(phyloseq)\n```", "```py\nbiom_file <- file.path(getwd(), \"datasets\", \"ch5\", \"rich_sparse_otu_table.biom\")\nqiime <- import_biom(biom_file)\n```", "```py\ntax_table(qiime)\n## Taxonomy Table:     [5 taxa by 7 taxonomic ranks]:\n##          Rank1         Rank2               Rank3                   \n## GG_OTU_1 \"k__Bacteria\" \"p__Proteobacteria\" \"c__Gammaproteobacteria\"\n## GG_OTU_2 \"k__Bacteria\" \"p__Cyanobacteria\"  \"c__Nostocophycideae\"\n\notu_table(qiime)\n## OTU Table:          [5 taxa and 6 samples]\n##                      taxa are rows\n##          Sample1 Sample2 Sample3 Sample4 Sample5 Sample6\n## GG_OTU_1       0       0       1       0       0       0\n## GG_OTU_2       5       1       0       2       3       1\n\nsample_data(qiime)\n##         BarcodeSequence  LinkerPrimerSequence BODY_SITE Description\n## Sample1    CGCTTATCGAGA CATGCTGCCTCCCGTAGGAGT       gut   human gut\n```", "```py\nmothur <- import_mothur(\n  mothur_list_file = file.path(getwd(), \"datasets\", \"ch5\", \"esophagus.fn.list\"),\n  mothur_group_file = file.path(getwd(), \"datasets\", \"ch5\", \"esophagus.good.groups\"),\n  mothur_tree_file = file.path(getwd(), \"datasets\", \"ch5\", \"esophagus.tree\")\n)\n```", "```py\notu_table(mothur)\n## OTU Table:          [591 taxa and 3 samples]\n##                      taxa are rows\n##          B C  D\n## 9_6_14   2 0  0\n## 9_6_25   1 0  0\n```", "```py\nlibrary(metacoder)\nbiom_file <- file.path(getwd(), \"datasets\", \"ch5\", \"rich_high_count_otu.biom\")\ntaxdata <- parse_qiime_biom(biom_file)\n```", "```py\nsample_ids <- paste0(\"Sample\", 1:6)\nhist_data <- colSums(taxdata$data$otu_table[, sample_ids])\nhist(hist_data, prob= TRUE, breaks=3)\nlines(density(hist_data, adjust = 2), col=\"red\")\n```", "```py\ntaxdata$data$rarefied_otus <- rarefy_obs(taxdata, \"otu_table\", other_cols = TRUE)\nlow_otu_index <- rowSums(taxdata$data$rarefied_otus[, sample_ids]) <=20\ntaxdata <- filter_obs(taxdata, \"rarefied_otus\", ! low_otu_index)\ntaxdata$data$rarefied_otus\n```", "```py\n## # A tibble: 4 x 8\n##   taxon_id otu_id   Sample1 Sample2 Sample3 Sample4 Sample5 Sample6\n##   <chr>    <chr>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n## 1 ax       GG_OTU_1      24    1004     847    1979    1070    1170\n## 2 ay       GG_OTU_2     872       0     704     500    1013     689\n## 3 ba       GG_OTU_4     875    1144    1211     217       0    1180\n## 4 ax       GG_OTU_5    1270     893     276     338     953       0\n```", "```py\nlibrary(dada2)\nlibrary(cowplot)\n\nfq_dir <- file.path(getwd(), \"datasets\", \"ch5\", \"fq\")\nread_files <- list.files(fq_dir, full.names = TRUE,  pattern = \"fq.gz\")\n\nquality_plots <- lapply(read_files, plotQualityProfile)\nplot_grid(plotlist = quality_plots)\n```", "```py\nfor (fq in read_files ){\n  out_fq <- paste0(fq, \".trimmed.filtered\")\n  fastqFilter(fq, out_fq, trimLeft=10, truncLen=250,\n                      maxN=0, maxEE=2, truncQ=2,\n                      compress=TRUE)\n}\n\ntrimmed_files <-  list.files(fq_dir, full.names = TRUE, pattern = \"trimmed.filtered\")\nderep_reads <- derepFastq(trimmed_files)\n```", "```py\ntrimmed_files <-  list.files(fq_dir, full.names = TRUE, pattern = \"trimmed.filtered\")\nderep_reads <- derepFastq(trimmed_files)\n\ndd_model <- dada(derep_reads[1:5], err=NULL, selfConsist=TRUE)\n```", "```py\ndada_all <- dada(derep_reads, err=dd_model[[1]]$err_out, pool=TRUE)\n```", "```py\nsequence_tb <-makeSequenceTable( dada_all )\ntaxonomy_tb <- assignTaxonomy(sequence_tb, refFasta = file.path(getwd(), \"datasets\", \"ch5\", \"rdp_train_set_14.fa\")) \ntaxonomy_tb[1, 1:6]\n```", "```py\n## Kingdom Phylum \n## \"Bacteria\" \"Cyanobacteria/Chloroplast\" \n## Class Order \n## \"Chloroplast\" \"Chloroplast\" \n## Family Genus \n## \"Bacillariophyta\" NA\n```", "```py\nlibrary(metacoder)\nlibrary(RColorBrewer)\nbiom_file <- file.path(getwd(), \"datasets\", \"ch5\", \"rich_high_count_otu.biom\")\ntaxdata <- parse_qiime_biom(biom_file)\n```", "```py\nheat_tree(taxdata, \n    node_label = taxon_names, \n    node_size = n_obs, \n    node_color = n_supertaxa, \n    layout = \"gem\", \n    title = \"sample heat tree\", \n    node_color_axis_label = \"Number of Supertaxa\", \n    node_size_axis_label = \"Number of OTUs\", \n    node_color_range = RColorBrewer::brewer.pal(5, \"Greens\")\n)\n```", "```py\nlibrary(vegan)\nbiom_file <- file.path(getwd(), \"datasets\", \"ch5\", \"rich_high_count_otu.biom\")\ntaxdata <- metacoder::parse_qiime_biom(biom_file)\notu_table <- taxdata$data$otu_table[, paste0(\"Sample\", 1:6)]\n```", "```py\nalpha_diversity <- diversity(otu_table, MARGIN=2, index=\"simpson\")\nbarplot(alpha_diversity)\n```", "```py\nbetween_sample <- vegdist(t(otu_table), index = \"bray\")\n\nbetween_sample_m <- as.matrix(between_sample, ncol = 6)\ncorrplot::corrplot(between_sample_m, method=\"circle\", type = \"upper\", diag = FALSE )\n```", "```py\nlibrary(kmer)\nlibrary(magrittr)\nlibrary(ape)\nseqs <- ape::read.fastq(file.path(getwd(), \"datasets\", \"ch5\",\"fq\", \"SRR9040914ab.fq.gz\")\notu_vec <- otu(seqs, k = 6, threshold = 0.99 )\n\n```", "```py\ndata.frame(\n    seqid = names(otu_vec), \n    cluster = otu_vec, \n    row.names = NULL) %>% \ndplyr::group_by(cluster) %>% \ndplyr::summarize(count = dplyr::n() )\n```"]