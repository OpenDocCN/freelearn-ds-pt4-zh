<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer037">
			<h1 id="_idParaDest-95"><em class="italic"><a id="_idTextAnchor096"/>Chapter 4</em>: Installing Pachyderm Locally</h1>
			<p>In the previous chapters, we learned about Pachyderm's architecture, the internals of the Pachyderm solution, and version control primitives such as repositories branches, and commits. We reviewed why reproducibility is essential and why it should be a part of a successful data science process. We also learned how to do this on all three major platforms – macOS, Linux, and Windows.</p>
			<p>There are many ways and a variety of platforms that enable you to run your end-to-end <strong class="bold">Machine Learning</strong> (<strong class="bold">ML</strong>) workflows using Pachyderm. We will start with the most common and easy to configure local deployment method on your computer; then, in the following chapters, we will review the deployment process on cloud platforms.</p>
			<p>This chapter will walk you through the process of installing Pachyderm locally so that you can get started quickly and test Pachyderm. This chapter will prepare you to run your first pipeline. We will provide an overview of the system requirements and guide you through the process of installing all the prerequisite software needed for Pachyderm to run smoothly. </p>
			<p>In this chapter, we're going to cover the following main topics:</p>
			<ul>
				<li><a id="_idTextAnchor097"/>Installing the required tools</li>
				<li>Installing minikube</li>
				<li>Installing Docker Desktop</li>
				<li>Installing the Pachyderm <strong class="bold">Command-Line Interface</strong> (<strong class="bold">CLI</strong>)</li>
				<li>Enabling autocompletion for Pachyderm</li>
				<li>Preparing the Kubernetes environment</li>
				<li>Deploying Pachyderm</li>
				<li>Accessing the Pachyderm dashboard</li>
				<li>Deleting an existing Pachyderm deployment</li>
			</ul>
			<h1 id="_idParaDest-96"><a id="_idTextAnchor098"/>Technical requirements</h1>
			<p>Whether you are on macOS, Windows, or Linux, you need to install the following tools:</p>
			<ul>
				<li>Homebrew</li>
				<li>The Kubernetes <strong class="bold">CLI</strong>; that is, via <strong class="source-inline">kubectl</strong></li>
				<li>Helm</li>
				<li>minikube </li>
				<li>Docker Desktop (as an alternative to minikube)</li>
				<li>The Pachyderm CLI; that is, via <strong class="source-inline">pachctl</strong></li>
				<li><strong class="bold">Windows Subsystem for Linux</strong> (<strong class="bold">WSL</strong>) for Windows installations</li>
			</ul>
			<p>We will get into the specifics of installing and configuring these tools as we go through this chapter. If you already know how to do this, you can go ahead and set them up now. </p>
			<h1 id="_idParaDest-97"><a id="_idTextAnchor099"/>Installing the required tools</h1>
			<p>In this section, we will cover how to install the system tools that we will use to prepare our environment before installing Pachyderm. </p>
			<h2 id="_idParaDest-98"><a id="_idTextAnchor100"/>Installing Homebrew (macOS only)</h2>
			<p>While Linux <a id="_idIndexMarker395"/>distributions have many package management options, there is no default package manager for macOS users. <strong class="bold">Homebrew</strong> (<strong class="source-inline">brew</strong>) fills this gap and provides a great solution to easily<a id="_idIndexMarker396"/> install and manage software from the macOS Terminal and Linux shell as an <a id="_idIndexMarker397"/>alternative to <strong class="bold">apt</strong>, <strong class="bold">yum</strong>, or <strong class="bold">flatpak</strong>, which are <a id="_idIndexMarker398"/>available in Linux distributions. </p>
			<p>Homebrew uses <strong class="bold">Git</strong> to download<a id="_idIndexMarker399"/> its updates. In Homebrew, packages are installed based on definitions known <a id="_idIndexMarker400"/>as <strong class="bold">Formulae</strong>. Homebrew installs software packages to the <strong class="bold">Cellar</strong>, which <a id="_idIndexMarker401"/>is located under the <strong class="source-inline">/user/local/Cellar</strong> directory. Another term you will hear often is <strong class="bold">Tap</strong>. Tap<a id="_idIndexMarker402"/> is a Git repository of Formulae.</p>
			<p>In this chapter, we will frequently use <strong class="source-inline">brew</strong> to install various software packages on macOS. Therefore, you need to install it if you are using macOS. The same <strong class="source-inline">brew</strong> commands we will use in this chapter run on Linux as well, but we will keep the use of brew for Linux optional:</p>
			<ol>
				<li>Execute<a id="_idIndexMarker403"/> the following command to install Homebrew on your computer:<p class="source-code"><strong class="bold">$ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</strong></p></li>
				<li>Execute the following command to verify that Homebrew has been installed, as well as to list the available commands:<p class="source-code"><strong class="bold">$ brew commands</strong></p></li>
			</ol>
			<p>The following screenshot shows the system's output:</p>
			<div>
				<div id="_idContainer028" class="IMG---Figure">
					<img src="Images/B17085_04_001.jpg" alt="Figure 4.1 – List of brew commands&#13;&#10;" width="1201" height="648"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.1 – List of brew commands</p>
			<ol>
				<li value="3">Let's learn about some of the useful Homebrew commands you may need in the future. You can update Homebrew itself by executing the following command:<p class="source-code"><strong class="bold">$ brew update</strong></p></li>
				<li>Execute the following command to find any outdated formulae:<p class="source-code"><strong class="bold">$ brew outdated</strong></p></li>
				<li>Execute<a id="_idIndexMarker404"/> the following command to upgrade all the outdated formulae:<p class="source-code"><strong class="bold">$ brew upgrade</strong></p></li>
			</ol>
			<p>Now that you have installed the Homebrew package manager on your computer, let's install <strong class="source-inline">kubectl</strong>.</p>
			<h2 id="_idParaDest-99"><a id="_idTextAnchor101"/>Installing Windows Subsystem for Linux (for Windows only)</h2>
			<p><strong class="bold">WSL</strong> is a tool that enables Windows users to run Linux commands and utilities natively in Windows. If you are<a id="_idIndexMarker405"/> using Windows, you can install WSL on your machine by following these steps:</p>
			<ol>
				<li value="1">Open PowerShell or the Windows Command Prompt.</li>
				<li>Install WSL by running the following command:<p class="source-code">wsl --install</p><p class="callout-heading">Important note</p><p class="callout">If you are on Windows, run all the Linux and Pachyderm commands described in this book from WSL.</p></li>
			</ol>
			<p>For more information, see the official<a id="_idIndexMarker406"/> Microsoft Windows documentation at https://docs.microsoft.com/en-us/windows/wsl/install.</p>
			<h2 id="_idParaDest-100"><a id="_idTextAnchor102"/>Installing the Kubernetes command-line tool</h2>
			<p>Before you<a id="_idIndexMarker407"/> create your first Kubernetes cluster, you need to install the Kubernetes command-line tool, <strong class="source-inline">kubectl</strong>, to execute commands against the cluster. Now, let's learn how to install <strong class="source-inline">kubectl</strong> on a computer.</p>
			<p>See the official Kubernetes<a id="_idIndexMarker408"/> documentation for more information: https://kubernetes.io/docs/home/. </p>
			<p>Follow these steps:</p>
			<ol>
				<li value="1">Execute the following commands to download and install <strong class="source-inline">kubectl</strong> on your computer: </li>
			</ol>
			<p>If you are using Linux, run the following command:</p>
			<p class="source-code"><strong class="bold">$ curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s </strong>https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl</p>
			<p class="source-code"><strong class="bold">$ chmod +x ./kubectl &amp;&amp; sudo mv ./kubectl /usr/local/bin/kubectl</strong></p>
			<p>If you are on macOS (Intel), run the following command:</p>
			<p class="source-code"><strong class="bold">$ curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/darwin/amd64/kubectl</strong></p>
			<p class="source-code"><strong class="bold">$ chmod +x ./kubectl &amp;&amp; sudo mv ./kubectl /usr/local/bin/kubectl</strong></p>
			<p>If you are on Windows, the following command will do the trick:</p>
			<p class="source-code"><strong class="bold">curl -LO https://dl.k8s.io/release/v1.22.0/bin/windows/amd64/kubectl.exe</strong></p>
			<ol>
				<li value="2">Verify the version you are using and make sure that <strong class="source-inline">kubectl</strong> is installed by executing the following command:<p class="source-code"><strong class="bold">$ kubectl version --short --client</strong></p></li>
			</ol>
			<p>Here is an example of the system's output: </p>
			<p class="source-code"><strong class="bold">Client Version: v1.22.3</strong></p>
			<p>To be able to <a id="_idIndexMarker409"/>perform the following commands, the <strong class="source-inline">kubectl</strong> version must be v1.19 or later.</p>
			<p>Now that you have <strong class="source-inline">kubectl</strong> installed on your computer to execute commands against your Kubernetes cluster, let's install Helm.</p>
			<h2 id="_idParaDest-101"><a id="_idTextAnchor103"/>Installing Helm v3</h2>
			<p>Helm<a id="_idIndexMarker410"/> is a popular package manager for Kubernetes clusters. Before you deploy Pachyderm by using its Helm chart, you need to install the Helm binary on your environment to be able to manage the life cycle of your Helm chart. Follow these steps to install Helm on your computer:</p>
			<ol>
				<li value="1">Execute the<a id="_idIndexMarker411"/> following command to download and install Helm on your computer: <p class="source-code"><strong class="bold">$ curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/</strong></p><p class="source-code"><strong class="bold">helm/helm/master/scripts/get-helm-3</strong></p><p class="source-code"><strong class="bold">$ chmod 700 get_helm.sh</strong></p><p class="source-code"><strong class="bold">$ ./get_helm.sh</strong></p></li>
				<li>Verify the version you are using and make sure Helm is installed by executing the following command:<p class="source-code"><strong class="bold">$ helm version --short</strong></p></li>
			</ol>
			<p>Here is an example of the system's output: </p>
			<p class="source-code"><strong class="bold">V3.7.1+g1d11fcb</strong></p>
			<p>Next, you must install the necessary tools to prepare your local Kubernetes cluster environment before you can deploy Pachyderm. If you are familiar with containers in Linux, you must be familiar with these tools. If you are using Linux as your local machine, follow the instructions provided in the <em class="italic">Installing minikube</em> section to prepare your environment. If you are using macOS, follow the instructions provided in the <em class="italic">Installing Docker Desktop</em> section. Using Docker Desktop is recommended due to <a id="_idTextAnchor104"/>its simplicity.</p>
			<h1 id="_idParaDest-102"><a id="_idTextAnchor105"/>Installing minikube</h1>
			<p><strong class="bold">Minikube</strong> is a <a id="_idIndexMarker412"/>popular cross-platform and lightweight Kubernetes implementation that helps users quickly create a single-node local Kubernetes <a id="_idIndexMarker413"/>cluster. minikube <a id="_idIndexMarker414"/>supports multiple <a id="_idIndexMarker415"/>runtimes, including <strong class="bold">CRI-O</strong>, <strong class="bold">container</strong>, and <strong class="bold">Docker</strong>. It can be deployed as a <strong class="bold">Virtual Machine</strong> (<strong class="bold">VM</strong>), a <a id="_idIndexMarker416"/>container, or on bare metal. Since Pachyderm supports the Docker runtime only, we will cover how to use the Docker container runtime and deploy it as a container. For additional configuration details, you can refer to the official Docker documentation at https://minikube.sigs.k8s.io/docs/start/. Let's install the latest version of minikube:</p>
			<ol>
				<li value="1">Execute the<a id="_idIndexMarker417"/> following commands to install <strong class="source-inline">minikube</strong> on your computer.</li>
			</ol>
			<p>If are using Linux, run the following command:</p>
			<p class="source-code"><strong class="bold">$ curl -LO </strong>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64</p>
			<p class="source-code"><strong class="bold">$ sudo install minikube-linux-amd64 /usr/local/bin/minikube</strong></p>
			<p>If you are on Windows (Chocolatey package manager is required), run the following command:</p>
			<p class="source-code"><strong class="bold">choco install minikube</strong></p>
			<ol>
				<li value="2">Verify the <strong class="source-inline">minikube</strong> version you are using and make sure that minikube has been installed by executing the following command:<p class="source-code"><strong class="bold">$ minikube version</strong></p></li>
			</ol>
			<p>The following is an example of the command's response:</p>
			<p class="source-code"><strong class="bold">minikube version: v1.22.0</strong></p>
			<p class="source-code"><strong class="bold">commit: a03fbcf166e6f74ef224d4a63be4277d017bb62e </strong></p>
			<p>Now that you have installed minikube installed, let's install Docker Desktop.</p>
			<h1 id="_idParaDest-103"><a id="_idTextAnchor106"/>Installing Docker Desktop</h1>
			<p>Docker simplifies developing, delivering, and running applications by separating applications from the infrastructure and its dependencies. Pachyderm supports the Docker container <a id="_idIndexMarker418"/>runtime only; therefore, Docker tools must be installed before you deploy Pachyderm. </p>
			<p>Docker runs as a native application using the macOS sandbox security model and installs all Docker tools on your macOS, including Docker Engine, the CLI, Docker Compose, Credential Helper, Notary, and Kubernetes.</p>
			<p>If you do not have Docker Desktop already installed, you can follow the instructions provided in the next section to install it. Otherwise, you can skip to the <em class="italic">Preparing your Kubernetes environment</em> section. You can also<a id="_idIndexMarker419"/> refer to the official Docker documentation at https://docs.docker.com/get-docker/.</p>
			<h2 id="_idParaDest-104"><a id="_idTextAnchor107"/>Installing Docker Desktop for macOS</h2>
			<p>Follow these steps to <a id="_idIndexMarker420"/>install Docker Desktop on macOS. The<a id="_idIndexMarker421"/> latest version of Docker is supported on the last three versions of macOS. If your macOS version is older than the last three versions, you need to upgrade it to the latest version of macOS:</p>
			<ol>
				<li value="1">Visit the Docker Hub<a id="_idIndexMarker422"/> download link at https://hub.docker.com/editions/community/docker-ce-desktop-mac/ to download the Docker Desktop installer.</li>
				<li>Click on the <strong class="bold">Get Docker</strong> button to download the <strong class="source-inline">Docker.dmg</strong> file to your workstation. </li>
				<li>Once the download has completed, double-click on the <strong class="source-inline">Docker.dmg</strong> file to open the image and drag the Docker icon from the window to the <strong class="source-inline">Applications</strong> folder to complete the installation: </li>
			</ol>
			<div>
				<div id="_idContainer029" class="IMG---Figure">
					<img src="Images/B17085_04_002.jpg" alt="Figure 4.2 – Docker Desktop installation screen on macOS&#13;&#10;" width="1116" height="541"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.2 – Docker Desktop installation screen on macOS</p>
			<ol>
				<li value="4">In <a id="_idIndexMarker423"/>the <strong class="bold">Applications</strong> folder, double-click<a id="_idIndexMarker424"/> on the Docker icon to start Docker Desktop. </li>
				<li>Confirm that you have privileged access to install Docker components on your workstation.</li>
				<li>If you are using Docker for the first time, follow the quick tutorial. Otherwise, click <strong class="bold">Skip Tutorial</strong> to start Docker:</li>
			</ol>
			<div>
				<div id="_idContainer030" class="IMG---Figure">
					<img src="Images/B17085_04_003.jpg" alt="Figure 4.3 – Docker Desktop graphical user interface&#13;&#10;" width="944" height="567"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.3 – Docker Desktop graphical user interface</p>
			<p>Installing Docker Desktop on Windows</p>
			<p>Install <a id="_idIndexMarker425"/>Docker Desktop on your Windows machine by <a id="_idIndexMarker426"/>following these steps:</p>
			<ol>
				<li value="1">Go<a id="_idIndexMarker427"/> to https://docs.docker.com/desktop/windows/install/. </li>
				<li>Click <strong class="bold">Docker Desktop for Windows</strong>.</li>
				<li>Click <strong class="bold">Docker Desktop Installer.exe</strong>.</li>
				<li>Follow the interactive prompts to install <strong class="bold">Docker Desktop</strong>.</li>
				<li>On the <strong class="bold">Configuration</strong> page, make sure that you select <strong class="bold">Install required Windows components for WSL 2</strong>.</li>
				<li>When you're done, click <strong class="bold">Close</strong>.</li>
				<li>Start <a id="_idIndexMarker428"/>Docker Desktop by finding it in <a id="_idIndexMarker429"/>Windows Search and accept the terms and conditions. Docker will start automatically after that.</li>
			</ol>
			<p>Now that you have installed Docker Desktop on your machine, let's install the Pachyderm CLI, called <strong class="source-inline">pachctl</strong>.</p>
			<h1 id="_idParaDest-105"><a id="_idTextAnchor108"/>Installing the Pachyderm command-line interface</h1>
			<p>The Pachyderm <strong class="bold">CLI</strong>, <strong class="source-inline">pachctl</strong>, is used to deploy and interact with Pachyderm clusters. Follow these<a id="_idIndexMarker430"/> steps to install <strong class="source-inline">pachctl</strong>:</p>
			<ol>
				<li value="1">Let's get the latest release version tag of <strong class="source-inline">pachctl</strong> and keep it in a variable called <strong class="source-inline">PACHYDERMVERSION</strong>:<p class="source-code"><strong class="bold">$ PACHYDERMVERSION=$(curl --silent "https://api.github.com/repos/pachyderm/pachyderm/releases/latest" | grep '"tag_name":' | \</strong></p><p class="source-code"><strong class="bold">sed -E 's/.*"v([^"]+)".*/\1/')</strong></p></li>
				<li>Execute the following commands to<a id="_idTextAnchor109"/> install <strong class="source-inline">pachctl</strong> on your computer.</li>
			</ol>
			<p>If you are using macOS, run the following command:</p>
			<p class="source-code"><strong class="bold">$ brew tap pachyderm/tap &amp;&amp; brew install pachyderm/tap/pachctl@${PACHYDERMVERSION}</strong></p>
			<p>If you are using Debian Linux or WSL on Windows 10, run the following command:</p>
			<p class="source-code"><strong class="bold">$ curl -o /tmp/pachctl.deb -L https://github.com/pachyderm/pachyderm/releases/download/v${PACHYDERMVERSION}/pachctl_${PACHYDERMVERSION}_amd64.deb &amp;&amp; sudo dpkg -i /tmp/pachctl.deb</strong></p>
			<ol>
				<li value="3">Execute the <a id="_idIndexMarker431"/>following command to verify that you have installed <strong class="source-inline">pachctl</strong>:<p class="source-code"><strong class="bold">$ pachctl version --client-only</strong></p></li>
			</ol>
			<p>The following is an example of the system's output:</p>
			<p class="source-code"><strong class="bold">COMPONENT           VERSION</strong></p>
			<p class="source-code"><strong class="bold">pachctl</strong><strong class="bold">             2.0.1</strong></p>
			<p>With that, you have installed the prerequisites to run Pachyderm locally. Now, let's prepare our cluster and deploy Pachy<a id="_idTextAnchor110"/>derm on our local Kubernetes cluster. </p>
			<h1 id="_idParaDest-106"><a id="_idTextAnchor111"/>Enabling autocompletion for Pachyderm </h1>
			<p>Autocompletion<a id="_idIndexMarker432"/> is a functionality that's offered by Unix shell flavors to autofill parameters using the CLI. Depending on the type of shell that's used in your system, the autocompletion feature suggests or autocompletes the partially typed commands as you type, sometimes by pressing the <em class="italic">Tab</em> key. Pachyderm supports autocompletion for Bourne Again Shell (<strong class="source-inline">bash</strong>) and Z shell (<strong class="source-inline">zsh</strong>), an extended Bourne shell. <strong class="source-inline">bash</strong> and <strong class="source-inline">zsh</strong> are<a id="_idIndexMarker433"/> the<a id="_idIndexMarker434"/> most common Unix command-line interpreters that are used on<a id="_idIndexMarker435"/> macOS and Linux. In this section, you will<a id="_idIndexMarker436"/> learn how to enable the Pachyderm autocompletion feature and the parameters that are available from the <strong class="source-inline">pachctl</strong> command.</p>
			<p>If you don't know which shell you are using, type the following command to find out:</p>
			<p class="source-code">$ echo "$SHELL"</p>
			<p>If you are using <strong class="source-inline">bash</strong>, the output of the preceding command should look as follows:</p>
			<p class="source-code">/bin/bash</p>
			<p>If you are using <strong class="source-inline">zsh</strong>, the output of the preceding command should look as follows:</p>
			<p class="source-code">/bin/zsh</p>
			<p>Since we now know which shell we are using, <a id="_idTextAnchor112"/>we can install Pachyderm autocompletion.</p>
			<h2 id="_idParaDest-107"><a id="_idTextAnchor113"/>Enabling Pachyderm autocompletion for bash</h2>
			<p>Follow these steps to <a id="_idIndexMarker437"/>enable Pachyderm <a id="_idIndexMarker438"/>autocompletion on your computer:</p>
			<ol>
				<li value="1">Execute the following commands to enable <strong class="source-inline">bash-completion</strong>.</li>
			</ol>
			<p>If you are using macOS or Linux with Homebrew, use the following command:</p>
			<p class="source-code"><strong class="bold">$ brew install bash-completion</strong></p>
			<p>If you are on Ubuntu Linux, use the following command:</p>
			<p class="source-code"><strong class="bold">$ sudo apt install bash-completion</strong></p>
			<p>If you are using RHEL or CentOS Linux, use the following command:</p>
			<p class="source-code"><strong class="bold">$ sudo yum install bash-completion bash-completion-extras</strong></p>
			<ol>
				<li value="2">Execute the following command to verify that <strong class="source-inline">bash-completion</strong> is enabled on your computer.</li>
			</ol>
			<p>If you are on macOS, run the following command:</p>
			<p class="source-code"><strong class="bold">$ brew info bash-completion</strong></p>
			<p>If you are using Linux, run the following command:</p>
			<p class="source-code"><strong class="bold">$ complete -p</strong></p>
			<ol>
				<li value="3">Confirm that the path for <strong class="source-inline">bash-completion</strong> is pointing to the correct directory. Then, execute either of the following commands to enable Pachyderm <strong class="source-inline">pachctl</strong> autocompletion:</li>
			</ol>
			<p>If you are on macOS, run the following command:</p>
			<p class="source-code"><strong class="bold">$ pachctl completion bash --install --path /usr/local/etc/bash_completion.d/pachctl</strong></p>
			<p>If you are using Linux, run the following command:</p>
			<p class="source-code"><strong class="bold">$ pachctl completion bash --install --path /usr/share/bash-completion/completions/pachctl</strong></p>
			<p>With that, Pachyderm's command-line autocompletion has been enabled in your bash shell.</p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor114"/>Enabling Pachyderm autocompletion for zsh</h2>
			<p><strong class="bold">Z shell</strong>, or <strong class="bold">zsh</strong>, is an<a id="_idIndexMarker439"/> improved interactive login shell with many advanced features. The default interactive shell in Apple laptops was changed to <strong class="source-inline">zsh</strong> with macOS Catalina. Follow these steps to enable Pachyderm autocompletion on your computer:</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If you do not wish to enable autocompletion, you can try using <strong class="source-inline">pachctl shell</strong> instead. To enable this feature, type <strong class="source-inline">pachctl shell</strong>.</p>
			<ol>
				<li value="1">Execute<a id="_idIndexMarker440"/> the following commands to <a id="_idIndexMarker441"/>enable <strong class="source-inline">zsh</strong> autocompletion.</li>
			</ol>
			<p>If you are using macOS or Linux with Homebrew, use the following command:</p>
			<p class="source-code"><strong class="bold">$ brew install zsh-completion</strong></p>
			<p>If you are on Linux, visit the <a href="https://github.com/zsh-users/zsh-completions">https://github.com/zsh-users/zsh-completions</a> page and follow the instructions for your Linux distribution to enable <strong class="source-inline">zsh</strong> completion. As an example, for Ubuntu 19.10, this would look as follows:</p>
			<p class="source-code"><strong class="bold">$ echo 'deb http://download.opensuse.org/repositories/shells:/zsh-users:/zsh-completions/xUbuntu_19.10/ /' | sudo tee /etc/apt/sources.list.d/shells:zsh-users:zsh-completions.list</strong></p>
			<p class="source-code"><strong class="bold">$ curl -fsSL https://download.opensuse.org/repositories/shells:zsh-users:zsh-completions/xUbuntu_19.10/Release.key | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/shells_zsh-users_zsh-completions.gpg &gt; /dev/null</strong></p>
			<p class="source-code"><strong class="bold">$ sudo apt update &amp;&amp; sudo apt install zsh-completions</strong></p>
			<ol>
				<li value="2">Execute the following commandss to verify that <strong class="source-inline">zsh</strong> autocompletion is enabled on your computer.</li>
			</ol>
			<p>If you are on macOS, run the following command:</p>
			<p class="source-code"><strong class="bold">$ brew info zsh-completions</strong></p>
			<p>If you are using<a id="_idIndexMarker442"/> Linux, run the following <a id="_idIndexMarker443"/>command:</p>
			<p class="source-code"><strong class="bold">$ complete -p</strong></p>
			<ol>
				<li value="3">Confirm that the path for <strong class="source-inline">zsh</strong> autocompletion is pointing to the correct directory. Then, execute either of the following commands to enable Pachyderm <strong class="source-inline">pachctl</strong> autocompletion.</li>
			</ol>
			<p>On macOS, run the following command:</p>
			<p class="source-code"><strong class="bold">$ pachctl completion zsh --install --path /usr/local/share/zsh-completions/_pachctl</strong></p>
			<p>If you are using Linux, run the following command:</p>
			<p class="source-code"><strong class="bold">$ pachctl completion zsh --install --path /home/linuxbrew/.linuxbrew/share/zsh-completions/_pachctl</strong></p>
			<p>With that, Pachyderm command-line autocompletion is now enabled in your <strong class="source-inline">zsh</strong> shell. Next, let's prepare the Kubernetes environment.</p>
			<h1 id="_idParaDest-109"><a id="_idTextAnchor115"/>Preparing the Kubernetes environment</h1>
			<p>In this section, you <a id="_idIndexMarker444"/>will provision a Kubernetes cluster by using the preferred tools that you deployed in the <em class="italic">Installing the required tools</em> section. </p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor116"/>Enabling Kubernetes on Docker Desktop</h2>
			<p>Follow these steps to <a id="_idIndexMarker445"/>enable Kubernetes if you're<a id="_idIndexMarker446"/> using Docker Desktop as your container platform to deploy your Kubernetes cluster on both Windows and macOS:</p>
			<ol>
				<li value="1">Open the Docker UI. </li>
				<li>At the top-right corner of the Docker UI, click the <strong class="bold">Settings</strong> icon.</li>
				<li>Switch to the Kubernetes settings panel and click the <strong class="bold">Enable Kubernetes</strong> button to start a single-node Kubernetes cluster with Docker Desktop. Apply these settings by clicking the <strong class="bold">Apply &amp; Restart</strong> button:</li>
			</ol>
			<div>
				<div id="_idContainer031" class="IMG---Figure">
					<img src="Images/B17085_04_004.jpg" alt="Figure 4.4 – Enabling Kubernetes in Docker Desktop&#13;&#10;" width="936" height="502"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.4 – Enabling Kubernetes in Docker Desktop</p>
			<ol>
				<li value="4">Open a Terminal window and confirm that Kubernetes is running by executing the following command:<p class="source-code"><strong class="bold">$ kubectl get node</strong></p></li>
			</ol>
			<p>The following<a id="_idIndexMarker447"/> is an example of the system's<a id="_idIndexMarker448"/> response:</p>
			<p class="source-code"><strong class="bold">NAME</strong><strong class="bold">           STATUS ROLES                AGE  VERSION</strong></p>
			<p class="source-code"><strong class="bold">docker-desktop Ready  control-plane,master 7m9s v1.21.5</strong></p>
			<p>With that, you have a single-node Kubernetes cluster configured on Docker Desktop. Now, we are ready to deploy Pachyderm on our local Kubernetes environment.</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor117"/>Enabling Kubernetes using minikube</h2>
			<p>Follow <a id="_idIndexMarker449"/>these steps to run<a id="_idIndexMarker450"/> Kubernetes locally when using minikube:</p>
			<ol>
				<li value="1">Make Docker the default driver for <strong class="source-inline">minikube</strong>:<p class="source-code"><strong class="bold">$ minikube config set driver docker</strong></p></li>
				<li>Start a Kubernetes cluster:<p class="source-code"><strong class="bold">$ minikube start</strong></p></li>
				<li>Execute the following command to verify that your Kubernetes cluster is ready:<p class="source-code"><strong class="bold">$ kubectl get node</strong></p><p class="source-code"><strong class="bold">NAME       </strong><strong class="bold">STATUS   ROLES                  AGE   VERSION</strong></p><p class="source-code"><strong class="bold">minikube   Ready    control-plane,master   29m   v1.20.2</strong></p></li>
			</ol>
			<p>With that, your Kubernetes cluster has been configured using minikube. Now, we are ready to deploy Pachyderm on our local Kubernetes environment.</p>
			<h1 id="_idParaDest-112"><a id="_idTextAnchor118"/>Deploying Pachyderm</h1>
			<p>When running <a id="_idIndexMarker451"/>Pachyderm in production, it is recommended to start in an environment where resources can scale up to handle the computational needs of larger pipelines. Pachyderm can be installed on any Kubernetes cluster, including managed Kubernetes services provided by AWS, Google Cloud, Microsoft Azure, IBM Cloud, and OpenShift, as well as locally on your workstation. In this section, we are going to focus on a smaller test deployment; therefore, a local cluster is good enough to get started. </p>
			<p>Pachyderm provides sample Helm charts to help you deploy Pachyderm to all major cloud platforms. You can read more about Helm Charts in <a href="B17085_02_Final_SB_Epub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Pachyderm Basics</em>. Because Helm charts are flexible, you can pick the components that you want to install. For example, you can install the Pachyderm in-browser interface called the Console. </p>
			<p>The Pachyderm Console<a id="_idIndexMarker452"/> is the Pachyderm user interface and provides a birds-eye view of your pipelines through the <strong class="bold">Direct Acyclic Graph</strong> (<strong class="bold">DAG</strong>), as well as <a id="_idIndexMarker453"/>other useful features.</p>
			<p>Some components, such as the Pachyderm Console, require an Enterprise license but are also available for testing with <a id="_idIndexMarker454"/>a free trial license for 30 days. You can request a free trial license at <a href="https://www.pachyderm.com/trial/">https://www.pachyderm.com/trial/</a>.</p>
			<p>Follow these steps to<a id="_idIndexMarker455"/> install Pachyderm on <a id="_idIndexMarker456"/>your local Kubernetes cluster:</p>
			<ol>
				<li value="1">Deploying Pachyderm consists of multiple resources. The <strong class="source-inline">helm</strong> command helps manage complex Kubernetes applications' life cycles and creates all the necessary components at once using a single command. You can learn more about the options for Helm charts in <a href="B17085_05_Final_SB_Epub.xhtml#_idTextAnchor123"><em class="italic">Chapter 5</em></a>, <em class="italic">Installing Pachyderm on a Cloud Platform</em>. For now, let's execute the following command to add Pachyderm Helm chart repositories to your local repository:<p class="source-code"><strong class="bold">$ helm repo add pach https://helm.pachyderm.com  </strong></p></li>
				<li>Execute the following command to get the latest chart information from the chart repository:<p class="source-code"><strong class="bold">$ helm repo update</strong></p></li>
				<li>Execute the following command to deploy the latest version of Pachyderm on your cluster without the console:<p class="source-code"><strong class="bold">$ helm install pachd pach/pachyderm --set deployTarget=LOCAL</strong></p></li>
			</ol>
			<p>If you have an Enterprise key and you would like to deploy it with Pachyderm's console user interface, create a file called <strong class="source-inline">license.txt</strong> and paste your Enterprise token into that file. Then, run the following commands:</p>
			<p class="source-code"><strong class="bold">$ helm install pachd pach/pachyderm --set deployTarget=LOCAL --set pachd.enterpriseLicenseKey=$(cat license.txt) --set console.enabled=true  </strong></p>
			<p>Once the<a id="_idIndexMarker457"/> Console has been deployed <a id="_idIndexMarker458"/>successfully, follow the instructions provided in the <em class="italic">Accessing the Pachyderm Console</em> section to access the Console.</p>
			<p>The preceding commands return the following output:</p>
			<div>
				<div id="_idContainer032" class="IMG---Figure">
					<img src="Images/B17085_04_005.jpg" alt="Figure 4.5 – Pachyderm Helm chart getting deployed on Kubernetes&#13;&#10;" width="680" height="342"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.5 – Pachyderm Helm chart getting deployed on Kubernetes</p>
			<ol>
				<li value="4">You can inspect the <strong class="source-inline">values.yaml</strong> file in the Helm Chart repository (<a href="https://github.com/pachyderm/pachyderm/tree/master/etc/helm/pachyderm">https://github.com/pachyderm/pachyderm/tree/master/etc/helm/pachyderm</a>) to learn more about the Kubernetes objects that are created by deploying the Chart. The Pachyderm Helm chart creates Kubernetes <strong class="bold">service accounts</strong>, <strong class="bold">Services</strong>, <strong class="bold">Deployments</strong>, PostgreSQL, and etcd instances, all of which are needed to run Pachyderm. </li>
				<li>A Kubernetes <a id="_idIndexMarker459"/>Deployment is a<a id="_idIndexMarker460"/> controller that rolls out a ReplicaSet of Pods based on the requirements defined in your manifest file. A ReplicaSet is a group of the same service instances. Execute the following command to verify the state of the Deployments that have been created during the installation:<p class="source-code"><strong class="bold">$ kubectl get deployments</strong></p></li>
			</ol>
			<p>The output of the preceding command should look as follows:</p>
			<div>
				<div id="_idContainer033" class="IMG---Figure">
					<img src="Images/B17085_04_006.jpg" alt="Figure 4.6 – List of Pachyderm Deployment objects&#13;&#10;" width="630" height="104"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.6 – List of Pachyderm Deployment objects</p>
			<ol>
				<li value="6">Execute the following command to verify that the installation was successful and view the Pods that were created as part of the Deployments:<p class="source-code"><strong class="bold">$ kubectl get pods</strong></p></li>
			</ol>
			<p>The output of the preceding command should look as follows:</p>
			<div>
				<div id="_idContainer034" class="IMG---Figure">
					<img src="Images/B17085_04_007.jpg" alt="Figure 4.7 – List of Pachyderm Pods&#13;&#10;" width="906" height="164"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.7 – List of Pachyderm Pods</p>
			<ol>
				<li value="7">Execute the <a id="_idIndexMarker461"/>following commands to<a id="_idIndexMarker462"/> connect to your new Pachyderm instance:<p class="source-code"><strong class="bold">pachctl config import-kube local –overwrite</strong></p><p class="source-code"><strong class="bold">pachctl config set active-context local</strong></p><p class="source-code"><strong class="bold">pachctl port-forward</strong></p></li>
				<li>Go to your browser and point it to <strong class="source-inline">http://localhost:4000</strong>.</li>
				<li>Authenticate with a mock user called <strong class="source-inline">admin</strong> and use <strong class="source-inline">password</strong> as your password.</li>
				<li>Go back to your terminal and enable authentication:<p class="source-code"><strong class="bold">pachctl auth activate</strong></p></li>
			</ol>
			<p>You'll be prompted to log into the UI again. Log in with the mock user called <strong class="source-inline">admin</strong> and use <strong class="source-inline">password</strong> as your password.</p>
			<ol>
				<li value="11">Execute the following command to verify that Pachyderm has been installed successfully:<p class="source-code"><strong class="bold">pachctl version</strong></p></li>
			</ol>
			<p>The output of the preceding command should look as follows:</p>
			<p class="source-code"><strong class="bold">COMPONENT           VERSION</strong></p>
			<p class="source-code"><strong class="bold">pachctl             2.0.1</strong></p>
			<p class="source-code"><strong class="bold">pachd               2.0.1</strong></p>
			<p>Now that we have installed Pachyderm on our cluster, we are ready to create our first pipeline.</p>
			<h1 id="_idParaDest-113"><a id="_idTextAnchor119"/>Accessing the Pachyderm Console</h1>
			<p>If you have installed the <a id="_idIndexMarker463"/>Console with your Pachyderm cluster, you can access it and view your pipelines, repositories, and other Pachyderm objects in the UI. The Pachyderm Console is available as a free trial for 30 days. Follow these steps to access the Pachyderm Console:</p>
			<ol>
				<li value="1">Execute the following command to verify the status of your Enterprise activation:<p class="source-code"><strong class="bold">pachctl enterprise get-state</strong></p></li>
			</ol>
			<p>The output of the preceding command should look as follows:</p>
			<p class="source-code"><strong class="bold">Pachyderm Enterprise token state: ACTIVE</strong></p>
			<p class="source-code"><strong class="bold">Expiration: 2022-02-02 22:35:21 +0000 UTC</strong></p>
			<ol>
				<li value="2">If port-forwarding is not running, execute the following command to start it. This step will forward the Pachyderm Console service on port <strong class="source-inline">4000</strong> to your local workstation on port <strong class="source-inline">4000</strong>:<p class="source-code"><strong class="bold">pachctl port-forward</strong></p></li>
				<li>In a web browser, open <a href="http://localhost:4000">http://localhost:4000</a>. </li>
				<li>Use the default credentials of <strong class="source-inline">admin</strong> and <strong class="source-inline">password</strong> on the login screen, as follows:</li>
			</ol>
			<div>
				<div id="_idContainer035" class="IMG---Figure">
					<img src="Images/B17085_04_008.jpg" alt="" width="626" height="506"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.8 – Login screen of the Pachyderm Console</p>
			<ol>
				<li value="5">Upon<a id="_idIndexMarker464"/> clicking <strong class="bold">Login</strong> to access the Pachyderm Console, click the <strong class="bold">View Project</strong> button to view your repositories and pipelines:</li>
			</ol>
			<div>
				<div id="_idContainer036" class="IMG---Figure">
					<img src="Images/B17085_04_009.jpg" alt="" width="1058" height="488"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.9 – Pachyderm dashboard</p>
			<p>Because we have not created any Pachyderm objects, this page is empty.</p>
			<p>Now that you have learned how to access the Pachyderm Console, you are ready to create your first pipeline in Pachyderm. </p>
			<h1 id="_idParaDest-114"><a id="_idTextAnchor120"/>Deleting an existing Pachyderm deployment</h1>
			<p>Only perform the<a id="_idIndexMarker465"/> steps in this section if you want to delete your cluster. If you want to continue working on the examples in other chapters, then please skip this section.</p>
			<p>If you need to delete your deployment and start afresh, you need to wipe out your environment and start over again from the steps provided in the <em class="italic">Preparing the Kubernetes environment</em> section. When you delete an existing Pachyderm deployment, all the components, except for the Helm repository and <strong class="source-inline">pachctl</strong>, are removed from your machine.</p>
			<p>Follow these steps to delete your existing Pachyderm deployment:</p>
			<ol>
				<li value="1">If you have used a different name for your Helm instance, then execute the following command to find the Pachyderm instance name that you deployed using the Helm chart:<p class="source-code"><strong class="bold">$ helm ls | grep pachyderm</strong></p></li>
			</ol>
			<p>The output of the preceding command should look as follows:</p>
			<p class="source-code"><strong class="bold">pachd default 1 2021-11-08 21:33:44 deployed Pachyderm-2.0.1 2.0.1</strong></p>
			<ol>
				<li value="2">Execute the following command using your Pachyderm instance name to remove the Pachyderm components from your cluster:<p class="source-code"><strong class="bold">$ helm uninstall pachd</strong></p></li>
				<li>If you're using minikube, remove the entire Kubernetes cluster and redeploy before you deploy Pachyderm again:<p class="source-code"><strong class="bold">$ minikube stop </strong></p><p class="source-code"><strong class="bold">$ minikube delete </strong></p></li>
			</ol>
			<p>With that, you have completely removed Pachyderm and the local Kubernetes cluster from your computer. </p>
			<h1 id="_idParaDest-115"><a id="_idTextAnchor121"/>Summary</h1>
			<p>In this chapter, we learned about the software prerequisites for getting Pachyderm up and running on your local computer for testing purposes. </p>
			<p>We gained basic knowledge about minikube and Docker Desktop and learned how to install them on our local machine. We also learned how to install the Pachyderm CLI and enable autocompletion on different operating systems. </p>
			<p>We then installed Helm and the Pachyderm Helm repository on our system. We learned about Helm charts and how to obtain a free trial Pachyderm license.</p>
			<p>We deployed a single-node, local Kubernetes cluster by using the most popular options available based on our desktop operating system. Finally, we deployed Pachyderm and learned how to access the Pachyderm Console. </p>
			<p>We also learned how to do so on all three major platforms – macOS, Linux, and Windows.</p>
			<p>In the next chapter, we will learn about how to install Pachyderm via the cloud and explain the software requirements needed to run a Pachyderm cluster in production. We will also learn about <strong class="bold">Pachyderm Hub</strong>, the <strong class="bold">Software-as-a-Service </strong>(<strong class="bold">SaaS</strong>) version of Pachyderm that is great for both testing and production environments.</p>
			<h1 id="_idParaDest-116"><a id="_idTextAnchor122"/>Further reading</h1>
			<p>Please refer to the following links for more information about the topics that were covered in this chapter:</p>
			<ul>
				<li><em class="italic">Official Homebrew Documentation</em>: <a href="https://docs.brew.sh/">https://docs.brew.sh/</a> </li>
				<li><em class="italic">Kubectl Cheat Sheet:</em> <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">https://kubernetes.io/docs/reference/kubectl/cheatsheet/</a> </li>
				<li><em class="italic">Minikube Handbook</em>: <a href="https://minikube.sigs.k8s.io/docs/handbook/">https://minikube.sigs.k8s.io/docs/handbook/</a></li>
				<li><em class="italic">The Official Docker Desktop Documentation</em>: https://docs.docker.com/desktop/</li>
				<li><em class="italic">Kubernetes in Production Best Practices</em>: <a href="https://www.packtpub.com/product/kubernetes-in-production-best-practices/9781800202450">https://www.packtpub.com/product/kubernetes-in-production-best-practices/9781800202450</a></li>
				<li> <em class="italic">Kubernetes and Docker – An Enterprise Guide</em>: <a href="https://www.packtpub.com/product/kubernetes-and-docker-an-enterprise-guide/9781839213403">https://www.packtpub.com/product/kubernetes-and-docker-an-enterprise-guide/9781839213403</a></li>
				<li><em class="italic">Official Pachyderm pachctl Reference Guide</em>: <a href="https://docs.pachyderm.com/latest/reference/pachctl/pachctl/">https://docs.pachyderm.com/latest/reference/pachctl/pachctl/</a></li>
			</ul>
		</div>
	</div></body></html>